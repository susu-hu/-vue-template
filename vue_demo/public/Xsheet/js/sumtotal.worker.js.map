{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/utils/SheetUtils.js","webpack:///./src/draw/font/BaseFont.js","webpack:///./src/lib/Element.js","webpack:///./src/const/Constant.js","webpack:///./src/lib/XEvent.js","webpack:///./src/lib/Widget.js","webpack:///./src/core/work/head/tool/Icon.js","webpack:///./src/module/dragpanel/DragPanel.js","webpack:///./src/module/colorpicker/ColorPicker.js","webpack:///./src/module/colorpicker/colorarray/ColorItem.js","webpack:///./src/module/colorpicker/colorarray/ColorArray.js","webpack:///./src/core/table/tablecell/CellFont.js","webpack:///./src/draw/XDraw.js","webpack:///./src/draw/Line.js","webpack:///./src/core/table/tablecell/Border.js","webpack:///./src/core/table/tablecell/CellBorder.js","webpack:///./src/draw/Rect.js","webpack:///./src/core/table/tableicon/XIconOffset.js","webpack:///./src/draw/Crop.js","webpack:///./src/core/table/tableicon/XIcon.js","webpack:///./src/utils/DateUtils.js","webpack:///./src/core/table/XTableTextFormat.js","webpack:///./src/core/table/tablecell/RichFont.js","webpack:///./src/core/table/tablecell/RichFonts.js","webpack:///./src/formula/Compiler.js","webpack:///./src/formula/Formula.js","webpack:///./src/core/table/tablecell/Cell.js","webpack:///./src/lib/Listen.js","webpack:///./src/core/table/tablebase/RectRange.js","webpack:///./src/core/table/snapshot/Snapshot.js","webpack:///./src/lib/recttree/QkSelect.js","webpack:///./src/lib/recttree/RectTree.js","webpack:///./src/utils/RtreeUtils.js","webpack:///./src/core/table/tablebase/RangeTree.js","webpack:///./src/core/table/merges/Merges.js","webpack:///./src/core/table/tablecell/Cells.js","webpack:///./src/task/worker/sumtotal.worker.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","S4","Math","random","toString","substring","alphabets","DATA_TYPE","String","Boolean","Number","Array","Function","Null","Undefined","Promise","GeneratorFunction","AsyncFunction","BigInt","DedicatedWorkerGlobalScope","Date","RegExp","Un","SheetUtils","test","navigator","userAgent","isEmptyObject","e","this","isUnDef","type","EX","length","trim","obj","getPrototypeOf","parent","str","toLowerCase","arg","sources","forEach","source","keys","v","isArray","isPlainObject","copy","json","JSON","stringify","parse","target","len","item","isDef","objOrAry","cb","total","size","val","isNumber","parseFloat","parseInt","index","idx","ret","charCodeAt","expoNet","src","x","y","charAt","indexAt","stringAt","xn","yn","expr2xy","xy2expr","min","range","window","getSelection","selectAllChildren","collapseToEnd","isBlank","now","width","innerWidth","height","innerHeight","document","exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","element","el","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","webkitIsFullScreen","mozFullScreen","msFullscreenElement","fullscreenElement","one","tow","diffValue","oneValue","towValue","diffArrays","isObject","oneKeys","towKeys","includes","diffObject","isDate","getTime","isRegExp","num","fixed","indexOf","toFixed","explorer","version","match","array","isString","replace","EMPTY","defaultValue","self","condition","establish","otherwise","likeArray","slice","result","encodeURI","Nul","Undef","undefined","noop","BaseFont","draw","ruler","attr","align","ALIGN","center","padding","verticalAlign","VERTICAL_ALIGN","top","bottom","left","right","TEXT_WRAP","OVER_FLOW","WORD_WRAP","TRUNCATE","TEXT_DIRECTION","HORIZONTAL","VERTICAL","ANGLE","ANGLE_BAR","DEFAULT_FONT_ATTR","color","bold","italic","strikethrough","underline","angle","textWrap","direction","DEFAULT_RICH_ATTR","DEFAULT_RICH_ITEM_ATTR","Element","tag","className","createElement","map","HTMLCollection","NodeList","elements","push","text","createTextNode","args","arguments","wrapElement","children","ele","append","childNodes","isTextNode","childrenNodes","prepend","k","css","offsetTop","offsetLeft","offsetHeight","offsetWidth","parentNode","classList","add","contains","remove","getBoundingClientRect","firstChild","lastChild","find","handle","elem","hasChild","reverse","removeChild","previousSibling","nextSibling","flag","cls","addClass","removeClass","nodeValue","innerText","html","innerHTML","focus","blur","removeAttribute","style","setAttribute","getAttribute","removeProperty","hyphenateRE","newValue","getPropertyValue","setProperty","getComputedStyle","computedStyle","display","message","evt","MouseEvent","detail","bubbles","cancelable","initEvent","dispatchEvent","CustomEvent","select","querySelectorAll","sibling","previousElementSibling","nextElementSibling","nodeName","toLocaleLowerCase","nodeType","after","before","cloneNode","other","equals","tagName","DocumentFragment","h","Constant","WORK_BODY_EVENT_TYPE","CHANGE_ACTIVE","REMOVE_SHEET","SYSTEM_EVENT_TYPE","MOUSE_MOVE","MOUSE_DOWN","CONTEXT_MENU","SCROLL","RESIZE","MOUSE_UP","INPUT","KEY_DOWN","KEY_UP","MOUSE_OVER","MOUSE_LEAVE","MOUSE_WHEEL","MOUSE_ENTER","CLICK","FOCUS","DRAG_START","CHANGE","VISIBILITY_CHANGE","TABLE_EVENT_TYPE","RENDER","SNAPSHOT_CHANGE","CHANGE_ROW_HEIGHT","CHANGE_COL_WIDTH","SCALE_CHANGE","EDIT_START","EDIT_INPUT","EDIT_FINISH","REMOVE_ROW","REMOVE_COL","ADD_NEW_ROW","ADD_NEW_COL","FIXED_CHANGE","FIXED_COL_CHANGE","FIXED_ROW_CHANGE","SELECT_OVER","SELECT_DOWN","SELECT_CHANGE","DATA_CHANGE","RESIZE_CHANGE","FORM_EVENT_TYPE","SEARCH_INPUT_CHANGE","PLAIN_INPUT_CHANGE","FORM_SELECT_CHANGE","pool","callback","option","removeEventListener","addEventListener","rem","eqElem","eqOpt","eqType","eqCall","eles","unbind","XEvent","fn","multipleUnbind","multipleBind","holdFunc","endFunc","time","setInterval","xEvtUp","clearInterval","moveFunc","upFunc","xEvtMove","stopPropagation","preventDefault","WrapFuncion","doubleClick","lastPageX","lastPageY","lastTime","event","button","pageX","pageY","current","mouseClick","Widget","$$rootFlag","widget","parentWidget","onAttach","box","clientY","clientX","clazz","node","body","is","hasClass","getRootWidget","root","thisBox","rootBox","data","Icon","iconNameEl","instances","DragPanel","options","position","DRAG_PANEL_POSITION","CENTER","status","mask","content","instance","filter","close","dragPanelLocation","evt1","dxy","eventXy","mouseMoveUp","evt2","offset","elemBox","LEFT","RIGHT","TOP","removeInstance","ColorPicker","selectCb","dragPanel","preViewColorPoint","colorValueTips","colorInput","selectColorPoint","selectColorArea1","selectColorArea2","selectColorArea3","colorHuxTips","colorBar","colorBarPoint","cancelButton","selectButton","buttons","hex","join","hsx","max","rgb","startsWith","isHex","hexToRgb","g","b","parseRgb","rgbToHsb","hsb","delta","t1","t2","t3","round","nr","rgbToHex","hsbToRgb","e1","hexColor","xy","colorBarBox","downHue","e2","moveHue","centerBox","downSelect","moveSelect","fixHsx","open","isRgb","change","colorBarPointBox","colorBarPointLeft","selectColorPointBox","selectColorPointLeft","selectColorPointTop","colorValue","hsbToHex","areaColorValue","sliderPosition","hueChange","selectChange","hexToHsb","fixHex","destroy","ColorItem","icon","blankClear","isDark","checkedIcon","hide","active","show","ColorArray","colors","activeColor","setActiveByColor","findIndex","setActive","empty","BLACK","NULL","WHITE","CellFont","keys1","keys2","clearBlank","getInstance","config","DPR","inWorker","devicePixelRatio","LINE_WIDTH_LOW","LINE_WIDTH_MEDIUM","LINE_WIDTH_HIGH","LINE_PIXEL_OFFSET","Base","canvas","ctx","getContext","px","dpr","srcPx","stylePx","ceil","trunc","PI","CorsLine","lineWidthType","LINE_WIDTH_TYPE","low","lineColor","medium","high","sx","sy","ex","ey","lineWidth","strokeStyle","polyStroke","xys","getOffsetX","getOffsetY","TypeError","corsLine","linePx","pixel","offsetX","offsetY","interpolation","beginPath","moveTo","lineTo","stroke","fill","fillRect","radian","dash","measureText","save","restore","clip","setLineDash","scale","translate","deg","rotate","XDraw","fillText","path","polyInFill","points","w","rect","sw","sh","tx","ty","tw","th","drawImage","LINE_TYPE","DoubleLine","widthType","spacing","leftShow","topShow","rightShow","bottomShow","iFMerge","iFMergeFirstRow","iFMergeLastRow","iFMergeFirstCol","iFMergeLastCol","row","col","pos","external","ifMerge","firstRow","lastRow","firstCol","lastCol","sTopLeftCorner","sTop","sBottom","eBottomLeftCorner","eBottom","eTop","sLeft","sRight","eTopRightCorner","eRight","eLeft","sTopRightCorner","eBottomRightCorner","sBottomLeftCorner","internal","setLineColor","setLineWidthType","handleExternal","handleInternal","horizonLine","verticalLine","zIndexID","Border","zIndex","border","origin","getZIndex","CellBorder","setBDisplay","setLDisplay","setTDisplay","setRDisplay","setDisplay","setBColor","setLColor","setTColor","setRColor","setColor","setBWidthType","setLWidthType","setTWidthType","setRWidthType","setWidthType","setBType","setLType","setTType","setRType","setType","setZIndex","clone","Rect","XIconOffset","Crop","XIcon","vertical","ICON_VERTICAL","horizontal","ICON_HORIZONTAL","ICON_TYPE","image","iconFocus","onDraw","onLeave","onMove","onDown","onEnter","icons","iconHorizontal","iconVertical","iconOffsetX","iconOffsetY","iconWidth","iconHeight","rectX","rectY","rectWidth","rectHeight","py","BOTTOM","load","sync","Image","loadImg","complete","onload","onerror","console","error","drawCustom","positionRect","include","includeRect","crop","fillStyle","native","location","inRectPosition","activate","ICON_EVENT_TYPE","includePoint","setActivate","custom","newInstances","DateUtils","fmt","date","getMonth","getDate","getHours","getMinutes","getSeconds","floor","S","getMilliseconds","resultYear","exec","yearFormatPart","yearVal","getFullYear","substr","res","Val","formatPart","replaceVal","parserToDate","dateText","format","defaultVal","reg","year","month","day","hours","minutes","seconds","milliseconds","j","oneChar","onePart","onePartReg","dataInfo","isFraction","split","toExponential","dateFormat","RichFont","scaleAdapter","ignore","RichFonts","rich","font","each","reset","plain","item1","item2","like","Functions","functions","toLocaleString","func","Assembly","assembly","endsWith","op","Tokenizer","syntaxCheck","input","OPERATOR","NUMBERS","SPACE","LETTERS","bracketsStack","tokens","char","next","last","brackets","pop","syntax","sQuotesStack","dQuotesStack","callStack","arrayStack","ignoreArray","token","ignoreFunc","skipIgnoreToken","dir","checkArray","local","checkValue","checkOperator","checkFunction","Compiler","writer","groupStack","opIf","opAdd","opMul","opCommon","opRel","opNew","opCell","function","number","eofToken","nextToken","backToken","compileIfge","isSkipNextToken","getInstruct","compileAdd","operator","reduceGroup","writeOperator","compileMul","compileCommon","compileRel","compileArray","compileFunction","addGroup","popGroup","compilePushValue","increaseGroup","writeString","writeNumber","writeOperand","Evaluation","instruct","memory","newArray","invoke","pushSRegexp","pushNRegexp","pushORegexp","ificmpge","ificmpgt","ifge","ifgt","ifeq","ifne","sub","mul","div","mod","power","rel","link","uni","common","group","pushS","pushN","pushO","a","pow","getFunction","apply","Compile","tokenizer","lexical","compile","Instruct","inst","eval","Formula","expr","Cell","borderAttr","fontAttr","richText","formula","background","contentWidth","contentHeight","contentType","TYPE","STRING","formatText","setContentType","setExpr","setRich","setRuler","setContentWidth","setContentHeight","getExpr","clearRuler","NUMBER","DATE_TIME","RICH_TEXT","getComputeText","hasExpr","getValue","XTableFormat","getFormatText","strikeline","updateMaxIndex","Listen","RectRange","sri","sci","eri","eci","ref","refs","iteratorBuilder","rowFilter","getRowIterator","setBegin","setEnd","setLoop","getColIterator","execute","ri","ci","disjoint","coincide","difference","addRet","dsr","dsc","der","dec","lt","rt","lb","rb","multiple","Snapshot","undoStack","redoStack","layer","listen","undo","redo","action","Compare","Swap","arr","tmp","QkSelect","compare","QStep","z","log","exp","sd","sqrt","findItem","items","equalsFn","extend","minX","minY","maxX","maxY","compareNodeMinX","compareNodeMinY","bboxArea","bboxMargin","intersects","createNode","leaf","Infinity","distBBox","toBBox","destNode","child","calcBBox","multiSelect","stack","mid","RectTree","maxEntries","_maxEntries","_minEntries","clear","_all","bbox","nodesToSearch","childBBox","search","insert","_build","_splitRoot","tmpNode","_insert","goingUp","indexes","splice","_condense","N","M","N2","N1","compareMinX","right2","compareMinY","right3","level","minArea","minEnlargement","targetNode","area","enlargement","isNode","insertPath","_chooseSubtree","_split","_adjustParentBBoxes","_chooseSplitAxis","splitIndex","_chooseSplitIndex","newNode","minOverlap","bbox1","bbox2","overlap","_allDistMargin","sort","leftBBox","rightBBox","margin","siblings","RtreeUtils","RangeTree","snapshot","rTree","first","bboxToRange","getFirstInclude","rectRange","rangeToBbox","shift","addAction","rectRanges","all","union","MAX_COL","MAX_ROW","Merges","merges","merge","valueOf","view","getAll","footRange","fullRange","getFullRowRange","fullBbox","footBbox","divers","mergeAction","diffMax","oldMax","diffMin","oldMin","getFullColRange","colAfterShrink","colAfterExpand","colBeforeShrink","colBeforeExpand","rowAfterShrink","rowAfterExpand","rowBeforeShrink","rowBeforeExpand","Cells","cell","getCell","getItemsOrNew","oldValue","getItems","hasCell","hasItems","getData","orderValue","cloneStyle","master","copyRowStyle","ignoreCorner","oldItems","effRiLength","effCiLength","oldRowItem","rowItem","cells","hasFormula","postMessage"],"mappings":"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","file":"js/sumtotal.worker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/* global navigator document window self */\r\nfunction S4() {\r\n  // eslint-disable-next-line no-bitwise\r\n  return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\r\n}\r\n\r\nconst alphabets = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];\r\n\r\nconst DATA_TYPE = {\r\n  String: 1,\r\n  Boolean: 2,\r\n  Number: 3,\r\n  Object: 4,\r\n  Array: 5,\r\n  Function: 6,\r\n  Null: 7,\r\n  Undefined: 8,\r\n  Promise: 9,\r\n  GeneratorFunction: 10,\r\n  AsyncFunction: 11,\r\n  BigInt: 12,\r\n  Symbol: 13,\r\n  DedicatedWorkerGlobalScope: 14,\r\n  Date: 15,\r\n  RegExp: 16,\r\n  Un: 0,\r\n};\r\n\r\nclass SheetUtils {\r\n\r\n  static isWindows() {\r\n    return /windows|win32/i.test(navigator.userAgent);\r\n  }\r\n\r\n  static isMac() {\r\n    return /macintosh|mac os x/i.test(navigator.userAgent);\r\n  }\r\n\r\n  static isNotEmptyObject(object) {\r\n    return !SheetUtils.isEmptyObject(object);\r\n  }\r\n\r\n  static isEmptyObject(object) {\r\n    // eslint-disable-next-line no-restricted-syntax\r\n    for (const key in object) {\r\n      // eslint-disable-next-line no-prototype-builtins\r\n      if (object.hasOwnProperty(key)) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  static isUnDef(e) {\r\n    return e === undefined || e === null;\r\n  }\r\n\r\n  static isDef(e) {\r\n    return !this.isUnDef(e);\r\n  }\r\n\r\n  static isNumber(e) {\r\n    return /^(-?\\d+.\\d+)$|^(-?\\d+)$/.test(e);\r\n  }\r\n\r\n  static isFraction(e) {\r\n    return /^\\d+\\/\\d+$/.test(e);\r\n  }\r\n\r\n  static isDate(e) {\r\n    return SheetUtils.type(e) === DATA_TYPE.Date;\r\n  }\r\n\r\n  static isFunction(e) {\r\n    const type = SheetUtils.type(e);\r\n    return type === DATA_TYPE.Function;\r\n  }\r\n\r\n  static isArray(e) {\r\n    return SheetUtils.type(e) === DATA_TYPE.Array;\r\n  }\r\n\r\n  static isObject(e) {\r\n    return SheetUtils.type(e) === DATA_TYPE.Object;\r\n  }\r\n\r\n  static isRegExp(e) {\r\n    return SheetUtils.type(e) === DATA_TYPE.EX;\r\n  }\r\n\r\n  static isLikeArray(e) {\r\n    if (SheetUtils.isUnDef(e)) {\r\n      return false;\r\n    }\r\n    return typeof e.length === 'number';\r\n  }\r\n\r\n  static isBlank(s) {\r\n    if (SheetUtils.isUnDef(s)) {\r\n      return true;\r\n    }\r\n    return s.toString().trim() === '';\r\n  }\r\n\r\n  static isPlainObject(obj) {\r\n    if (SheetUtils.isUnDef(obj)) {\r\n      return false;\r\n    }\r\n    return Object.getPrototypeOf(obj) === Object.getPrototypeOf({});\r\n  }\r\n\r\n  static isString(obj) {\r\n    return SheetUtils.type(obj) === DATA_TYPE.String;\r\n  }\r\n\r\n  static isChildType(obj, parent) {\r\n    return obj instanceof parent;\r\n  }\r\n\r\n  static toLowCase(str) {\r\n    return str.toLowerCase();\r\n  }\r\n\r\n  static type(arg) {\r\n    const type = Object.prototype.toString.call(arg);\r\n    switch (type) {\r\n      case '[object Null]':\r\n        return DATA_TYPE.Null;\r\n      case '[object Object]':\r\n        return DATA_TYPE.Object;\r\n      case '[object Undefined]':\r\n        return DATA_TYPE.Undefined;\r\n      case '[object String]':\r\n        return DATA_TYPE.String;\r\n      case '[object Boolean]':\r\n        return DATA_TYPE.Boolean;\r\n      case '[object Number]':\r\n        return DATA_TYPE.Number;\r\n      case '[object Function]':\r\n        return DATA_TYPE.Function;\r\n      case '[object Array]':\r\n        return DATA_TYPE.Array;\r\n      case '[object Promise]':\r\n        return DATA_TYPE.Promise;\r\n      case '[object GeneratorFunction]':\r\n        return DATA_TYPE.GeneratorFunction;\r\n      case '[object AsyncFunction]':\r\n        return DATA_TYPE.AsyncFunction;\r\n      case '[object BigInt]':\r\n        return DATA_TYPE.BigInt;\r\n      case '[object Symbol]':\r\n        return DATA_TYPE.Symbol;\r\n      case '[object Date]':\r\n        return DATA_TYPE.Date;\r\n      case '[object DedicatedWorkerGlobalScope]':\r\n        return DATA_TYPE.DedicatedWorkerGlobalScope;\r\n      default:\r\n        return DATA_TYPE.Un;\r\n    }\r\n  }\r\n\r\n  static copy(object = {}, ...sources) {\r\n    if (SheetUtils.isUnDef(object)) {\r\n      return {};\r\n    }\r\n    if (SheetUtils.isUnDef(sources) || sources.length === 0) {\r\n      return object;\r\n    }\r\n    sources.forEach((source) => {\r\n      if (SheetUtils.isUnDef(source)) return;\r\n      Object.keys(source).forEach((key) => {\r\n        const v = source[key];\r\n        if (typeof v === 'string' || typeof v === 'number' || typeof v === 'boolean') {\r\n          object[key] = v;\r\n        } else if (typeof v !== 'function' && !Array.isArray(v) && SheetUtils.isPlainObject(v)) {\r\n          object[key] = object[key] || {};\r\n          SheetUtils.copy(object[key], v);\r\n        } else {\r\n          object[key] = v;\r\n        }\r\n      });\r\n    });\r\n    return object;\r\n  }\r\n\r\n  static cloneDeep(object) {\r\n    const json = JSON.stringify(object);\r\n    return JSON.parse(json);\r\n  }\r\n\r\n  static extends(target, ...src) {\r\n    for (let i = 0, len = src.length; i < len; i++) {\r\n      const item = src[i];\r\n      for (let key in item) {\r\n        if (item.hasOwnProperty(key)) {\r\n          const value = item[key];\r\n          if (SheetUtils.isDef(value)) {\r\n            target[key] = value;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return target;\r\n  }\r\n\r\n  static sum(objOrAry, cb = value => value) {\r\n    let total = 0;\r\n    let size = 0;\r\n    Object.keys(objOrAry).forEach((key) => {\r\n      total += cb(objOrAry[key], key);\r\n      size += 1;\r\n    });\r\n    return [total, size];\r\n  }\r\n\r\n  static parseFloat(val) {\r\n    if (SheetUtils.isNumber(val)) return parseFloat(val);\r\n    return 0;\r\n  }\r\n\r\n  static parseInt(val) {\r\n    if (SheetUtils.isNumber(val)) return parseInt(val, 10);\r\n    return 0;\r\n  }\r\n\r\n  static stringAt(index) {\r\n    let str = '';\r\n    let idx = index;\r\n    while (idx >= alphabets.length) {\r\n      idx /= alphabets.length;\r\n      idx -= 1;\r\n      str += alphabets[parseInt(idx, 10) % alphabets.length];\r\n    }\r\n    const last = index % alphabets.length;\r\n    str += alphabets[last];\r\n    return str;\r\n  }\r\n\r\n  static indexAt(str) {\r\n    let ret = 0;\r\n    for (let i = 0; i < str.length - 1; i += 1) {\r\n      const idx = str.charCodeAt(i) - 65;\r\n      const expoNet = str.length - 1 - i;\r\n      ret += (alphabets.length ** expoNet) + (alphabets.length * idx);\r\n    }\r\n    ret += str.charCodeAt(str.length - 1) - 65;\r\n    return ret;\r\n  }\r\n\r\n  static expr2xy(src) {\r\n    let x = '';\r\n    let y = '';\r\n    for (let i = 0; i < src.length; i += 1) {\r\n      if (src.charAt(i) >= '0' && src.charAt(i) <= '9') {\r\n        y += src.charAt(i);\r\n      } else {\r\n        x += src.charAt(i);\r\n      }\r\n    }\r\n    return [SheetUtils.indexAt(x), parseInt(y, 10) - 1];\r\n  }\r\n\r\n  static xy2expr(x, y) {\r\n    return `${SheetUtils.stringAt(x)}${y + 1}`;\r\n  }\r\n\r\n  static expr2expr(src, xn, yn) {\r\n    const [x, y] = SheetUtils.expr2xy(src);\r\n    return SheetUtils.xy2expr(x + xn, y + yn);\r\n  }\r\n\r\n  static minIf(v, min) {\r\n    if (v < min) return min;\r\n    return v;\r\n  }\r\n\r\n  static keepLastIndex(obj) {\r\n    const range = window.getSelection();\r\n    range.selectAllChildren(obj);\r\n    range.collapseToEnd();\r\n  }\r\n\r\n  static trim(s) {\r\n    if (this.isBlank(s)) return '';\r\n    return s.trim();\r\n  }\r\n\r\n  static now() {\r\n    return Date.now().toString();\r\n  }\r\n\r\n  static viewPort() {\r\n    return {\r\n      width: window.innerWidth,\r\n      height: window.innerHeight,\r\n    };\r\n  }\r\n\r\n  static exitFullscreen() {\r\n    if (document.exitFullscreen) {\r\n      document.exitFullscreen();\r\n    } else if (document.msExitFullscreen) {\r\n      document.msExitFullscreen();\r\n    } else if (document.mozCancelFullScreen) {\r\n      document.mozCancelFullScreen();\r\n    } else if (document.webkitExitFullscreen) {\r\n      document.webkitExitFullscreen();\r\n    }\r\n  }\r\n\r\n  static fullScreen(element) {\r\n    if (element.el) {\r\n      element = element.el;\r\n    }\r\n    if (element.requestFullscreen) {\r\n      element.requestFullscreen();\r\n    } else if (element.msRequestFullscreen) {\r\n      element.msRequestFullscreen();\r\n    } else if (element.mozRequestFullScreen) {\r\n      element.mozRequestFullScreen();\r\n    } else if (element.webkitRequestFullscreen) {\r\n      element.webkitRequestFullscreen();\r\n    }\r\n  }\r\n\r\n  static isFull() {\r\n    return !!(document.webkitIsFullScreen || document.mozFullScreen\r\n      || document.msFullscreenElement || document.fullscreenElement);\r\n  }\r\n\r\n  static uuid() {\r\n    return (`${S4() + S4()}${S4()}${S4()}${S4()}${S4()}${S4()}${S4()}`);\r\n  }\r\n\r\n  static equals(one, tow) {\r\n    function diffValue(oneValue, towValue) {\r\n      const oneType = SheetUtils.type(oneValue);\r\n      const towType = SheetUtils.type(towValue);\r\n      if (oneType !== towType) {\r\n        return false;\r\n      }\r\n      if (SheetUtils.isArray(oneValue)) {\r\n        return diffArrays(oneValue, towValue);\r\n      }\r\n      if (SheetUtils.isObject(oneValue)) {\r\n        return diffObject(oneValue, towValue);\r\n      }\r\n      if (SheetUtils.isDate(oneValue)) {\r\n        return oneValue.getTime() === towValue.getTime();\r\n      }\r\n      if (SheetUtils.isRegExp(oneValue)) {\r\n        return oneValue.toString() === towValue.toString();\r\n      }\r\n      return oneValue === towValue;\r\n    }\r\n    function diffArrays(one, tow) {\r\n      if (one.length !== tow.length) {\r\n        return false;\r\n      }\r\n      for (let i = 0, len = one.length; i < len; i++) {\r\n        const oneValue = one[i];\r\n        const towValue = tow[i];\r\n        if (!diffValue(oneValue, towValue)) {\r\n          return false;\r\n        }\r\n      }\r\n      return true;\r\n    }\r\n    function diffObject(one, tow) {\r\n      const oneKeys = Object.keys(one);\r\n      const towKeys = Object.keys(tow);\r\n      if (oneKeys.length !== towKeys.length) {\r\n        return false;\r\n      }\r\n      for (const key of oneKeys) {\r\n        if (!towKeys.includes(key)) {\r\n          return false;\r\n        }\r\n        const oneValue = one[key];\r\n        const towValue = tow[key];\r\n        if (!diffValue(oneValue, towValue)) {\r\n          return false;\r\n        }\r\n      }\r\n      return true;\r\n    }\r\n    return diffValue(one, tow);\r\n  }\r\n\r\n  static toFixed(num, fixed) {\r\n    if (num.toString().indexOf('.') > -1) {\r\n      return num.toFixed(fixed);\r\n    }\r\n    return num;\r\n  }\r\n\r\n  static getExplorerInfo() {\r\n    const explorer = window.navigator.userAgent.toLowerCase();\r\n    // firefox\r\n    if (explorer.indexOf('firefox') >= 0) {\r\n      const ver = explorer.match(/firefox\\/([\\d.]+)/)[1];\r\n      return { type: 'Firefox', version: ver };\r\n    }\r\n    // Chrome\r\n    if (explorer.indexOf('chrome') >= 0) {\r\n      const ver = explorer.match(/chrome\\/([\\d.]+)/)[1];\r\n      return { type: 'Chrome', version: ver };\r\n    }\r\n    // Opera\r\n    if (explorer.indexOf('opera') >= 0) {\r\n      const ver = explorer.match(/opera.([\\d.]+)/)[1];\r\n      return { type: 'Opera', version: ver };\r\n    }\r\n    // Safari\r\n    if (explorer.indexOf('safari') >= 0) {\r\n      const ver = explorer.match(/version\\/([\\d.]+)/)[1];\r\n      return { type: 'Safari', version: ver };\r\n    }\r\n    // ie\r\n    if (explorer.indexOf('msie') >= 0) {\r\n      const ver = explorer.match(/msie ([\\d.]+)/)[1];\r\n      return { type: 'IE', version: ver };\r\n    }\r\n    // undefined\r\n    return undefined;\r\n  }\r\n\r\n  static arrayLast(array) {\r\n    return array[array.length - 1];\r\n  }\r\n\r\n  static arrayHead(array) {\r\n    return array[0];\r\n  }\r\n\r\n  static blankClear(value) {\r\n    if (SheetUtils.isString(value)) {\r\n      return value.replace(/\\s*/g, SheetUtils.EMPTY);\r\n    }\r\n    return value;\r\n  }\r\n\r\n  static safeValue(value, defaultValue = '') {\r\n    return SheetUtils.isUnDef(value) ? defaultValue : value;\r\n  }\r\n\r\n  static inWorker() {\r\n    // eslint-disable-next-line no-restricted-globals\r\n    const type = SheetUtils.type(self);\r\n    return type === DATA_TYPE.DedicatedWorkerGlobalScope;\r\n  }\r\n\r\n  static if(condition, establish, otherwise) {\r\n    return condition ? establish() : otherwise();\r\n  }\r\n\r\n  static slice(likeArray) {\r\n    return Array.prototype.slice.call(likeArray);\r\n  }\r\n\r\n  static clearBlank(str) {\r\n    return str ? str.replace(/\\s/g, '') : str;\r\n  }\r\n\r\n  static clearHideCode(str) {\r\n    let result = '';\r\n    for (let i = 0; i < str.length; i++) {\r\n      let value = str.charAt(i);\r\n      // 过滤掉 &#xFEFF; 隐藏字符串\r\n      // 服了 ！！！！！\r\n      let code = encodeURI(value);\r\n      if (code !== '%EF%BB%BF') {\r\n        result += value;\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n}\r\n\r\nSheetUtils.EMPTY = '';\r\nSheetUtils.Nul = null;\r\nSheetUtils.Undef = undefined;\r\nSheetUtils.noop = () => {};\r\nSheetUtils.DATA_TYPE = DATA_TYPE;\r\n\r\nexport {\r\n  SheetUtils,\r\n};\r\n","class BaseFont {\r\n\r\n  constructor({\r\n    draw, ruler, attr,\r\n  }) {\r\n    this.draw = draw;\r\n    this.attr = attr;\r\n    this.ruler = ruler;\r\n  }\r\n\r\n  setRuler(ruler) {\r\n    this.ruler = ruler;\r\n  }\r\n\r\n  getAlignPadding() {\r\n    if (this.attr.align === BaseFont.ALIGN.center) {\r\n      return 0;\r\n    }\r\n    return this.attr.padding;\r\n  }\r\n\r\n  getVerticalAlignPadding() {\r\n    if (this.attr.verticalAlign === BaseFont.VERTICAL_ALIGN.center) {\r\n      return 0;\r\n    }\r\n    return this.attr.padding;\r\n  }\r\n\r\n}\r\n\r\nBaseFont.VERTICAL_ALIGN = {\r\n  top: 'top',\r\n  center: 'middle',\r\n  bottom: 'bottom',\r\n};\r\nBaseFont.ALIGN = {\r\n  left: 'left',\r\n  center: 'center',\r\n  right: 'right',\r\n};\r\nBaseFont.TEXT_WRAP = {\r\n  OVER_FLOW: 1,\r\n  WORD_WRAP: 2,\r\n  TRUNCATE: 3,\r\n};\r\nBaseFont.TEXT_DIRECTION = {\r\n  HORIZONTAL: 'horizontal',\r\n  VERTICAL: 'vertical',\r\n  ANGLE: 'angle',\r\n  ANGLE_BAR: 'bar',\r\n};\r\nBaseFont.DEFAULT_FONT_ATTR = {\r\n  name: 'Arial',\r\n  size: 14,\r\n  color: 'rgb(0,0,0)',\r\n  bold: false,\r\n  italic: false,\r\n  strikethrough: false,\r\n  underline: false,\r\n  angle: 0,\r\n  padding: 8,\r\n  align: BaseFont.ALIGN.left,\r\n  textWrap: BaseFont.TEXT_WRAP.TRUNCATE,\r\n  verticalAlign: BaseFont.VERTICAL_ALIGN.center,\r\n  direction: BaseFont.TEXT_DIRECTION.HORIZONTAL,\r\n};\r\nBaseFont.DEFAULT_RICH_ATTR = {\r\n  angle: 0,\r\n  padding: 8,\r\n  align: BaseFont.ALIGN.left,\r\n  textWrap: BaseFont.TEXT_WRAP.TRUNCATE,\r\n  verticalAlign: BaseFont.VERTICAL_ALIGN.center,\r\n  direction: BaseFont.TEXT_DIRECTION.HORIZONTAL,\r\n};\r\nBaseFont.DEFAULT_RICH_ITEM_ATTR = {\r\n  name: 'Arial',\r\n  size: 14,\r\n  color: 'rgb(0,0,0)',\r\n  bold: false,\r\n  italic: false,\r\n  strikethrough: false,\r\n  underline: false,\r\n};\r\n\r\nexport {\r\n  BaseFont,\r\n};\r\n","/* global document MouseEvent CustomEvent window NodeList HTMLCollection DocumentFragment */\r\nimport { SheetUtils } from '../utils/SheetUtils';\r\n\r\n/**\r\n * Element\r\n */\r\nclass Element {\r\n\r\n  /**\r\n   * 包装元素\r\n   */\r\n  static wrapElement(object) {\r\n    if ([\r\n      SheetUtils.isArray(object),\r\n      object instanceof HTMLCollection,\r\n      object instanceof NodeList,\r\n    ].includes(true)) {\r\n      let elements = [];\r\n      for (let i = 0; i < object.length; i++) {\r\n        const item = object[i];\r\n        if (item instanceof Element) {\r\n          elements.push(item);\r\n        } else {\r\n          elements.push(new Element(item));\r\n        }\r\n      }\r\n      return elements;\r\n    }\r\n    return new Element(object);\r\n  }\r\n\r\n  static createText(text) {\r\n    return new Element(document.createTextNode(text));\r\n  }\r\n\r\n  /**\r\n   * 驼峰转连字符\r\n   * @param value\r\n   * @returns {string|null}\r\n   */\r\n  static hyphenateRE(value) {\r\n    if (value) {\r\n      return value.replace(/([A-Z])/g, '-$1').toLowerCase();\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Element\r\n   * @param tag\r\n   * @param className\r\n   */\r\n  constructor(tag, className = '') {\r\n    if (typeof tag === 'string') {\r\n      this.el = document.createElement(tag);\r\n      if (className) {\r\n        this.el.className = className;\r\n      }\r\n    } else {\r\n      this.el = tag;\r\n    }\r\n    this.map = {};\r\n  }\r\n\r\n  /**\r\n   * 数据绑定\r\n   * @param key\r\n   * @param value\r\n   * @returns {Element|*}\r\n   */\r\n  data(key, value) {\r\n    if (value !== undefined) {\r\n      this.map[key] = value;\r\n      return this;\r\n    }\r\n    return this.map[key];\r\n  }\r\n\r\n  /**\r\n   * 空参数时返回子元素,\r\n   * 有参数时插入子节点\r\n   * @param args\r\n   * @returns {*[]|Element}\r\n   */\r\n  children(...args) {\r\n    if (arguments.length === 0) {\r\n      return Element.wrapElement(this.el.children);\r\n    }\r\n    args.forEach(ele => this.append(ele));\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 空参数时返回子节点,\r\n   * 有参数时插入子节点\r\n   * @param args\r\n   * @returns {*[]|Element}\r\n   */\r\n  childrenNodes(...args) {\r\n    if (arguments.length === 0) {\r\n      return Element.wrapElement(this.el.childNodes);\r\n    }\r\n    args.forEach(ele => this.append(ele));\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 将目标节点添加到当前元素中\r\n   * @param ele\r\n   */\r\n  childrenNodesAppend(ele) {\r\n    if (!this.isTextNode()) {\r\n      ele.childrenNodes().forEach(i => this.append(i));\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 将目标节点添加到当前元素中\r\n   * @param ele\r\n   */\r\n  childrenNodesPrepend(ele) {\r\n    if (!this.isTextNode()) {\r\n      ele.childrenNodes().forEach(i => this.prepend(i));\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 在当前元素中插入指定节点\r\n   * @param ele\r\n   */\r\n  append(ele) {\r\n    if (!this.isTextNode()) {\r\n      if (ele && ele.el) {\r\n        this.el.append(ele.el);\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 在当前元素中插入指定节点\r\n   * @param ele\r\n   */\r\n  prepend(ele) {\r\n    if (!this.isTextNode()) {\r\n      if (ele && ele.el) {\r\n        this.el.prepend(ele.el);\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 元素定位\r\n   * @param value\r\n   * @returns {{top: *, left: *, width: *, height: *}|Element}\r\n   */\r\n  offset(value) {\r\n    if (value !== undefined) {\r\n      Object.keys(value).forEach((k) => {\r\n        this.css(k, `${value[k]}px`);\r\n      });\r\n      return this;\r\n    }\r\n    const { offsetTop, offsetLeft } = this.el;\r\n    const { offsetHeight, offsetWidth } = this.el;\r\n    return {\r\n      top: offsetTop,\r\n      left: offsetLeft,\r\n      height: offsetHeight,\r\n      width: offsetWidth,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 获取当前元素的父节点\r\n   * @returns {Element}\r\n   */\r\n  parent() {\r\n    return this.el.parentNode\r\n      ? new Element(this.el.parentNode) : null;\r\n  }\r\n\r\n  /**\r\n   * 添加Class名称\r\n   * @param name\r\n   * @returns {Element}\r\n   */\r\n  addClass(name) {\r\n    if (!this.isTextNode()) {\r\n      this.el.classList.add(name);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 是否具有指定Class名称\r\n   * @param name\r\n   * @returns {boolean}\r\n   */\r\n  hasClass(name) {\r\n    if (!this.isTextNode()) {\r\n      return this.el.classList.contains(name);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * 是否有子元素\r\n   * @returns {boolean}\r\n   */\r\n  hasChildElement() {\r\n    return this.children().length > 0;\r\n  }\r\n\r\n  /**\r\n   * 是否有子节点\r\n   * @returns {boolean}\r\n   */\r\n  hasChild() {\r\n    return this.childrenNodes().length > 0;\r\n  }\r\n\r\n  /**\r\n   * 删除Class名称\r\n   * @param name\r\n   * @returns {Element}\r\n   */\r\n  removeClass(name) {\r\n    if (!this.isTextNode()) {\r\n      this.el.classList.remove(name);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 获取元素坐标信息\r\n   * getBoundingClientRect\r\n   * @returns {DOMRect}\r\n   */\r\n  box() {\r\n    if (!this.isTextNode()) {\r\n      return this.el.getBoundingClientRect();\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * 获取当前第一个子元素\r\n   * @returns {*}\r\n   */\r\n  first() {\r\n    if (!this.isTextNode()) {\r\n      return Element.wrapElement(this.el.firstChild);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * 获取最后一个子元素\r\n   * @returns {*}\r\n   */\r\n  last() {\r\n    if (!this.isTextNode()) {\r\n      return Element.wrapElement(this.el.lastChild);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * 获取第一个文本节点\r\n   */\r\n  firstTextNode() {\r\n    if (this.isTextNode()) {\r\n      return this;\r\n    }\r\n    let find = null;\r\n    let handle = (elem) => {\r\n      if (elem.hasChild()) {\r\n        elem.childrenNodes().forEach((elem) => {\r\n          if (find === null) {\r\n            handle(elem);\r\n          }\r\n        });\r\n      }\r\n      if (find === null) {\r\n        if (elem.isTextNode()) {\r\n          find = elem;\r\n        }\r\n      }\r\n    };\r\n    handle(this);\r\n    return find;\r\n  }\r\n\r\n  /**\r\n   * 获取最后一个文本节点\r\n   */\r\n  lastTextNode() {\r\n    if (this.isTextNode()) {\r\n      return this;\r\n    }\r\n    let find = null;\r\n    let handle = (elem) => {\r\n      if (elem.hasChild()) {\r\n        elem.childrenNodes().reverse().forEach((elem) => {\r\n          if (find === null) {\r\n            handle(elem);\r\n          }\r\n        });\r\n      }\r\n      if (find === null) {\r\n        if (elem.isTextNode()) {\r\n          find = elem;\r\n        }\r\n      }\r\n    };\r\n    handle(this);\r\n    return find;\r\n  }\r\n\r\n  /**\r\n   * 删除当前元素下的子元素\r\n   * @param target\r\n   * @returns {boolean|ActiveX.IXMLDOMNode|*}\r\n   */\r\n  remove(target = null) {\r\n    if (target) {\r\n      if (!this.isTextNode()) {\r\n        this.el.removeChild(target.el || target);\r\n      }\r\n    } else {\r\n      const parent = this.parent();\r\n      if (parent) {\r\n        this.parent().remove(this);\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 当前元素是否包含指定节点\r\n   * @param ele\r\n   * @returns {boolean|*}\r\n   */\r\n  contains(ele) {\r\n    if (this.isTextNode()) {\r\n      return false;\r\n    }\r\n    return this.el.contains(ele.el);\r\n  }\r\n\r\n  /**\r\n   * 获取当前元素的上一个元素\r\n   * @returns {*}\r\n   */\r\n  prev() {\r\n    return this.el.previousSibling\r\n      ? Element.wrapElement(this.el.previousSibling) : null;\r\n  }\r\n\r\n  /**\r\n   * 获取当前元素的下一个元素\r\n   * @returns {*}\r\n   */\r\n  next() {\r\n    return this.el.nextSibling\r\n      ? Element.wrapElement(this.el.nextSibling) : null;\r\n  }\r\n\r\n  /**\r\n   * 设置元素的激活状态\r\n   * @param flag\r\n   * @param cls\r\n   * @returns {Element}\r\n   */\r\n  active(flag = true, cls = 'active') {\r\n    if (!this.isTextNode()) {\r\n      if (flag) this.addClass(cls);\r\n      else this.removeClass(cls);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置元素文本\r\n   * @param text\r\n   * @returns {string|Element}\r\n   */\r\n  text(text) {\r\n    if (this.isTextNode()) {\r\n      return this.nodeValue();\r\n    }\r\n    if (text !== undefined) {\r\n      this.el.innerText = text;\r\n      return this;\r\n    }\r\n    return this.el.innerText;\r\n  }\r\n\r\n  /**\r\n   * 设置元素html内容\r\n   * @param html\r\n   * @returns {Element|*}\r\n   */\r\n  html(html) {\r\n    if (this.isTextNode()) {\r\n      return this.nodeValue();\r\n    }\r\n    if (html !== undefined) {\r\n      this.el.innerHTML = html;\r\n      return this;\r\n    }\r\n    return this.el.innerHTML;\r\n  }\r\n\r\n  /**\r\n   * 当前元素设置焦点\r\n   */\r\n  focus() {\r\n    if (!this.isTextNode()) {\r\n      this.el.focus();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 移除焦点\r\n   */\r\n  blur() {\r\n    if (!this.isTextNode()) {\r\n      this.el.blur();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 删除元素属性\r\n   * @param key\r\n   * @returns {Element}\r\n   */\r\n  removeAttr(key) {\r\n    if (!this.isTextNode()) {\r\n      this.el.removeAttribute(key);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 添加style\r\n   * @param style\r\n   */\r\n  style(style) {\r\n    if (!this.isTextNode()) {\r\n      this.attr('style', style);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 添加元素属性\r\n   * @param key\r\n   * @param value\r\n   * @returns {string|Element}\r\n   */\r\n  attr(key, value) {\r\n    if (!this.isTextNode()) {\r\n      if (value !== undefined) {\r\n        if (this.el.setAttribute) {\r\n          this.el.setAttribute(key, value);\r\n        }\r\n      } else {\r\n        if (typeof key === 'string') {\r\n          if (this.el.setAttribute) {\r\n            return this.el.getAttribute(key);\r\n          }\r\n          return null;\r\n        }\r\n        if (this.el.setAttribute) {\r\n          Object.keys(key).forEach((k) => {\r\n            this.el.setAttribute(k, key[k]);\r\n          });\r\n        }\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置元素Value\r\n   * @param v\r\n   * @returns {Element|*}\r\n   */\r\n  val(v) {\r\n    if (!this.isTextNode()) {\r\n      if (v !== undefined) {\r\n        this.el.value = v;\r\n        return this;\r\n      }\r\n      return this.el.value;\r\n    }\r\n    if (v === undefined) {\r\n      return this.nodeValue();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 获取原始节点\r\n   * @returns {*}\r\n   */\r\n  get() {\r\n    return this.el;\r\n  }\r\n\r\n  /**\r\n   * 删除元素style属性\r\n   * @param keys\r\n   * @returns {Element}\r\n   */\r\n  cssRemoveKeys(...keys) {\r\n    if (!this.isTextNode()) {\r\n      if (this.el.style) {\r\n        keys.forEach((k) => {\r\n          if (this.el.style) {\r\n            this.el.style.removeProperty(Element.hyphenateRE(k));\r\n          }\r\n        });\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 删除元素style属性\r\n   * @param key\r\n   * @param value\r\n   * @returns {Element}\r\n   */\r\n  cssRemoveVal(key, value) {\r\n    if (!this.isTextNode()) {\r\n      if (this.el.style) {\r\n        const property = Element.hyphenateRE(key);\r\n        const propertyValue = this.el.style.getPropertyValue(property);\r\n        const newValue = propertyValue.replace(value, '');\r\n        this.css(key, newValue);\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置元素属性\r\n   * @param name\r\n   * @param value\r\n   * @returns {Element|*}\r\n   */\r\n  css(name, value) {\r\n    if (!this.isTextNode()) {\r\n      if (this.el.style) {\r\n        if (value === undefined && typeof name !== 'string') {\r\n          Object.keys(name).forEach((key) => {\r\n            const property = Element.hyphenateRE(key);\r\n            this.el.style.setProperty(property, name[key]);\r\n          });\r\n          return this;\r\n        }\r\n        if (value !== undefined) {\r\n          const property = Element.hyphenateRE(name);\r\n          this.el.style.setProperty(property, value);\r\n          return this;\r\n        }\r\n        const property = Element.hyphenateRE(name);\r\n        return this.el.style.getPropertyValue(property);\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * 获取元素计算完成的样式\r\n   * @returns {CSSStyleDeclaration}\r\n   */\r\n  computedStyle() {\r\n    if (!this.isTextNode()) {\r\n      return window.getComputedStyle(this.el, null);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * 显示\r\n   * @returns {Element}\r\n   */\r\n  show() {\r\n    if (!this.isTextNode()) {\r\n      const style = this.computedStyle();\r\n      if (style && style.display !== 'block') {\r\n        this.css('display', 'block');\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 隐藏\r\n   * @returns {Element}\r\n   */\r\n  hide() {\r\n    if (!this.isTextNode()) {\r\n      const style = this.computedStyle();\r\n      if (style && style.display !== 'none') {\r\n        this.css('display', 'none');\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 事件触发\r\n   * @param type\r\n   * @param message\r\n   */\r\n  trigger(type, message) {\r\n    if (!this.isTextNode()) {\r\n      switch (type) {\r\n        case 'click': {\r\n          const evt = new MouseEvent(type, {\r\n            detail: message,\r\n            bubbles: true,\r\n            cancelable: false,\r\n          });\r\n          evt.initEvent('click', true, true);\r\n          this.el.dispatchEvent(evt);\r\n          break;\r\n        }\r\n        default: {\r\n          const evt = new CustomEvent(type, {\r\n            detail: message,\r\n            bubbles: true,\r\n            cancelable: false,\r\n          });\r\n          this.el.dispatchEvent(evt);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 查找子元素\r\n   * @param select\r\n   * @returns {[]|Element}\r\n   */\r\n  find(select) {\r\n    if (!this.isTextNode()) {\r\n      const result = this.el.querySelectorAll(select);\r\n      if (result && result.length === 1) {\r\n        return new Element(result[0]);\r\n      }\r\n      const array = [];\r\n      if (result) {\r\n        for (const item of result) {\r\n          array.push(new Element(item));\r\n        }\r\n      }\r\n      return array;\r\n    }\r\n    return [];\r\n  }\r\n\r\n  /**\r\n   * 查找子元素\r\n   * @param select\r\n   * @returns {[]|Element}\r\n   */\r\n  finds(select) {\r\n    if (!this.isTextNode()) {\r\n      const result = this.el.querySelectorAll(select);\r\n      const array = [];\r\n      if (result) {\r\n        for (const item of result) {\r\n          array.push(new Element(item));\r\n        }\r\n      }\r\n      return array;\r\n    }\r\n    return [];\r\n  }\r\n\r\n  /**\r\n   * 获取当前元素的兄弟节点\r\n   * @returns {[]}\r\n   */\r\n  sibling() {\r\n    let sibling = this.el;\r\n    const result = [];\r\n    // eslint-disable-next-line no-cond-assign\r\n    while ((sibling = sibling.previousElementSibling) !== null) result.push(new Element(sibling));\r\n    sibling = this.el;\r\n    // eslint-disable-next-line no-cond-assign\r\n    while ((sibling = sibling.nextElementSibling) !== null) result.push(new Element(sibling));\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * 节点名称\r\n   * @returns {string}\r\n   */\r\n  tagName() {\r\n    return this.el.nodeName.toLocaleLowerCase();\r\n  }\r\n\r\n  /**\r\n   * 节点内容\r\n   * @returns {string}\r\n   */\r\n  nodeValue() {\r\n    return this.el.nodeValue;\r\n  }\r\n\r\n  /**\r\n   * 节点类型\r\n   * @returns {number}\r\n   */\r\n  nodeType() {\r\n    return this.el.nodeType;\r\n  }\r\n\r\n  /**\r\n   * 在当前元素之后插入新元素\r\n   * @param ele\r\n   */\r\n  after(ele) {\r\n    if (this.el && ele && ele.el) {\r\n      this.el.after(ele.el);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 在当前元素之前插入新元素\r\n   * @param ele\r\n   */\r\n  before(ele) {\r\n    if (this.el && ele && ele.el) {\r\n      this.el.before(ele.el);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 复制\r\n   */\r\n  clone() {\r\n    return new Element(this.el.cloneNode(true));\r\n  }\r\n\r\n  /**\r\n   * 清空元素中的所有内容\r\n   */\r\n  empty() {\r\n    if (!this.isTextNode()) {\r\n      this.html('');\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 相等比较\r\n   * @param other\r\n   * @returns {boolean}\r\n   */\r\n  equals(other) {\r\n    return this.el === other.el;\r\n  }\r\n\r\n  /**\r\n   * 获取当前元素在父元素中的索引\r\n   * @returns {number}\r\n   */\r\n  index() {\r\n    let parent = this.parent();\r\n    let index = -1;\r\n    parent.childrenNodes()\r\n      .forEach((v, i) => {\r\n        if (v.equals(this)) {\r\n          index = i;\r\n        }\r\n      });\r\n    return index;\r\n  }\r\n\r\n  /**\r\n   * 比较dom是否相同\r\n   * @param ele\r\n   * @returns {boolean}\r\n   */\r\n  is(ele) {\r\n    return this.el === ele.el;\r\n  }\r\n\r\n  /**\r\n   * 是否文本节点\r\n   * @returns {boolean}\r\n   */\r\n  isTextNode() {\r\n    return this.tagName() === '#text';\r\n  }\r\n\r\n  /**\r\n   * 是否换行节点\r\n   * @returns {boolean}\r\n   */\r\n  isBreakNode() {\r\n    return this.tagName() === 'br';\r\n  }\r\n\r\n  /**\r\n   * 是否文档碎片\r\n   * @returns {boolean}\r\n   */\r\n  isDocumentFragment() {\r\n    return this.el instanceof DocumentFragment;\r\n  }\r\n\r\n}\r\n\r\nconst h = (tag, className = '') => new Element(tag, className);\r\n\r\nconst TextNode = text => Element.createText(text);\r\n\r\nexport {\r\n  Element,\r\n  TextNode,\r\n  h,\r\n};\r\n","const cssPrefix = 'x-sheet';\r\nconst XSheetVersion = `${cssPrefix} 1.0.0-develop`;\r\nconst Constant = {};\r\nConstant.WORK_BODY_EVENT_TYPE = {\r\n  CHANGE_ACTIVE: 'changeactive',\r\n  REMOVE_SHEET: 'removesheet',\r\n};\r\nConstant.SYSTEM_EVENT_TYPE = {\r\n  MOUSE_MOVE: 'mousemove',\r\n  MOUSE_DOWN: 'mousedown',\r\n  CONTEXT_MENU: 'contextmenu',\r\n  SCROLL: 'scroll',\r\n  RESIZE: 'resize',\r\n  MOUSE_UP: 'mouseup',\r\n  INPUT: 'input',\r\n  KEY_DOWN: 'keydown',\r\n  KEY_UP: 'keyup',\r\n  MOUSE_OVER: 'mouseover',\r\n  MOUSE_LEAVE: 'mouseleave',\r\n  MOUSE_WHEEL: 'wheel',\r\n  MOUSE_ENTER: 'mouseenter',\r\n  CLICK: 'click',\r\n  FOCUS: 'focus',\r\n  DRAG_START: 'dragstart',\r\n  CHANGE: 'change',\r\n  VISIBILITY_CHANGE: 'visibilitychange',\r\n};\r\nConstant.TABLE_EVENT_TYPE = {\r\n  RENDER: 'render',\r\n  SNAPSHOT_CHANGE: 'snapshotchange',\r\n  CHANGE_ROW_HEIGHT: 'changerowheight',\r\n  CHANGE_COL_WIDTH: 'changecolwidth',\r\n  SCALE_CHANGE: 'scalechange',\r\n  EDIT_START: 'editstart',\r\n  EDIT_INPUT: 'editinput',\r\n  EDIT_FINISH: 'editfinish',\r\n  REMOVE_ROW: 'removerow',\r\n  REMOVE_COL: 'removecol',\r\n  ADD_NEW_ROW: 'addnewrow',\r\n  ADD_NEW_COL: 'addnewcol',\r\n  FIXED_CHANGE: 'fixedchange',\r\n  FIXED_COL_CHANGE: 'fixedcolchange',\r\n  FIXED_ROW_CHANGE: 'fixedrowchange',\r\n  SELECT_OVER: 'selectover',\r\n  SELECT_DOWN: 'selectdown',\r\n  SELECT_CHANGE: 'selectchange',\r\n  DATA_CHANGE: 'datachange',\r\n  RESIZE_CHANGE: 'resizechange',\r\n};\r\nConstant.FORM_EVENT_TYPE = {\r\n  SEARCH_INPUT_CHANGE: 'searchinputchange',\r\n  PLAIN_INPUT_CHANGE: 'plaininputchange',\r\n  FORM_SELECT_CHANGE: 'formselectchange',\r\n};\r\nexport {\r\n  XSheetVersion,\r\n  Constant,\r\n  cssPrefix,\r\n};\r\n","import { Constant } from '../const/Constant';\r\nimport { Element } from './Element';\r\n\r\nclass BindPool {\r\n\r\n  constructor() {\r\n    this.pool = [];\r\n  }\r\n\r\n  unbind(ele, type, callback, option) {\r\n    if (ele instanceof Element) {\r\n      ele = ele.el;\r\n    }\r\n    const result = this.remove(ele, type, callback, option);\r\n    if (result.length) {\r\n      result.forEach((item) => {\r\n        ele.removeEventListener(item.type, item.callback, item.option);\r\n      });\r\n    } else {\r\n      ele.removeEventListener(type, callback, option);\r\n    }\r\n  }\r\n\r\n  bind(ele, type, callback, option) {\r\n    if (ele instanceof Element) {\r\n      ele = ele.el;\r\n    }\r\n    this.pool.push({\r\n      ele, type, callback, option,\r\n    });\r\n    ele.addEventListener(type, callback, option);\r\n  }\r\n\r\n  remove(ele, type = '*', callback = null, option = null) {\r\n    const pool = [];\r\n    const rem = [];\r\n    this.pool.forEach((item) => {\r\n      const eqElem = ele === item.ele;\r\n      const eqOpt = option === null || option === item.option;\r\n      const eqType = type === '*' || type === item.type;\r\n      const eqCall = callback === null || callback === item.callback;\r\n      if (eqElem && eqType && eqCall && eqOpt) {\r\n        rem.push(item);\r\n      } else {\r\n        pool.push(item);\r\n      }\r\n    });\r\n    this.pool = pool;\r\n    return rem;\r\n  }\r\n\r\n  multipleUnbind(eles, type, callback, option) {\r\n    eles.forEach((item) => {\r\n      this.unbind(item, type, callback, option);\r\n    });\r\n  }\r\n\r\n  multipleBind(eles, type, callback, option) {\r\n    eles.forEach((item) => {\r\n      this.bind(item, type, callback, option);\r\n    });\r\n  }\r\n\r\n}\r\n\r\nconst pool = new BindPool();\r\n\r\nclass XEvent {\r\n\r\n  static unbind(target, name, fn, option = false) {\r\n    if (Array.isArray(target)) {\r\n      pool.multipleUnbind(target, name, fn, option);\r\n    } else {\r\n      pool.unbind(target, name, fn, option);\r\n    }\r\n    return target;\r\n  }\r\n\r\n  static bind(target, name, fn, option = false) {\r\n    if (Array.isArray(target)) {\r\n      pool.multipleBind(target, name, fn, option);\r\n    } else {\r\n      pool.bind(target, name, fn, option);\r\n    }\r\n    return target;\r\n  }\r\n\r\n  static mouseHold(target, holdFunc = () => {}, endFunc = () => {}, time = 150) {\r\n    let handle = setInterval(() => {\r\n      holdFunc();\r\n    }, time);\r\n    let xEvtUp = (evt) => {\r\n      clearInterval(handle);\r\n      XEvent.unbind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_UP, xEvtUp, true);\r\n      endFunc(evt);\r\n    };\r\n    holdFunc();\r\n    XEvent.bind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_UP, xEvtUp, true);\r\n  }\r\n\r\n  static mouseMoveUp(target, moveFunc = () => {}, upFunc = () => {}) {\r\n    const xEvtMove = (evt) => {\r\n      moveFunc(evt);\r\n      evt.stopPropagation();\r\n      evt.preventDefault();\r\n    };\r\n    const xEvtUp = (evt) => {\r\n      XEvent.unbind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_MOVE, xEvtMove, true);\r\n      XEvent.unbind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_UP, xEvtUp, true);\r\n      upFunc(evt);\r\n      evt.preventDefault();\r\n    };\r\n    XEvent.bind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_MOVE, xEvtMove, true);\r\n    XEvent.bind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_UP, xEvtUp, true);\r\n    return target;\r\n  }\r\n\r\n}\r\n\r\nXEvent.WrapFuncion = {\r\n  doubleClick: (callback) => {\r\n    let lastPageX = 0;\r\n    let lastPageY = 0;\r\n    let lastTime = 0;\r\n    return (event) => {\r\n      if (event.button === 2) {\r\n        lastPageX = 0;\r\n        lastTime = 0;\r\n        lastPageY = 0;\r\n        return;\r\n      }\r\n      const { pageX, pageY } = event;\r\n      const current = Date.now();\r\n      const diffTime = current - lastTime <= 300;\r\n      const diffPageX = pageX === lastPageX;\r\n      const diffPageY = pageY === lastPageY;\r\n      if (diffTime && diffPageX && diffPageY) {\r\n        callback(event);\r\n        lastTime = 0;\r\n        lastPageX = 0;\r\n        lastPageY = 0;\r\n      } else {\r\n        lastPageX = pageX;\r\n        lastPageY = pageY;\r\n        lastTime = current;\r\n      }\r\n    };\r\n  },\r\n  mouseClick: callback => (event) => {\r\n    callback(event);\r\n  },\r\n};\r\n\r\nexport {\r\n  XEvent,\r\n};\r\n","/* global document */\r\n\r\nimport { Element, h } from './Element';\r\nimport { cssPrefix } from '../const/Constant';\r\nimport { XEvent } from './XEvent';\r\n\r\n/**\r\n * Life\r\n */\r\nclass Life extends Element {\r\n\r\n  onAttach() { }\r\n\r\n}\r\n\r\n/**\r\n * Widget\r\n */\r\nclass Widget extends Life {\r\n\r\n  /**\r\n   * Widget\r\n   * @param className\r\n   * @param nodeType\r\n   * @param $$rootFlag\r\n   */\r\n  constructor(className = '', nodeType = 'div', $$rootFlag = false) {\r\n    if (typeof className === 'string') {\r\n      super(nodeType, `${cssPrefix}-widget ${className}`);\r\n    } else {\r\n      super(className);\r\n    }\r\n    this.$$rootFlag = $$rootFlag;\r\n  }\r\n\r\n  /**\r\n   * 追加节点\r\n   * 触发onAttach事件\r\n   * @param widget\r\n   */\r\n  attach(widget) {\r\n    this.childrenNodes(widget);\r\n    widget.parentWidget(this);\r\n    widget.onAttach(this);\r\n  }\r\n\r\n  /**\r\n   * 解绑事件处理\r\n   */\r\n  unbind() {\r\n    XEvent.unbind(this);\r\n  }\r\n\r\n  /**\r\n   * 绑定处理事件\r\n   */\r\n  bind() {\r\n\r\n  }\r\n\r\n  /**\r\n   * 计算鼠标在当前\r\n   * 元素中的位置\r\n   * @param event\r\n   * @param elem\r\n   * @returns {{x: number, y: number}}\r\n   */\r\n  eventXy(event, elem = this) {\r\n    const { top, left } = elem.box();\r\n    return {\r\n      y: event.clientY - top,\r\n      x: event.clientX - left,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 销毁组件\r\n   */\r\n  destroy() {\r\n    this.unbind();\r\n    this.remove();\r\n  }\r\n\r\n  /**\r\n   * 查找最邻近\r\n   * 的class元素\r\n   * @param clazz\r\n   */\r\n  closestClass(clazz) {\r\n    let node = this;\r\n    while (!h(document.body).is(node)) {\r\n      if (node.hasClass(clazz)) {\r\n        return node;\r\n      }\r\n      node = node.parent();\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * 获取根节点box\r\n   */\r\n  getRootBox() {\r\n    return this.getRootWidget().box();\r\n  }\r\n\r\n  /**\r\n   * 获取相对于 root box的\r\n   * 元素box\r\n   * @returns {{top: number, left: number, width: number, height: number}}\r\n   */\r\n  relativeBox() {\r\n    const root = this.getRootWidget();\r\n    const thisBox = this.box();\r\n    const rootBox = root.box();\r\n    return {\r\n      right: rootBox.right - thisBox.right,\r\n      bottom: rootBox.bottom - thisBox.bottom,\r\n      top: thisBox.top - rootBox.top,\r\n      left: thisBox.left - rootBox.left,\r\n      width: thisBox.width,\r\n      height: thisBox.height,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 获取 root widget\r\n   */\r\n  getRootWidget() {\r\n    let parent = this.data('parent');\r\n    while (parent && !parent.$$rootFlag) {\r\n      parent = parent.data('parent');\r\n    }\r\n    return parent;\r\n  }\r\n\r\n  /**\r\n   * 设置 parent widget\r\n   * @param widget\r\n   */\r\n  parentWidget(widget) {\r\n    if (widget) {\r\n      this.data('parent', widget);\r\n      return this;\r\n    }\r\n    return this.data('parent');\r\n  }\r\n\r\n}\r\n\r\nconst w = (className = '', nodeType = 'div') => new Widget(className, nodeType);\r\n\r\nexport {\r\n  Widget,\r\n  w,\r\n};\r\n","import { Widget } from '../../../../lib/Widget';\r\nimport { cssPrefix } from '../../../../const/Constant';\r\nimport { h } from '../../../../lib/Element';\r\n\r\nclass Icon extends Widget {\r\n\r\n  constructor(className = '') {\r\n    super(`${cssPrefix}-icon`);\r\n    this.iconNameEl = h('div', `${cssPrefix}-icon-img ${className}`);\r\n    this.childrenNodes(this.iconNameEl);\r\n  }\r\n\r\n  setWidth(width) {\r\n    this.iconNameEl.css('width', `${width}px`);\r\n  }\r\n\r\n  setHeight(height) {\r\n    this.iconNameEl.css('height', `${height}px`);\r\n  }\r\n\r\n}\r\n\r\nexport { Icon };\r\n","/* global document */\r\nimport { Widget } from '../../lib/Widget';\r\nimport { cssPrefix, Constant } from '../../const/Constant';\r\nimport { XEvent } from '../../lib/XEvent';\r\n\r\nimport { h } from '../../lib/Element';\r\nimport { SheetUtils } from '../../utils/SheetUtils';\r\n\r\nlet instances = [];\r\n\r\n/**\r\n * DragPanel\r\n * @author jerry\r\n * @date 2020/10/19\r\n */\r\nclass DragPanel extends Widget {\r\n\r\n  /**\r\n   * DragPanel\r\n   * @param options\r\n   */\r\n  constructor(options) {\r\n    super(`${cssPrefix}-drag-panel`);\r\n    instances.push(this);\r\n    this.options = SheetUtils.copy({\r\n      position: DragPanel.DRAG_PANEL_POSITION.CENTER,\r\n    }, options);\r\n    this.status = false;\r\n    this.mask = h('div', `${cssPrefix}-drag-panel-mask`);\r\n    this.content = h('div', `${cssPrefix}-drag-panel-content`);\r\n    super.childrenNodes(this.content);\r\n    this.bind();\r\n  }\r\n\r\n  /**\r\n   * 显示弹框\r\n   */\r\n  open() {\r\n    const root = this.getRootWidget();\r\n    const { mask } = this;\r\n    if (this.status === false && root) {\r\n      this.status = true;\r\n      root.childrenNodes(mask);\r\n      root.childrenNodes(this);\r\n      this.dragPanelLocation();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 关闭弹框\r\n   */\r\n  close() {\r\n    const root = this.getRootWidget();\r\n    if (this.status === true && root) {\r\n      const { mask } = this;\r\n      this.status = false;\r\n      root.remove(this);\r\n      root.remove(mask);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 卸载事件\r\n   */\r\n  unbind() {\r\n    const { mask } = this;\r\n    XEvent.unbind(mask);\r\n  }\r\n\r\n  /**\r\n   * 绑定事件\r\n   */\r\n  bind() {\r\n    const { mask } = this;\r\n    XEvent.bind(mask, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (evt1) => {\r\n      this.close();\r\n      evt1.stopPropagation();\r\n    });\r\n    XEvent.bind(this, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (evt1) => {\r\n      if (evt1.button !== 0) {\r\n        return;\r\n      }\r\n      const root = this.getRootWidget();\r\n      const box = root.box();\r\n      const dxy = this.eventXy(evt1);\r\n      XEvent.mouseMoveUp(h(document), (evt2) => {\r\n        const top = evt2.pageY - box.top - dxy.y;\r\n        const left = evt2.pageX - box.left - dxy.x;\r\n        this.offset({\r\n          top, left,\r\n        });\r\n        evt2.stopPropagation();\r\n      });\r\n      evt1.stopPropagation();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 设置显示位置\r\n   */\r\n  dragPanelLocation() {\r\n    const root = this.getRootWidget();\r\n    const { options } = this;\r\n    const { position } = options;\r\n    const rootBox = root.box();\r\n    const elemBox = this.box();\r\n    switch (position) {\r\n      case DragPanel.DRAG_PANEL_POSITION.LEFT:\r\n        break;\r\n      case DragPanel.DRAG_PANEL_POSITION.RIGHT:\r\n        break;\r\n      case DragPanel.DRAG_PANEL_POSITION.TOP:\r\n        break;\r\n      case DragPanel.DRAG_PANEL_POSITION.CENTER:\r\n        this.offset({\r\n          left: rootBox.width / 2 - elemBox.width / 2,\r\n          top: rootBox.height / 2 - elemBox.height / 2,\r\n        });\r\n        break;\r\n      default: break;\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 添加子元素\r\n   * @param args\r\n   * @returns {DragPanel}\r\n   */\r\n  childrenNodes(...args) {\r\n    this.content.childrenNodes(...args);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 销毁组件\r\n   */\r\n  destroy() {\r\n    super.destroy();\r\n    this.unbind();\r\n    DragPanel.removeInstance(this);\r\n  }\r\n\r\n  /**\r\n   * 删除实例\r\n   * @param instance\r\n   */\r\n  static removeInstance(instance) {\r\n    const filter = [];\r\n    instances.forEach((item) => {\r\n      if (item !== instance) {\r\n        filter.push(item);\r\n      }\r\n    });\r\n    instances = filter;\r\n  }\r\n\r\n  /**\r\n   * 关闭所有实例\r\n   * @param filter\r\n   */\r\n  static closeAll(filter = []) {\r\n    instances.forEach((item) => {\r\n      if (filter.indexOf(item) === -1) {\r\n        item.close();\r\n      }\r\n    });\r\n  }\r\n\r\n}\r\n\r\nDragPanel.DRAG_PANEL_POSITION = {\r\n  LEFT: 1,\r\n  TOP: 2,\r\n  RIGHT: 3,\r\n  CENTER: 4,\r\n};\r\n\r\nexport { DragPanel };\r\n","/* global document */\r\nimport { h } from '../../lib/Element';\r\nimport { cssPrefix, Constant } from '../../const/Constant';\r\nimport { Widget } from '../../lib/Widget';\r\nimport { DragPanel } from '../dragpanel/DragPanel';\r\nimport { XEvent } from '../../lib/XEvent';\r\nimport { SheetUtils } from '../../utils/SheetUtils';\r\n\r\nclass ColorPicker extends Widget {\r\n\r\n  constructor(options) {\r\n    super(`${cssPrefix}-color-picker`);\r\n    this.options = SheetUtils.copy({\r\n      selectCb: () => {},\r\n    }, options);\r\n    // 拖拽组件\r\n    this.dragPanel = new DragPanel().parentWidget(this);\r\n    this.color = [360, 0, 100];\r\n    // 头部\r\n    this.preViewColorPoint = h('div', `${cssPrefix}-color-picker-pre-view-color-point`);\r\n    this.colorValueTips = h('div', `${cssPrefix}-color-picker-color-value-tips`);\r\n    this.colorValueTips.text('十六进制颜色值');\r\n    this.colorInput = h('input', `${cssPrefix}-color-picker-color-input`);\r\n    this.top = h('div', `${cssPrefix}-color-picker-top`);\r\n    this.top.childrenNodes(this.preViewColorPoint);\r\n    this.top.childrenNodes(this.colorValueTips);\r\n    this.top.childrenNodes(this.colorInput);\r\n    // 中间部分\r\n    this.selectColorPoint = h('div', `${cssPrefix}-color-picker-select-color-point`);\r\n    this.selectColorArea1 = h('div', `${cssPrefix}-color-picker-select-color-area area1`);\r\n    this.selectColorArea2 = h('div', `${cssPrefix}-color-picker-select-color-area area2`);\r\n    this.selectColorArea3 = h('div', `${cssPrefix}-color-picker-select-color-area area3`);\r\n    this.center = h('div', `${cssPrefix}-color-picker-center`);\r\n    this.center.childrenNodes(this.selectColorArea1);\r\n    this.center.childrenNodes(this.selectColorArea2);\r\n    this.center.childrenNodes(this.selectColorArea3);\r\n    this.center.childrenNodes(this.selectColorPoint);\r\n    // 底部\r\n    this.colorHuxTips = h('div', `${cssPrefix}-color-picker-color-hux-tips`);\r\n    this.colorBar = h('div', `${cssPrefix}-color-picker-color-bar`);\r\n    this.colorBarPoint = h('div', `${cssPrefix}-color-picker-bar-point`);\r\n    this.bottom = h('div', `${cssPrefix}-color-picker-bottom`);\r\n    this.colorHuxTips.text('HUE');\r\n    this.colorBar.childrenNodes(this.colorBarPoint);\r\n    this.bottom.childrenNodes(this.colorHuxTips);\r\n    this.bottom.childrenNodes(this.colorBar);\r\n    // 按钮\r\n    this.cancelButton = h('div', `${cssPrefix}-color-picker-button cancel`);\r\n    this.selectButton = h('div', `${cssPrefix}-color-picker-button select`);\r\n    this.buttons = h('div', `${cssPrefix}-color-picker-buttons`);\r\n    this.cancelButton.text('取消');\r\n    this.selectButton.text('确定');\r\n    this.buttons.childrenNodes(this.selectButton);\r\n    this.buttons.childrenNodes(this.cancelButton);\r\n    this.childrenNodes(this.top);\r\n    this.childrenNodes(this.center);\r\n    this.childrenNodes(this.bottom);\r\n    this.childrenNodes(this.buttons);\r\n    this.dragPanel.childrenNodes(this);\r\n    this.dragPanel.css('background', '#ffffff');\r\n    this.bind();\r\n  }\r\n\r\n  unbind() {\r\n    const { selectColorPoint } = this;\r\n    const { colorBarPoint } = this;\r\n    const {\r\n      colorInput, cancelButton, selectButton,\r\n    } = this;\r\n    XEvent.unbind(colorInput);\r\n    XEvent.unbind(colorInput);\r\n    XEvent.unbind(colorBarPoint);\r\n    XEvent.unbind(selectColorPoint);\r\n    XEvent.unbind(cancelButton);\r\n    XEvent.unbind(selectButton);\r\n  }\r\n\r\n  bind() {\r\n    const { selectColorPoint, center } = this;\r\n    const { colorBarPoint, colorBar } = this;\r\n    const {\r\n      colorInput, cancelButton, selectButton,\r\n    } = this;\r\n    XEvent.bind(colorInput, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (e1) => {\r\n      e1.stopPropagation();\r\n    });\r\n    XEvent.bind(colorInput, Constant.SYSTEM_EVENT_TYPE.CHANGE, () => {\r\n      const value = colorInput.val();\r\n      if (value) {\r\n        this.hexColor(value);\r\n      }\r\n    });\r\n    XEvent.bind(colorBarPoint, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (e1) => {\r\n      const xy = this.eventXy(e1, colorBar);\r\n      const colorBarBox = colorBar.box();\r\n      if (xy.x < 0) xy.x = 0;\r\n      if (xy.x > colorBarBox.width) xy.x = colorBarBox.width;\r\n      this.downHue(xy.x, colorBarBox.width);\r\n      XEvent.mouseMoveUp(h(document), (e2) => {\r\n        const xy = this.eventXy(e2, colorBar);\r\n        const colorBarBox = colorBar.box();\r\n        if (xy.x < 0) xy.x = 0;\r\n        if (xy.x > colorBarBox.width) xy.x = colorBarBox.width;\r\n        this.moveHue(xy.x, colorBarBox.width);\r\n      });\r\n      e1.stopPropagation();\r\n    });\r\n    XEvent.bind(selectColorPoint, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (e1) => {\r\n      const xy = this.eventXy(e1, center);\r\n      const centerBox = center.box();\r\n      if (xy.x < 0) xy.x = 0;\r\n      if (xy.x > centerBox.width) xy.x = centerBox.width;\r\n      if (xy.y < 0) xy.y = 0;\r\n      if (xy.y > centerBox.height) xy.y = centerBox.height;\r\n      this.downSelect(xy.x, xy.y, centerBox.width, centerBox.height);\r\n      XEvent.mouseMoveUp(h(document), (e2) => {\r\n        const xy = this.eventXy(e2, center);\r\n        if (xy.x < 0) xy.x = 0;\r\n        if (xy.x > centerBox.width) xy.x = centerBox.width;\r\n        if (xy.y < 0) xy.y = 0;\r\n        if (xy.y > centerBox.height) xy.y = centerBox.height;\r\n        this.moveSelect(xy.x, xy.y, centerBox.width, centerBox.height);\r\n      });\r\n      e1.stopPropagation();\r\n    });\r\n    XEvent.bind(cancelButton, Constant.SYSTEM_EVENT_TYPE.CLICK, () => {\r\n      this.close();\r\n    });\r\n    XEvent.bind(selectButton, Constant.SYSTEM_EVENT_TYPE.CLICK, () => {\r\n      const { color } = this;\r\n      const hsb = ColorPicker.fixHsx({\r\n        h: parseInt(color[0], 10),\r\n        s: parseInt(color[1], 10),\r\n        x: parseInt(color[2], 10),\r\n      });\r\n      const rgb = ColorPicker.hsbToRgb(hsb);\r\n      this.options.selectCb(`rgb(${rgb.r},${rgb.g},${rgb.b})`);\r\n      this.close();\r\n    });\r\n  }\r\n\r\n  open(hex) {\r\n    const { dragPanel } = this;\r\n    dragPanel.open();\r\n    if (hex) {\r\n      if (ColorPicker.isRgb(hex)) {\r\n        const rgb = ColorPicker.parseRgb(hex);\r\n        // eslint-disable-next-line no-param-reassign\r\n        hex = ColorPicker.rgbToHex(rgb);\r\n      }\r\n      this.hexColor(hex);\r\n    } else {\r\n      this.change();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  close() {\r\n    const { dragPanel } = this;\r\n    dragPanel.close();\r\n    return this;\r\n  }\r\n\r\n  sliderPosition(hsb) {\r\n    // hue 滑块位置\r\n    const { colorBar, colorBarPoint } = this;\r\n    const colorBarPointBox = colorBarPoint.box();\r\n    const colorBarBox = colorBar.box();\r\n    let colorBarPointLeft = parseInt(colorBarBox.width - colorBarBox.width * hsb.h / 360, 10);\r\n    colorBarPointLeft -= colorBarPointBox.width / 2;\r\n    colorBarPoint.offset({\r\n      left: colorBarPointLeft,\r\n    });\r\n    // select color 滑块位置\r\n    const { center, selectColorPoint } = this;\r\n    const selectColorPointBox = selectColorPoint.box();\r\n    const centerBox = center.box();\r\n    let selectColorPointLeft = parseInt(centerBox.width * hsb.s / 100, 10);\r\n    let selectColorPointTop = parseInt(centerBox.height * (100 - hsb.x) / 100, 10);\r\n    selectColorPointLeft -= selectColorPointBox.width / 2;\r\n    selectColorPointTop -= selectColorPointBox.height / 2;\r\n    selectColorPoint.offset({\r\n      left: selectColorPointLeft,\r\n      top: selectColorPointTop,\r\n    });\r\n  }\r\n\r\n  hueChange() {\r\n    const { color } = this;\r\n    const hsb = ColorPicker.fixHsx({\r\n      h: parseInt(color[0], 10),\r\n      s: parseInt(color[1], 10),\r\n      x: parseInt(color[2], 10),\r\n    });\r\n    const {\r\n      colorBarPoint, selectColorPoint, preViewColorPoint, selectColorArea1, colorInput,\r\n    } = this;\r\n    const colorValue = ColorPicker.hsbToHex(hsb);\r\n    const areaColorValue = ColorPicker.hsbToHex({ h: hsb.h, s: 100, x: 100 });\r\n    selectColorPoint.css('backgroundColor', `#${colorValue}`);\r\n    preViewColorPoint.css('backgroundColor', `#${colorValue}`);\r\n    colorBarPoint.css('backgroundColor', `#${areaColorValue}`);\r\n    selectColorArea1.css('backgroundColor', `#${areaColorValue}`);\r\n    colorInput.val(`#${colorValue}`);\r\n    this.sliderPosition(hsb);\r\n  }\r\n\r\n  selectChange() {\r\n    const { color } = this;\r\n    const hsb = ColorPicker.fixHsx({\r\n      h: parseInt(color[0], 10),\r\n      s: parseInt(color[1], 10),\r\n      x: parseInt(color[2], 10),\r\n    });\r\n    const { preViewColorPoint, selectColorPoint, colorInput } = this;\r\n    const colorValue = ColorPicker.hsbToHex(hsb);\r\n    selectColorPoint.css('backgroundColor', `#${colorValue}`);\r\n    preViewColorPoint.css('backgroundColor', `#${colorValue}`);\r\n    colorInput.val(`#${colorValue}`);\r\n    this.sliderPosition(hsb);\r\n  }\r\n\r\n  change() {\r\n    this.hueChange();\r\n    this.selectChange();\r\n  }\r\n\r\n  downSelect(x, y, width, height) {\r\n    const { color } = this;\r\n    color[1] = parseInt(100 * x / width, 10);\r\n    color[2] = parseInt(100 * (height - y) / height, 10);\r\n    this.selectChange();\r\n  }\r\n\r\n  moveSelect(x, y, width, height) {\r\n    const { color } = this;\r\n    color[1] = parseInt(100 * (Math.max(0, Math.min(width, x))) / width, 10);\r\n    color[2] = parseInt(100 * (height - Math.max(0, Math.min(height, y))) / height, 10);\r\n    this.selectChange();\r\n  }\r\n\r\n  downHue(x, width) {\r\n    const { color } = this;\r\n    color[0] = parseInt(360 * (width - x) / width, 10);\r\n    this.hueChange();\r\n  }\r\n\r\n  moveHue(x, width) {\r\n    const { color } = this;\r\n    color[0] = parseInt(360 * (width - Math.max(0, Math.min(width, x))) / width, 10);\r\n    this.hueChange();\r\n  }\r\n\r\n  hexColor(hex) {\r\n    const { color } = this;\r\n    const result = ColorPicker.hexToHsb(ColorPicker.fixHex(hex));\r\n    color[0] = result.h;\r\n    color[1] = result.s;\r\n    color[2] = result.x;\r\n    this.change();\r\n  }\r\n\r\n  destroy() {\r\n    super.destroy();\r\n    this.unbind();\r\n    this.dragPanel.destroy();\r\n  }\r\n\r\n  static fixHex(hex) {\r\n    const len = 6 - hex.length;\r\n    if (len > 0) {\r\n      const o = [];\r\n      for (let i = 0; i < len; i += 1) {\r\n        o.push('0');\r\n      }\r\n      o.push(hex);\r\n      // eslint-disable-next-line no-param-reassign\r\n      hex = o.join('');\r\n    }\r\n    return hex;\r\n  }\r\n\r\n  static fixHsx(hsx) {\r\n    return {\r\n      h: Math.min(360, Math.max(0, hsx.h)),\r\n      s: Math.min(100, Math.max(0, hsx.s)),\r\n      x: Math.min(100, Math.max(0, hsx.x)),\r\n    };\r\n  }\r\n\r\n  static isRgb(rgb) {\r\n    return rgb.startsWith('rgb');\r\n  }\r\n\r\n  static isHex(hex) {\r\n    return hex.startsWith('#');\r\n  }\r\n\r\n  static isDark(rgb) {\r\n    if (SheetUtils.isString(rgb)) {\r\n      if (this.isHex(rgb)) {\r\n        const v = ColorPicker.hexToRgb(rgb);\r\n        rgb = `rgb(${v.r}, ${v.g}, ${v.b})`;\r\n      }\r\n      const result = ColorPicker.parseRgb(rgb);\r\n      const { r, g, b } = result;\r\n      return (r * 0.299) + (g * 0.578) + (b * 0.114) >= 192;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  static hexToRgb(hex) {\r\n    // eslint-disable-next-line no-redeclare,no-param-reassign\r\n    hex = parseInt(((hex.indexOf('#') > -1) ? hex.substring(1) : hex), 16);\r\n    // eslint-disable-next-line no-bitwise\r\n    return { r: hex >> 16, g: (hex & 0x00FF00) >> 8, b: (hex & 0x0000FF) };\r\n  }\r\n\r\n  static hexToHsb(hex) {\r\n    return this.rgbToHsb(this.hexToRgb(hex));\r\n  }\r\n\r\n  static rgbToHsb(rgb) {\r\n    const hsb = { h: 0, s: 0, x: 0 };\r\n    const min = Math.min(rgb.r, rgb.g, rgb.b);\r\n    const max = Math.max(rgb.r, rgb.g, rgb.b);\r\n    const delta = max - min;\r\n    hsb.x = max;\r\n    hsb.s = max !== 0 ? 255 * delta / max : 0;\r\n    if (hsb.s !== 0) {\r\n      if (rgb.r === max) hsb.h = (rgb.g - rgb.b) / delta;\r\n      else if (rgb.g === max) hsb.h = 2 + (rgb.b - rgb.r) / delta;\r\n      else hsb.h = 4 + (rgb.r - rgb.g) / delta;\r\n    } else hsb.h = -1;\r\n    hsb.h *= 60;\r\n    if (hsb.h < 0) hsb.h += 360;\r\n    hsb.s *= 100 / 255;\r\n    hsb.x *= 100 / 255;\r\n    return hsb;\r\n  }\r\n\r\n  static hsbToRgb(hsb) {\r\n    const rgb = {};\r\n    let { h } = hsb;\r\n    const s = hsb.s * 255 / 100;\r\n    const v = hsb.x * 255 / 100;\r\n    if (s === 0) {\r\n      rgb.r = v;\r\n      rgb.g = v;\r\n      rgb.b = v;\r\n    } else {\r\n      const t1 = v;\r\n      const t2 = (255 - s) * v / 255;\r\n      const t3 = (t1 - t2) * (h % 60) / 60;\r\n      if (h === 360) h = 0;\r\n      if (h < 60) {\r\n        rgb.r = t1;\r\n        rgb.b = t2;\r\n        rgb.g = t2 + t3;\r\n      } else if (h < 120) {\r\n        rgb.g = t1;\r\n        rgb.b = t2;\r\n        rgb.r = t1 - t3;\r\n      } else if (h < 180) {\r\n        rgb.g = t1;\r\n        rgb.r = t2;\r\n        rgb.b = t2 + t3;\r\n      } else if (h < 240) {\r\n        rgb.b = t1;\r\n        rgb.r = t2;\r\n        rgb.g = t1 - t3;\r\n      } else if (h < 300) {\r\n        rgb.b = t1;\r\n        rgb.g = t2;\r\n        rgb.r = t2 + t3;\r\n      } else if (h < 360) {\r\n        rgb.r = t1;\r\n        rgb.g = t2;\r\n        rgb.b = t1 - t3;\r\n      } else {\r\n        rgb.r = 0;\r\n        rgb.g = 0;\r\n        rgb.b = 0;\r\n      }\r\n    }\r\n    return { r: Math.round(rgb.r), g: Math.round(rgb.g), b: Math.round(rgb.b) };\r\n  }\r\n\r\n  static rgbToHex(rgb) {\r\n    const hex = [\r\n      rgb.r.toString(16),\r\n      rgb.g.toString(16),\r\n      rgb.b.toString(16),\r\n    ];\r\n    hex.forEach((val, nr) => {\r\n      if (val.length === 1) {\r\n        hex[nr] = `0${val}`;\r\n      }\r\n    });\r\n    return hex.join('');\r\n  }\r\n\r\n  static hsbToHex(hsb) {\r\n    return this.rgbToHex(this.hsbToRgb(hsb));\r\n  }\r\n\r\n  static parseRgb(rgb) {\r\n    const rxp = /^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)$/;\r\n    const result = rgb.match(rxp);\r\n    return {\r\n      r: parseInt(result[1], 10),\r\n      g: parseInt(result[2], 10),\r\n      b: parseInt(result[3], 10),\r\n    };\r\n  }\r\n\r\n  static parseRgbToHex(rgb, defaultValue = null) {\r\n    if (rgb) {\r\n      if (this.isHex(rgb)) {\r\n        return rgb.substring(1);\r\n      }\r\n      const value = this.parseRgb(rgb);\r\n      return this.rgbToHex(value);\r\n    }\r\n    return defaultValue;\r\n  }\r\n\r\n  static parseHexToRgb(hex, defaultValue = null) {\r\n    if (hex) {\r\n      const rgb = ColorPicker.hexToRgb(hex);\r\n      return `rgb(${rgb.r},${rgb.g},${rgb.b})`;\r\n    }\r\n    return defaultValue;\r\n  }\r\n\r\n}\r\n\r\nexport { ColorPicker };\r\n","import { Widget } from '../../../lib/Widget';\r\nimport { cssPrefix } from '../../../const/Constant';\r\nimport { SheetUtils } from '../../../utils/SheetUtils';\r\nimport { Icon } from '../../../core/work/head/tool/Icon';\r\nimport { ColorPicker } from '../ColorPicker';\r\n\r\nclass ColorItem extends Widget {\r\n\r\n  constructor(options) {\r\n    super(`${cssPrefix}-color-array-item`);\r\n    this.options = SheetUtils.copy({\r\n      color: null,\r\n      icon: null,\r\n    }, options);\r\n    this.icon = this.options.icon;\r\n    this.color = SheetUtils.blankClear(this.options.color);\r\n    if (this.icon) {\r\n      this.childrenNodes(this.options.icon);\r\n    }\r\n    if (this.color) {\r\n      this.css('backgroundColor', this.color);\r\n      if (ColorPicker.isDark(this.options.color)) {\r\n        this.checkedIcon = new Icon('checked-dark');\r\n        this.childrenNodes(this.checkedIcon);\r\n      } else {\r\n        this.checkedIcon = new Icon('checked-light');\r\n        this.childrenNodes(this.checkedIcon);\r\n      }\r\n      this.checkedIcon.hide();\r\n    }\r\n  }\r\n\r\n  setActive(active) {\r\n    if (this.checkedIcon) {\r\n      if (active) {\r\n        this.checkedIcon.show();\r\n      } else {\r\n        this.checkedIcon.hide();\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport { ColorItem };\r\n","import { Widget } from '../../../lib/Widget';\r\nimport { cssPrefix, Constant } from '../../../const/Constant';\r\nimport { ColorItem } from './ColorItem';\r\nimport { SheetUtils } from '../../../utils/SheetUtils';\r\nimport { XEvent } from '../../../lib/XEvent';\r\n\r\nclass ColorArray extends Widget {\r\n\r\n  constructor(options) {\r\n    super(`${cssPrefix}-color-array`);\r\n    this.options = SheetUtils.copy({\r\n      colors: [\r\n        new ColorItem({ color: 'rgb(0, 0, 0)' }),\r\n        new ColorItem({ color: 'rgb(67, 67, 67)' }),\r\n        new ColorItem({ color: 'rgb(102, 102, 102)' }),\r\n        new ColorItem({ color: 'rgb(153, 153, 153)' }),\r\n        new ColorItem({ color: 'rgb(183, 183, 183)' }),\r\n        new ColorItem({ color: 'rgb(204, 204, 204)' }),\r\n        new ColorItem({ color: 'rgb(217, 217, 217)' }),\r\n        new ColorItem({ color: 'rgb(239, 239, 239)' }),\r\n        new ColorItem({ color: 'rgb(255, 255, 255)' }),\r\n\r\n        new ColorItem({ color: 'rgb(152, 0, 0)' }),\r\n        new ColorItem({ color: 'rgb(255, 0, 0)' }),\r\n        new ColorItem({ color: 'rgb(255, 153, 0)' }),\r\n        new ColorItem({ color: 'rgb(255, 255, 0)' }),\r\n        new ColorItem({ color: 'rgb(0, 255, 0)' }),\r\n        new ColorItem({ color: 'rgb(0, 255, 255)' }),\r\n        new ColorItem({ color: 'rgb(74, 134, 232)' }),\r\n        new ColorItem({ color: 'rgb(0, 0, 255)' }),\r\n        new ColorItem({ color: 'rgb(153, 0, 255)' }),\r\n        new ColorItem({ color: 'rgb(255, 0, 255)' }),\r\n\r\n        new ColorItem({ color: 'rgb(230, 184, 175)' }),\r\n        new ColorItem({ color: 'rgb(244, 204, 204)' }),\r\n        new ColorItem({ color: 'rgb(252, 229, 205)' }),\r\n        new ColorItem({ color: 'rgb(255, 242, 204)' }),\r\n        new ColorItem({ color: 'rgb(217, 234, 211)' }),\r\n        new ColorItem({ color: 'rgb(208, 224, 227)' }),\r\n        new ColorItem({ color: 'rgb(201, 218, 248)' }),\r\n        new ColorItem({ color: 'rgb(207, 226, 243)' }),\r\n        new ColorItem({ color: 'rgb(217, 210, 233)' }),\r\n        new ColorItem({ color: 'rgb(234, 209, 220)' }),\r\n\r\n        new ColorItem({ color: 'rgb(221, 126, 107)' }),\r\n        new ColorItem({ color: 'rgb(234, 153, 153)' }),\r\n        new ColorItem({ color: 'rgb(249, 203, 156)' }),\r\n        new ColorItem({ color: 'rgb(255, 229, 153)' }),\r\n        new ColorItem({ color: 'rgb(182, 215, 168)' }),\r\n        new ColorItem({ color: 'rgb(162, 196, 201)' }),\r\n        new ColorItem({ color: 'rgb(164, 194, 244)' }),\r\n        new ColorItem({ color: 'rgb(159, 197, 232)' }),\r\n        new ColorItem({ color: 'rgb(180, 167, 214)' }),\r\n        new ColorItem({ color: 'rgb(213, 166, 189)' }),\r\n\r\n        new ColorItem({ color: 'rgb(204, 65, 37)' }),\r\n        new ColorItem({ color: 'rgb(224, 102, 102)' }),\r\n        new ColorItem({ color: 'rgb(246, 178, 107)' }),\r\n        new ColorItem({ color: 'rgb(255, 217, 102)' }),\r\n        new ColorItem({ color: 'rgb(147, 196, 125)' }),\r\n        new ColorItem({ color: 'rgb(118, 165, 175)' }),\r\n        new ColorItem({ color: 'rgb(109, 158, 235)' }),\r\n        new ColorItem({ color: 'rgb(111, 168, 220)' }),\r\n        new ColorItem({ color: 'rgb(142, 124, 195)' }),\r\n        new ColorItem({ color: 'rgb(194, 123, 160)' }),\r\n\r\n        new ColorItem({ color: 'rgb(166, 28, 0)' }),\r\n        new ColorItem({ color: 'rgb(204, 0, 0)' }),\r\n        new ColorItem({ color: 'rgb(230, 145, 56)' }),\r\n        new ColorItem({ color: 'rgb(241, 194, 50)' }),\r\n        new ColorItem({ color: 'rgb(106, 168, 79)' }),\r\n        new ColorItem({ color: 'rgb(69, 129, 142)' }),\r\n        new ColorItem({ color: 'rgb(60, 120, 216)' }),\r\n        new ColorItem({ color: 'rgb(61, 133, 198)' }),\r\n        new ColorItem({ color: 'rgb(103, 78, 167)' }),\r\n        new ColorItem({ color: 'rgb(166, 77, 121)' }),\r\n\r\n        new ColorItem({ color: 'rgb(133, 32, 12)' }),\r\n        new ColorItem({ color: 'rgb(153, 0, 0)' }),\r\n        new ColorItem({ color: 'rgb(180, 95, 6)' }),\r\n        new ColorItem({ color: 'rgb(191, 144, 0)' }),\r\n        new ColorItem({ color: 'rgb(56, 118, 29)' }),\r\n        new ColorItem({ color: 'rgb(19, 79, 92)' }),\r\n        new ColorItem({ color: 'rgb(17, 85, 204)' }),\r\n        new ColorItem({ color: 'rgb(11, 83, 148)' }),\r\n        new ColorItem({ color: 'rgb(53, 28, 117)' }),\r\n        new ColorItem({ color: 'rgb(116, 27, 71)' }),\r\n\r\n        new ColorItem({ color: 'rgb(91, 15, 0)' }),\r\n        new ColorItem({ color: 'rgb(102, 0, 0)' }),\r\n        new ColorItem({ color: 'rgb(120, 63, 4)' }),\r\n        new ColorItem({ color: 'rgb(127, 96, 0)' }),\r\n        new ColorItem({ color: 'rgb(39, 78, 19)' }),\r\n        new ColorItem({ color: 'rgb(12, 52, 61)' }),\r\n        new ColorItem({ color: 'rgb(28, 69, 135)' }),\r\n        new ColorItem({ color: 'rgb(7, 55, 99)' }),\r\n        new ColorItem({ color: 'rgb(32, 18, 77)' }),\r\n        new ColorItem({ color: 'rgb(76, 17, 48)' }),\r\n      ],\r\n      selectCb: () => {},\r\n    }, options);\r\n    this.colors = [];\r\n    this.activeColor = null;\r\n    this.options.colors.forEach((item) => {\r\n      this.add(item);\r\n    });\r\n    if (this.colors.length > 0) {\r\n      this.setActiveByColor(this.colors[0].options.color);\r\n    }\r\n  }\r\n\r\n  add(item) {\r\n    const find = this.colors.findIndex(color => color.color === item.color);\r\n    if (find === -1) {\r\n      const { colors } = this;\r\n      colors.push(item);\r\n      this.childrenNodes(item);\r\n      this.bind(item);\r\n    }\r\n  }\r\n\r\n  unbind() {\r\n    this.colors.forEach((item) => {\r\n      XEvent.unbind(item);\r\n    });\r\n  }\r\n\r\n  bind(item) {\r\n    XEvent.bind(item, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, () => {\r\n      this.options.selectCb(item);\r\n      if (item.options.color) {\r\n        this.setActiveByColor(item.options.color);\r\n      }\r\n    });\r\n  }\r\n\r\n  findItemByColor(color) {\r\n    color = SheetUtils.blankClear(color);\r\n    return this.colors.find(item => item.color === color);\r\n  }\r\n\r\n  setActiveByColor(color) {\r\n    color = SheetUtils.blankClear(color);\r\n    this.colors.forEach((item) => {\r\n      if (item.color === color) {\r\n        item.setActive(true);\r\n        this.activeColor = item.color;\r\n      } else {\r\n        item.setActive(false);\r\n      }\r\n    });\r\n  }\r\n\r\n  clear() {\r\n    this.unbind();\r\n    this.colors = [];\r\n    this.empty();\r\n  }\r\n\r\n  destroy() {\r\n    super.destroy();\r\n    this.unbind();\r\n  }\r\n\r\n}\r\n\r\nColorArray.BLACK = 'rgb(0, 0, 0)';\r\nColorArray.NULL = null;\r\nColorArray.WHITE = 'rgb(255, 255, 255)';\r\n\r\nexport {\r\n  ColorArray,\r\n};\r\n","import { BaseFont } from '../../../draw/font/BaseFont';\r\nimport { ColorArray } from '../../../module/colorpicker/colorarray/ColorArray';\r\nimport { SheetUtils } from '../../../utils/SheetUtils';\r\n\r\n/**\r\n *  CellFont\r\n *  @author jerry\r\n */\r\nclass CellFont {\r\n\r\n  /**\r\n   * CellFont\r\n   * @param align\r\n   * @param verticalAlign\r\n   * @param textWrap\r\n   * @param strikethrough\r\n   * @param underline\r\n   * @param color\r\n   * @param name\r\n   * @param size\r\n   * @param bold\r\n   * @param italic\r\n   * @param angle\r\n   * @param direction\r\n   * @param padding\r\n   */\r\n  constructor({\r\n    align = BaseFont.ALIGN.left,\r\n    verticalAlign = BaseFont.VERTICAL_ALIGN.center,\r\n    textWrap = BaseFont.TEXT_WRAP.TRUNCATE,\r\n    strikethrough = false,\r\n    underline = false,\r\n    color = ColorArray.BLACK,\r\n    name = 'Arial',\r\n    size = 14,\r\n    bold = false,\r\n    italic = false,\r\n    angle = 0,\r\n    direction = BaseFont.TEXT_DIRECTION.HORIZONTAL,\r\n    padding = 5,\r\n  } = {}) {\r\n    this.align = align;\r\n    this.verticalAlign = verticalAlign;\r\n    this.textWrap = textWrap;\r\n    this.strikethrough = strikethrough;\r\n    this.underline = underline;\r\n    this.color = color;\r\n    this.name = name;\r\n    this.size = size;\r\n    this.bold = bold;\r\n    this.italic = italic;\r\n    this.direction = direction;\r\n    this.angle = angle;\r\n    this.padding = padding;\r\n  }\r\n\r\n  like(other) {\r\n    let keys1 = Object.keys(this);\r\n    let keys2 = Object.keys(other);\r\n    for (let key of keys2) {\r\n      if (!keys1.includes(key)) {\r\n        return false;\r\n      }\r\n    }\r\n    for (let key of keys2) {\r\n      let src = this[key];\r\n      let val = other[key];\r\n      switch (key) {\r\n        case 'color': {\r\n          src = SheetUtils.clearBlank(src);\r\n          val = SheetUtils.clearBlank(val);\r\n          break;\r\n        }\r\n      }\r\n      if (src !== val) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  clone() {\r\n    const {\r\n      align,\r\n      verticalAlign,\r\n      textWrap,\r\n      strikethrough,\r\n      underline,\r\n      color,\r\n      name,\r\n      size,\r\n      bold,\r\n      italic,\r\n      angle,\r\n      direction,\r\n      padding,\r\n    } = this;\r\n    return new CellFont({\r\n      align,\r\n      verticalAlign,\r\n      textWrap,\r\n      strikethrough,\r\n      underline,\r\n      color,\r\n      name,\r\n      size,\r\n      bold,\r\n      italic,\r\n      angle,\r\n      direction,\r\n      padding,\r\n    });\r\n  }\r\n\r\n  reset() {\r\n    this.align = BaseFont.ALIGN.left;\r\n    this.verticalAlign = BaseFont.VERTICAL_ALIGN.center;\r\n    this.textWrap = BaseFont.TEXT_WRAP.TRUNCATE;\r\n    this.strikethrough = false;\r\n    this.underline = false;\r\n    this.color = ColorArray.BLACK;\r\n    this.name = 'Arial';\r\n    this.size = 14;\r\n    this.bold = false;\r\n    this.italic = false;\r\n    this.angle = 0;\r\n    this.direction = BaseFont.TEXT_DIRECTION.HORIZONTAL;\r\n    this.padding = 5;\r\n  }\r\n\r\n  equals(other) {\r\n    let keys1 = Object.keys(this);\r\n    let keys2 = Object.keys(other);\r\n    for (let key of keys1) {\r\n      if (!keys2.includes(key)) {\r\n        return false;\r\n      }\r\n    }\r\n    for (let key of keys1) {\r\n      let src = this[key];\r\n      let val = other[key];\r\n      switch (key) {\r\n        case 'color': {\r\n          src = SheetUtils.clearBlank(src);\r\n          val = SheetUtils.clearBlank(val);\r\n          break;\r\n        }\r\n      }\r\n      if (src !== val) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n}\r\n\r\nCellFont.EMPTY = new CellFont();\r\n\r\nCellFont.getInstance = (config) => {\r\n  if (config) {\r\n    return new CellFont(config);\r\n  }\r\n  return CellFont.EMPTY;\r\n};\r\n\r\nexport { CellFont };\r\n","/* global devicePixelRatio */\r\nimport { SheetUtils } from '../utils/SheetUtils';\r\n\r\nlet DPR = SheetUtils.inWorker() ? 1 : devicePixelRatio;\r\nlet LINE_WIDTH_LOW = Math.round(DPR);\r\nlet LINE_WIDTH_MEDIUM = LINE_WIDTH_LOW + 2;\r\nlet LINE_WIDTH_HIGH = LINE_WIDTH_MEDIUM + 2;\r\nlet LINE_PIXEL_OFFSET = LINE_WIDTH_LOW / 2;\r\n\r\nclass Base {\r\n\r\n  static srcPx(px) {\r\n    return px / this.dpr();\r\n  }\r\n\r\n  static cssPx(px) {\r\n    return this.srcPx(this.stylePx(px));\r\n  }\r\n\r\n  static stylePx(px) {\r\n    return this.round(px * this.dpr());\r\n  }\r\n\r\n  static round(val) {\r\n    return Math.round(val);\r\n  }\r\n\r\n  static ceil(val) {\r\n    return Math.ceil(val);\r\n  }\r\n\r\n  static trunc(val) {\r\n    return Math.trunc(val);\r\n  }\r\n\r\n  static radian(angle) {\r\n    return -angle * (Math.PI / 180);\r\n  }\r\n\r\n  static dpr() {\r\n    return DPR;\r\n  }\r\n\r\n  static refresh(val = 1) {\r\n    DPR = SheetUtils.inWorker() ? val : devicePixelRatio;\r\n    LINE_WIDTH_LOW = Math.round(DPR);\r\n    LINE_WIDTH_MEDIUM = LINE_WIDTH_LOW + 2;\r\n    LINE_WIDTH_HIGH = LINE_WIDTH_MEDIUM + 2;\r\n    LINE_PIXEL_OFFSET = LINE_WIDTH_LOW / 2;\r\n  }\r\n\r\n  constructor(canvas) {\r\n    this.canvas = canvas;\r\n    this.ctx = canvas.getContext('2d');\r\n  }\r\n\r\n  attr(options) {\r\n    for (const key in options) {\r\n      if (options.hasOwnProperty(key)) {\r\n        let value = options[key];\r\n        if (typeof value === 'string' || value instanceof String) {\r\n          value = value.trim();\r\n        }\r\n        if (this.ctx[key] !== value) {\r\n          this.ctx[key] = value;\r\n        }\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  resize(width, height) {\r\n    const { canvas } = this;\r\n    canvas.width = Base.stylePx(width);\r\n    canvas.height = Base.stylePx(height);\r\n    canvas.style.width = `${canvas.width / Base.dpr()}px`;\r\n    canvas.style.height = `${canvas.height / Base.dpr()}px`;\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nclass Wrapping extends Base {\r\n\r\n  constructor(canvas) {\r\n    super(canvas);\r\n    this.dash = [];\r\n  }\r\n\r\n  beginPath() {\r\n    const { ctx } = this;\r\n    ctx.beginPath();\r\n    return this;\r\n  }\r\n\r\n  measureText(text) {\r\n    const { ctx } = this;\r\n    return ctx.measureText(text);\r\n  }\r\n\r\n  save() {\r\n    const { ctx } = this;\r\n    ctx.save();\r\n    return this;\r\n  }\r\n\r\n  restore() {\r\n    const { ctx } = this;\r\n    ctx.restore();\r\n    return this;\r\n  }\r\n\r\n  fill() {\r\n    const { ctx } = this;\r\n    ctx.fill();\r\n    return this;\r\n  }\r\n\r\n  clip() {\r\n    const { ctx } = this;\r\n    ctx.clip();\r\n    return this;\r\n  }\r\n\r\n  setLineDash(dash = []) {\r\n    const { ctx } = this;\r\n    this.dash = dash;\r\n    ctx.setLineDash(dash);\r\n    return this;\r\n  }\r\n\r\n  scale(x, y) {\r\n    const { ctx } = this;\r\n    ctx.scale(x, y);\r\n    return this;\r\n  }\r\n\r\n  translate(x, y) {\r\n    const { ctx } = this;\r\n    ctx.translate(x, y);\r\n    return this;\r\n  }\r\n\r\n  rotate(deg) {\r\n    const { ctx } = this;\r\n    ctx.rotate(deg);\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nclass Extends extends Wrapping {\r\n\r\n  polyStroke(interpolation = xys => xys, ...xys) {\r\n    const { ctx } = this;\r\n    if (xys.length > 1) {\r\n      this.beginPath();\r\n      const [x, y] = interpolation(xys[0]);\r\n      ctx.moveTo(x, y);\r\n      for (let i = 1, len = xys.length; i < len; i += 1) {\r\n        const [x, y] = interpolation(xys[i]);\r\n        ctx.lineTo(x, y);\r\n      }\r\n      ctx.stroke();\r\n    }\r\n  }\r\n\r\n  polyInFill(interpolation = xys => xys, ...xys) {\r\n    const { ctx } = this;\r\n    if (xys.length > 1) {\r\n      this.beginPath();\r\n      const [x, y] = interpolation(xys[0]);\r\n      ctx.moveTo(x, y);\r\n      for (let i = 1, len = xys.length; i < len; i += 1) {\r\n        const [x, y] = interpolation(xys[i]);\r\n        ctx.lineTo(x, y);\r\n      }\r\n      ctx.fill();\r\n    }\r\n  }\r\n\r\n  fullRect() {\r\n    const { canvas } = this;\r\n    const { width, height } = canvas;\r\n    this.ctx.fillRect(0, 0, width, height);\r\n    return this;\r\n  }\r\n\r\n  rotate(angle) {\r\n    super.rotate(Base.radian(angle));\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nclass Position extends Extends {\r\n\r\n  constructor(canvas) {\r\n    super(canvas);\r\n    this.offsetX = 0;\r\n    this.offsetY = 0;\r\n  }\r\n\r\n  offset(x, y) {\r\n    this.offsetX = x;\r\n    this.offsetY = y;\r\n  }\r\n\r\n  getOffsetX() {\r\n    return this.offsetX;\r\n  }\r\n\r\n  getOffsetY() {\r\n    return this.offsetY;\r\n  }\r\n\r\n  fillText() {\r\n    throw TypeError('child impl');\r\n  }\r\n\r\n  fillRect() {\r\n    throw TypeError('child impl');\r\n  }\r\n\r\n  rect() {\r\n    throw TypeError('child impl');\r\n  }\r\n\r\n  drawImage() {\r\n    throw TypeError('child impl');\r\n  }\r\n\r\n}\r\n\r\nclass BaseLine extends Position {\r\n\r\n  line(...xys) {\r\n    this.polyStroke((xys) => {\r\n      const [x, y] = xys;\r\n      return [this.linePx(Base.round(x + this.getOffsetX())),\r\n        this.linePx(Base.round(y + this.getOffsetY()))];\r\n    }, ...xys);\r\n    return this;\r\n  }\r\n\r\n  linePx(pixel) {\r\n    const { ctx } = this;\r\n    const {\r\n      lineWidth,\r\n    } = ctx;\r\n    return lineWidth % 2 === 0\r\n      ? pixel : pixel - 0.5;\r\n  }\r\n\r\n}\r\n\r\nclass CorsLine extends BaseLine {\r\n\r\n  static offsetToLineInside(val) {\r\n    return LINE_WIDTH_LOW > 1\r\n      ? val - LINE_PIXEL_OFFSET\r\n      : val - LINE_WIDTH_LOW;\r\n  }\r\n\r\n  static getLineWidthTypePx(type) {\r\n    switch (type) {\r\n      case CorsLine.LINE_WIDTH_TYPE.medium:\r\n        return LINE_WIDTH_MEDIUM;\r\n      case CorsLine.LINE_WIDTH_TYPE.low:\r\n        return LINE_WIDTH_LOW;\r\n      case CorsLine.LINE_WIDTH_TYPE.high:\r\n        return LINE_WIDTH_HIGH;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  constructor(canvas) {\r\n    super(canvas);\r\n    this.lineWidthType = CorsLine.LINE_WIDTH_TYPE.low;\r\n    this.lineColor = 'rgb(0,0,0)';\r\n  }\r\n\r\n  corsLine([sx, sy], [ex, ey]) {\r\n    const {\r\n      lineWidthType, lineColor,\r\n    } = this;\r\n    let lineWidth = LINE_WIDTH_LOW;\r\n    switch (lineWidthType) {\r\n      case CorsLine.LINE_WIDTH_TYPE.medium:\r\n        lineWidth = LINE_WIDTH_MEDIUM;\r\n        break;\r\n      case CorsLine.LINE_WIDTH_TYPE.low:\r\n        lineWidth = LINE_WIDTH_LOW;\r\n        break;\r\n      case CorsLine.LINE_WIDTH_TYPE.high:\r\n        lineWidth = LINE_WIDTH_HIGH;\r\n        break;\r\n    }\r\n    this.attr({\r\n      strokeStyle: lineColor,\r\n      lineWidth,\r\n    });\r\n    this.polyStroke((xys) => {\r\n      const [x, y] = xys;\r\n      return [\r\n        Base.round(x + this.getOffsetX()) - LINE_PIXEL_OFFSET,\r\n        Base.round(y + this.getOffsetY()) - LINE_PIXEL_OFFSET,\r\n      ];\r\n    }, [sx, sy], [ex, ey]);\r\n  }\r\n\r\n  setLineColor(color) {\r\n    this.lineColor = color;\r\n  }\r\n\r\n  setLineWidthType(type) {\r\n    this.lineWidthType = type;\r\n  }\r\n\r\n  horizonLine([sx, sy], [ex, ey]) {\r\n    if (sy !== ey) {\r\n      throw new TypeError('Error Horizon Line');\r\n    }\r\n    this.corsLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n  verticalLine([sx, sy], [ex, ey]) {\r\n    if (sx !== ex) {\r\n      throw new TypeError('Error Vertical Line');\r\n    }\r\n    this.corsLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n}\r\nCorsLine.LINE_WIDTH_TYPE = {\r\n  low: 'low',\r\n  medium: 'medium',\r\n  high: 'high',\r\n};\r\n\r\nclass XDraw extends CorsLine {\r\n\r\n  fillText(text, x, y) {\r\n    x += this.getOffsetX();\r\n    y += this.getOffsetY();\r\n    this.ctx.fillText(text, XDraw.round(x), XDraw.round(y));\r\n    return this;\r\n  }\r\n\r\n  fillPath(path) {\r\n    this.polyInFill((xys) => {\r\n      const { x, y } = xys;\r\n      return [Base.round(x + this.getOffsetX()), Base.round(y + this.getOffsetY())];\r\n    }, ...path.points);\r\n    return this;\r\n  }\r\n\r\n  fillRect(x, y, w, h) {\r\n    x += this.getOffsetX();\r\n    y += this.getOffsetY();\r\n    this.ctx.fillRect(XDraw.round(x), XDraw.round(y),\r\n      XDraw.round(w), XDraw.round(h));\r\n    return this;\r\n  }\r\n\r\n  rect(x, y, w, h) {\r\n    x += this.getOffsetX();\r\n    y += this.getOffsetY();\r\n    this.ctx.rect(XDraw.round(x), XDraw.round(y),\r\n      XDraw.round(w), XDraw.round(h));\r\n    return this;\r\n  }\r\n\r\n  copyImage(sx, sy, sw, sh, tx, ty, tw, th) {\r\n    const { ctx } = this;\r\n    tx += this.getOffsetX();\r\n    sx += this.getOffsetX();\r\n    ty += this.getOffsetY();\r\n    sy += this.getOffsetY();\r\n    ctx.drawImage(this.canvas,\r\n      XDraw.round(sx), XDraw.round(sy),\r\n      XDraw.round(sw), XDraw.round(sh),\r\n      XDraw.round(tx), XDraw.round(ty),\r\n      XDraw.round(tw), XDraw.round(th));\r\n    return this;\r\n  }\r\n\r\n  drawImage(el, sx, sy, sw, sh, tx, ty, tw, th) {\r\n    const { ctx } = this;\r\n    tx += this.getOffsetX();\r\n    ty += this.getOffsetY();\r\n    ctx.drawImage(el,\r\n      XDraw.round(sx), XDraw.round(sy),\r\n      XDraw.round(sw), XDraw.round(sh),\r\n      XDraw.round(tx), XDraw.round(ty),\r\n      XDraw.round(tw), XDraw.round(th));\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  XDraw,\r\n};\r\n","import { SheetUtils } from '../utils/SheetUtils';\r\nimport { XDraw } from './XDraw';\r\n\r\nconst LINE_TYPE = {\r\n  SOLID_LINE: 0,\r\n  DOTTED_LINE: 1,\r\n  POINT_LINE: 2,\r\n  DOUBLE_LINE: 3,\r\n};\r\n\r\nclass SolidLine {\r\n\r\n  constructor(draw, attr) {\r\n    this.draw = draw;\r\n    SheetUtils.copy(this, {\r\n      color: 'rgb(0,0,0)',\r\n      widthType: XDraw.LINE_WIDTH_TYPE.low,\r\n    }, attr);\r\n  }\r\n\r\n  setWidthType(widthType) {\r\n    this.widthType = widthType;\r\n  }\r\n\r\n  setColor(color) {\r\n    this.color = color;\r\n  }\r\n\r\n  horizonLine(sx, sy, ex, ey) {\r\n    const { draw } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash([]);\r\n    draw.horizonLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n  verticalLine(sx, sy, ex, ey) {\r\n    const { draw } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash([]);\r\n    draw.verticalLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n  tiltingLine(sx, sy, ex, ey) {\r\n    const { draw } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash([]);\r\n    draw.corsLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n}\r\n\r\nclass DottedLine {\r\n\r\n  constructor(draw, attr) {\r\n    this.draw = draw;\r\n    SheetUtils.copy(this, {\r\n      color: 'rgb(0,0,0)',\r\n      widthType: XDraw.LINE_WIDTH_TYPE.low,\r\n      dash: [5],\r\n    }, attr);\r\n  }\r\n\r\n  setWidthType(widthType) {\r\n    this.widthType = widthType;\r\n  }\r\n\r\n  setColor(color) {\r\n    this.color = color;\r\n  }\r\n\r\n  horizonLine(sx, sy, ex, ey) {\r\n    const { draw, dash } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash(dash);\r\n    draw.horizonLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n  verticalLine(sx, sy, ex, ey) {\r\n    const { draw, dash } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash(dash);\r\n    draw.verticalLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n  tiltingLine(sx, sy, ex, ey) {\r\n    const { draw, dash } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash(dash);\r\n    draw.corsLine([sx, sy], [ex, ey]);\r\n  }\r\n\r\n}\r\n\r\nclass DoubleLine {\r\n\r\n  constructor(draw, attr) {\r\n    this.draw = draw;\r\n    SheetUtils.copy(this, {\r\n      color: 'rgb(0,0,0)',\r\n      widthType: XDraw.LINE_WIDTH_TYPE.low,\r\n      padding: 1,\r\n      spacing: DoubleLine.spacing,\r\n      leftShow: () => false,\r\n      topShow: () => false,\r\n      rightShow: () => false,\r\n      bottomShow: () => false,\r\n      iFMerge: () => false,\r\n      iFMergeFirstRow: () => false,\r\n      iFMergeLastRow: () => false,\r\n      iFMergeFirstCol: () => false,\r\n      iFMergeLastCol: () => false,\r\n    }, attr);\r\n  }\r\n\r\n  setWidthType(widthType) {\r\n    this.widthType = widthType;\r\n  }\r\n\r\n  setColor(color) {\r\n    this.color = color;\r\n  }\r\n\r\n  handleExternal(sx, sy, ex, ey, row, col, pos) {\r\n    const external = {};\r\n    const { leftShow, topShow, rightShow, bottomShow } = this;\r\n    const { iFMerge, iFMergeFirstRow, iFMergeLastRow, iFMergeFirstCol, iFMergeLastCol } = this;\r\n    const { spacing } = this;\r\n    let ifMerge = null;\r\n    let firstRow = null;\r\n    let lastRow = null;\r\n    let firstCol = null;\r\n    let lastCol = null;\r\n    switch (pos) {\r\n      case 'left':\r\n        ifMerge = iFMerge(row, col - 1);\r\n        if (ifMerge) {\r\n          firstRow = iFMergeFirstRow(row, col - 1);\r\n          lastRow = iFMergeLastRow(row, col - 1);\r\n          firstCol = iFMergeFirstCol(row, col - 1);\r\n          lastCol = iFMergeLastCol(row, col - 1);\r\n        }\r\n        break;\r\n      case 'top':\r\n        ifMerge = iFMerge(row - 1, col);\r\n        if (ifMerge) {\r\n          firstRow = iFMergeFirstRow(row - 1, col);\r\n          lastRow = iFMergeLastRow(row - 1, col);\r\n          firstCol = iFMergeFirstCol(row - 1, col);\r\n          lastCol = iFMergeLastCol(row - 1, col);\r\n        }\r\n        break;\r\n      case 'right':\r\n        ifMerge = iFMerge(row, col + 1);\r\n        if (ifMerge) {\r\n          firstRow = iFMergeFirstRow(row, col + 1);\r\n          lastRow = iFMergeLastRow(row, col + 1);\r\n          firstCol = iFMergeFirstCol(row, col + 1);\r\n          lastCol = iFMergeLastCol(row, col + 1);\r\n        }\r\n        break;\r\n      case 'bottom':\r\n        ifMerge = iFMerge(row + 1, col);\r\n        if (ifMerge) {\r\n          firstRow = iFMergeFirstRow(row + 1, col);\r\n          lastRow = iFMergeLastRow(row + 1, col);\r\n          firstCol = iFMergeFirstCol(row + 1, col);\r\n          lastCol = iFMergeLastCol(row + 1, col);\r\n        }\r\n        break;\r\n      default: break;\r\n    }\r\n    if (ifMerge) {\r\n      switch (pos) {\r\n        case 'left': {\r\n          external.sx = sx - spacing;\r\n          external.ex = ex - spacing;\r\n          // 检查顶边和上底边及左上角底边及左顶边\r\n          const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\r\n          const sTop = topShow(row, col);\r\n          const sBottom = bottomShow(row - 1, col);\r\n          external.sy = sy;\r\n          if (sTop || sBottom) external.sy = sy - spacing;\r\n          if (sTopLeftCorner && firstRow) external.sy = sy + spacing;\r\n          // 检查底边和下顶边及左下角顶边和左底边\r\n          const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\r\n          const eBottom = bottomShow(row, col);\r\n          const eTop = topShow(row + 1, col);\r\n          external.ey = ey;\r\n          if (eBottom || eTop) external.ey = ey + spacing;\r\n          if (eBottomLeftCorner && lastRow) external.ey = ey - spacing;\r\n          break;\r\n        }\r\n        case 'top': {\r\n          external.sy = sy - spacing;\r\n          external.ey = ey - spacing;\r\n          // 检查左边和左右边及左上角右边及上左边\r\n          const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\r\n          const sLeft = leftShow(row, col);\r\n          const sRight = rightShow(row, col - 1);\r\n          external.sx = sx;\r\n          if (sLeft || sRight) external.sx = sx - spacing;\r\n          if (sTopLeftCorner && firstCol) external.sx = sx + spacing;\r\n          // 检查右边和右左边及右上角左边及上右边\r\n          const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\r\n          const eRight = rightShow(row, col);\r\n          const eLeft = leftShow(row, col + 1);\r\n          external.ex = ex;\r\n          if (eRight || eLeft) external.ex = ex + spacing;\r\n          if (eTopRightCorner && lastCol) external.ex = ex - spacing;\r\n          break;\r\n        }\r\n        case 'right': {\r\n          external.sx = sx + spacing;\r\n          external.ex = ex + spacing;\r\n          // 检查顶边和上底边及右上角底边及右顶边\r\n          const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\r\n          const sTop = topShow(row, col);\r\n          const sBottom = bottomShow(row - 1, col);\r\n          external.sy = sy;\r\n          if (sTop || sBottom) external.sy = sy - spacing;\r\n          if (sTopRightCorner && firstRow) external.sy = sy + spacing;\r\n          // 检查底边和下顶边及右下角顶边及右底边\r\n          const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\r\n          const eBottom = bottomShow(row, col);\r\n          const eTop = topShow(row + 1, col);\r\n          external.ey = ey;\r\n          if (eBottom || eTop) external.ey = ey + spacing;\r\n          if (eBottomRightCorner && lastRow) external.ey = ey - spacing;\r\n          break;\r\n        }\r\n        case 'bottom': {\r\n          external.sy = sy + spacing;\r\n          external.ey = ey + spacing;\r\n          // 检查左边和左右边及左下角右边及下左边\r\n          const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\r\n          const sLeft = leftShow(row, col);\r\n          const sRight = rightShow(row, col - 1);\r\n          external.sx = sx;\r\n          if (sLeft || sRight) external.sx = sx - spacing;\r\n          if (sBottomLeftCorner && firstCol) external.sx = sx + spacing;\r\n          // 检查右边和右左边及右下角左边及下右边\r\n          const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\r\n          const eRight = rightShow(row, col);\r\n          const eLeft = leftShow(row, col + 1);\r\n          external.ex = ex;\r\n          if (eRight || eLeft) external.ex = ex + spacing;\r\n          if (eBottomRightCorner && lastCol) external.ex = ex - spacing;\r\n          break;\r\n        }\r\n        default: break;\r\n      }\r\n      return external;\r\n    }\r\n    switch (pos) {\r\n      case 'left': {\r\n        external.sx = sx - spacing;\r\n        external.ex = ex - spacing;\r\n        // 检查顶边和上底边及左上角底边及左顶边\r\n        const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\r\n        const sTop = topShow(row, col);\r\n        const sBottom = bottomShow(row - 1, col);\r\n        external.sy = sy;\r\n        if (sTop || sBottom) external.sy = sy - spacing;\r\n        if (sTopLeftCorner) external.sy = sy + spacing;\r\n        // 检查底边和下顶边及左下角顶边和左底边\r\n        const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\r\n        const eBottom = bottomShow(row, col);\r\n        const eTop = topShow(row + 1, col);\r\n        external.ey = ey;\r\n        if (eBottom || eTop) external.ey = ey + spacing;\r\n        if (eBottomLeftCorner) external.ey = ey - spacing;\r\n        break;\r\n      }\r\n      case 'top': {\r\n        external.sy = sy - spacing;\r\n        external.ey = ey - spacing;\r\n        // 检查左边和左右边及左上角右边及上左边\r\n        const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\r\n        const sLeft = leftShow(row, col);\r\n        const sRight = rightShow(row, col - 1);\r\n        external.sx = sx;\r\n        if (sLeft || sRight) external.sx = sx - spacing;\r\n        if (sTopLeftCorner) external.sx = sx + spacing;\r\n        // 检查右边和右左边及右上角左边及上右边\r\n        const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\r\n        const eRight = rightShow(row, col);\r\n        const eLeft = leftShow(row, col + 1);\r\n        external.ex = ex;\r\n        if (eRight || eLeft) external.ex = ex + spacing;\r\n        if (eTopRightCorner) external.ex = ex - spacing;\r\n        break;\r\n      }\r\n      case 'right': {\r\n        external.sx = sx + spacing;\r\n        external.ex = ex + spacing;\r\n        // 检查顶边和上底边及右上角底边及右顶边\r\n        const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\r\n        const sTop = topShow(row, col);\r\n        const sBottom = bottomShow(row - 1, col);\r\n        external.sy = sy;\r\n        if (sTop || sBottom) external.sy = sy - spacing;\r\n        if (sTopRightCorner) external.sy = sy + spacing;\r\n        // 检查底边和下顶边及右下角顶边及右底边\r\n        const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\r\n        const eBottom = bottomShow(row, col);\r\n        const eTop = topShow(row + 1, col);\r\n        external.ey = ey;\r\n        if (eBottom || eTop) external.ey = ey + spacing;\r\n        if (eBottomRightCorner) external.ey = ey - spacing;\r\n        break;\r\n      }\r\n      case 'bottom': {\r\n        external.sy = sy + spacing;\r\n        external.ey = ey + spacing;\r\n        // 检查左边和左右边及左下角右边及下左边\r\n        const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\r\n        const sLeft = leftShow(row, col);\r\n        const sRight = rightShow(row, col - 1);\r\n        external.sx = sx;\r\n        if (sLeft || sRight) external.sx = sx - spacing;\r\n        if (sBottomLeftCorner) external.sx = sx + spacing;\r\n        // 检查右边和右左边及右下角左边及下右边\r\n        const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\r\n        const eRight = rightShow(row, col);\r\n        const eLeft = leftShow(row, col + 1);\r\n        external.ex = ex;\r\n        if (eRight || eLeft) external.ex = ex + spacing;\r\n        if (eBottomRightCorner) external.ex = ex - spacing;\r\n        break;\r\n      }\r\n      default: break;\r\n    }\r\n    return external;\r\n  }\r\n\r\n  handleInternal(sx, sy, ex, ey, row, col, pos) {\r\n    const internal = {};\r\n    const { leftShow, topShow, rightShow, bottomShow } = this;\r\n    const { iFMerge, iFMergeFirstRow, iFMergeLastRow, iFMergeFirstCol, iFMergeLastCol } = this;\r\n    const { spacing } = this;\r\n    const ifMerge = iFMerge(row, col);\r\n    // merge\r\n    if (ifMerge) {\r\n      const firstRow = iFMergeFirstRow(row, col);\r\n      const lastRow = iFMergeLastRow(row, col);\r\n      const firstCol = iFMergeFirstCol(row, col);\r\n      const lastCol = iFMergeLastCol(row, col);\r\n      switch (pos) {\r\n        case 'left': {\r\n          internal.sx = sx + spacing;\r\n          internal.ex = ex + spacing;\r\n          // 检查顶边和上底边及左上角底边及左顶边\r\n          const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\r\n          const sTop = topShow(row, col);\r\n          const sBottom = bottomShow(row - 1, col);\r\n          internal.sy = sy;\r\n          if (sTopLeftCorner) internal.sy = sy - spacing;\r\n          if ((sTop || sBottom) && firstRow) internal.sy = sy + spacing;\r\n          // 检查底边和下顶边及左下角顶边和左底边\r\n          const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\r\n          const eBottom = bottomShow(row, col);\r\n          const eTop = topShow(row + 1, col);\r\n          internal.ey = ey;\r\n          if (eBottomLeftCorner) internal.ey = ey + spacing;\r\n          if ((eBottom || eTop) && lastRow) internal.ey = ey - spacing;\r\n          break;\r\n        }\r\n        case 'top': {\r\n          internal.sy = sy + spacing;\r\n          internal.ey = ey + spacing;\r\n          // 检查左边和左右边及左上角右边及上左边\r\n          const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\r\n          const sLeft = leftShow(row, col);\r\n          const sRight = rightShow(row, col - 1);\r\n          internal.sx = sx;\r\n          if (sTopLeftCorner) internal.sx = sx - spacing;\r\n          if ((sLeft || sRight) && firstCol) internal.sx = sx + spacing;\r\n          // 检查右边和右左边及右上角左边及上右边\r\n          const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\r\n          const eRight = rightShow(row, col);\r\n          const eLeft = leftShow(row, col + 1);\r\n          internal.ex = ex;\r\n          if (eTopRightCorner) internal.ex = ex + spacing;\r\n          if ((eRight || eLeft) && lastCol) internal.ex = ex - spacing;\r\n          break;\r\n        }\r\n        case 'right': {\r\n          internal.sx = sx - spacing;\r\n          internal.ex = ex - spacing;\r\n          // 检查顶边和上底边及右上角底边及右上边\r\n          const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\r\n          const sTop = topShow(row, col);\r\n          const sBottom = bottomShow(row - 1, col);\r\n          internal.sy = sy;\r\n          if (sTopRightCorner) internal.sy = sy - spacing;\r\n          if ((sTop || sBottom) && firstRow) internal.sy = sy + spacing;\r\n          // 检查底边和下顶边右下角顶边及右下边\r\n          const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\r\n          const eBottom = bottomShow(row, col);\r\n          const eTop = topShow(row + 1, col);\r\n          internal.ey = ey;\r\n          if (eBottomRightCorner) internal.ey = ey + spacing;\r\n          if ((eBottom || eTop) && lastRow) internal.ey = ey - spacing;\r\n          break;\r\n        }\r\n        case 'bottom': {\r\n          internal.sy = sy - spacing;\r\n          internal.ey = ey - spacing;\r\n          // 检查左边和左右边及左下角右边及下左边\r\n          const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\r\n          const sLeft = leftShow(row, col);\r\n          const sRight = rightShow(row, col - 1);\r\n          internal.sx = sx;\r\n          if (sBottomLeftCorner) internal.sx = sx - spacing;\r\n          if ((sLeft || sRight) && firstCol) internal.sx = sx + spacing;\r\n          // 检查右边和右左边及右下角左边及下右边\r\n          const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\r\n          const eRight = rightShow(row, col);\r\n          const eLeft = leftShow(row, col + 1);\r\n          internal.ex = ex;\r\n          if (eBottomRightCorner) internal.ex = ex + spacing;\r\n          if ((eRight || eLeft) && lastCol) internal.ex = ex - spacing;\r\n          break;\r\n        }\r\n        default: break;\r\n      }\r\n      return internal;\r\n    }\r\n    switch (pos) {\r\n      case 'left': {\r\n        internal.sx = sx + spacing;\r\n        internal.ex = ex + spacing;\r\n        // 检查顶边和上底边及左上角底边及左顶边\r\n        const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\r\n        const sTop = topShow(row, col);\r\n        const sBottom = bottomShow(row - 1, col);\r\n        internal.sy = sy;\r\n        if (sTopLeftCorner) internal.sy = sy - spacing;\r\n        if (sTop || sBottom) internal.sy = sy + spacing;\r\n        // 检查底边和下顶边及左下角顶边和左底边\r\n        const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\r\n        const eBottom = bottomShow(row, col);\r\n        const eTop = topShow(row + 1, col);\r\n        internal.ey = ey;\r\n        if (eBottomLeftCorner) internal.ey = ey + spacing;\r\n        if (eBottom || eTop) internal.ey = ey - spacing;\r\n        break;\r\n      }\r\n      case 'top': {\r\n        internal.sy = sy + spacing;\r\n        internal.ey = ey + spacing;\r\n        // 检查左边和左右边及左上角右边及上左边\r\n        const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\r\n        const sLeft = leftShow(row, col);\r\n        const sRight = rightShow(row, col - 1);\r\n        internal.sx = sx;\r\n        if (sTopLeftCorner) internal.sx = sx - spacing;\r\n        if (sLeft || sRight) internal.sx = sx + spacing;\r\n        // 检查右边和右左边及右上角左边及上右边\r\n        const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\r\n        const eRight = rightShow(row, col);\r\n        const eLeft = leftShow(row, col + 1);\r\n        internal.ex = ex;\r\n        if (eTopRightCorner) internal.ex = ex + spacing;\r\n        if (eRight || eLeft) internal.ex = ex - spacing;\r\n        break;\r\n      }\r\n      case 'right': {\r\n        internal.sx = sx - spacing;\r\n        internal.ex = ex - spacing;\r\n        // 检查顶边和上底边及右上角底边及右上边\r\n        const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\r\n        const sTop = topShow(row, col);\r\n        const sBottom = bottomShow(row - 1, col);\r\n        internal.sy = sy;\r\n        if (sTopRightCorner) internal.sy = sy - spacing;\r\n        if (sTop || sBottom) internal.sy = sy + spacing;\r\n        // 检查底边和下顶边右下角顶边及右下边\r\n        const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\r\n        const eBottom = bottomShow(row, col);\r\n        const eTop = topShow(row + 1, col);\r\n        internal.ey = ey;\r\n        if (eBottomRightCorner) internal.ey = ey + spacing;\r\n        if (eBottom || eTop) internal.ey = ey - spacing;\r\n        break;\r\n      }\r\n      case 'bottom': {\r\n        internal.sy = sy - spacing;\r\n        internal.ey = ey - spacing;\r\n        // 检查左边和左右边及左下角右边及下左边\r\n        const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\r\n        const sLeft = leftShow(row, col);\r\n        const sRight = rightShow(row, col - 1);\r\n        internal.sx = sx;\r\n        if (sBottomLeftCorner) internal.sx = sx - spacing;\r\n        if (sLeft || sRight) internal.sx = sx + spacing;\r\n        // 检查右边和右左边及右下角左边及下右边\r\n        const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\r\n        const eRight = rightShow(row, col);\r\n        const eLeft = leftShow(row, col + 1);\r\n        internal.ex = ex;\r\n        if (eBottomRightCorner) internal.ex = ex + spacing;\r\n        if (eRight || eLeft) internal.ex = ex - spacing;\r\n        break;\r\n      }\r\n      default: break;\r\n    }\r\n    return internal;\r\n  }\r\n\r\n  horizonLine(sx, sy, ex, ey, row, col, pos) {\r\n    const { draw } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash([]);\r\n    const external = this.handleExternal(sx, sy, ex, ey, row, col, pos);\r\n    const internal = this.handleInternal(sx, sy, ex, ey, row, col, pos);\r\n    if (!SheetUtils.isEmptyObject(internal)) {\r\n      draw.horizonLine([internal.sx, internal.sy], [internal.ex, internal.ey]);\r\n    }\r\n    if (!SheetUtils.isEmptyObject(external)) {\r\n      draw.horizonLine([external.sx, external.sy], [external.ex, external.ey]);\r\n    }\r\n  }\r\n\r\n  verticalLine(sx, sy, ex, ey, row, col, pos) {\r\n    const { draw } = this;\r\n    const {\r\n      widthType, color,\r\n    } = this;\r\n    draw.setLineColor(color);\r\n    draw.setLineWidthType(widthType);\r\n    draw.setLineDash([]);\r\n    const external = this.handleExternal(sx, sy, ex, ey, row, col, pos);\r\n    const internal = this.handleInternal(sx, sy, ex, ey, row, col, pos);\r\n    if (!SheetUtils.isEmptyObject(internal)) {\r\n      draw.verticalLine([internal.sx, internal.sy], [internal.ex, internal.ey]);\r\n    }\r\n    if (!SheetUtils.isEmptyObject(external)) {\r\n      draw.verticalLine([external.sx, external.sy], [external.ex, external.ey]);\r\n    }\r\n  }\r\n\r\n  // eslint-disable-next-line no-unused-vars\r\n  tiltingLine(sx, sy, ex, ey, row, col, pos) {\r\n    // TODO ..\r\n    // ...\r\n  }\r\n\r\n}\r\nDoubleLine.spacing = XDraw.dpr() >= 2 ? 3 : 2;\r\n\r\nclass Line {\r\n\r\n  constructor(draw, attr = {}) {\r\n    this.widthType = XDraw.LINE_WIDTH_TYPE.low;\r\n    this.type = LINE_TYPE.SOLID_LINE;\r\n    this.solidLine = new SolidLine(draw, SheetUtils.copy({}, attr));\r\n    this.dottedLine = new DottedLine(draw, SheetUtils.copy({\r\n      dash: [5],\r\n    }, attr));\r\n    this.pointLine = new DottedLine(draw, SheetUtils.copy({\r\n      dash: [2, 2],\r\n    }, attr));\r\n    this.doubleLine = new DoubleLine(draw, SheetUtils.copy({}, attr));\r\n  }\r\n\r\n  setWidthType(widthType) {\r\n    if (widthType) {\r\n      if (this.type === LINE_TYPE.SOLID_LINE) {\r\n        this.solidLine.setWidthType(widthType);\r\n      }\r\n    }\r\n  }\r\n\r\n  setColor(color) {\r\n    if (color) {\r\n      this.solidLine.setColor(color);\r\n      this.dottedLine.setColor(color);\r\n      this.pointLine.setColor(color);\r\n      this.doubleLine.setColor(color);\r\n    }\r\n  }\r\n\r\n  setType(type) {\r\n    this.type = type;\r\n  }\r\n\r\n  horizonLine(sx, sy, ex, ey, row, col, pos) {\r\n    const {\r\n      type,\r\n      solidLine,\r\n      dottedLine,\r\n      pointLine,\r\n      doubleLine,\r\n    } = this;\r\n    switch (type) {\r\n      case LINE_TYPE.SOLID_LINE:\r\n        solidLine.horizonLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.DOTTED_LINE:\r\n        dottedLine.horizonLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.POINT_LINE:\r\n        pointLine.horizonLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.DOUBLE_LINE:\r\n        doubleLine.horizonLine(sx, sy, ex, ey, row, col, pos);\r\n        break;\r\n    }\r\n  }\r\n\r\n  verticalLine(sx, sy, ex, ey, row, col, pos) {\r\n    const {\r\n      type,\r\n      solidLine,\r\n      dottedLine,\r\n      pointLine,\r\n      doubleLine,\r\n    } = this;\r\n    switch (type) {\r\n      case LINE_TYPE.SOLID_LINE:\r\n        solidLine.verticalLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.DOTTED_LINE:\r\n        dottedLine.verticalLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.POINT_LINE:\r\n        pointLine.verticalLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.DOUBLE_LINE:\r\n        doubleLine.verticalLine(sx, sy, ex, ey, row, col, pos);\r\n        break;\r\n    }\r\n  }\r\n\r\n  tiltingLine(sx, sy, ex, ey, row, col, pos) {\r\n    const {\r\n      type,\r\n      solidLine,\r\n      dottedLine,\r\n      pointLine,\r\n      doubleLine,\r\n    } = this;\r\n    switch (type) {\r\n      case LINE_TYPE.SOLID_LINE:\r\n        solidLine.tiltingLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.DOTTED_LINE:\r\n        dottedLine.tiltingLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.POINT_LINE:\r\n        pointLine.tiltingLine(sx, sy, ex, ey);\r\n        break;\r\n      case LINE_TYPE.DOUBLE_LINE:\r\n        doubleLine.tiltingLine(sx, sy, ex, ey, row, col, pos);\r\n        break;\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  Line, LINE_TYPE, SolidLine,\r\n};\r\n","import { LINE_TYPE } from '../../../draw/Line';\r\nimport { SheetUtils } from '../../../utils/SheetUtils';\r\nimport { XDraw } from '../../../draw/XDraw';\r\n\r\nlet zIndexID = 0;\r\n\r\n/**\r\n * Border\r\n * @author jerry\r\n */\r\nclass Border {\r\n\r\n  static getZIndex() {\r\n    zIndexID += 1;\r\n    return zIndexID;\r\n  }\r\n\r\n  constructor({\r\n    widthType = XDraw.LINE_WIDTH_TYPE.low,\r\n    type = LINE_TYPE.SOLID_LINE,\r\n    width = -1,\r\n    color = 'rgb(0,0,0)',\r\n    zIndex = 0,\r\n    display = false,\r\n  } = {}) {\r\n    this.zIndex = zIndex;\r\n    this.display = display;\r\n    this.color = color;\r\n    this.type = type;\r\n    if (width === 1) {\r\n      this.widthType = XDraw.LINE_WIDTH_TYPE.low;\r\n    } else if (width === 2) {\r\n      this.widthType = XDraw.LINE_WIDTH_TYPE.medium;\r\n    } else if (width === 3) {\r\n      this.widthType = XDraw.LINE_WIDTH_TYPE.high;\r\n    } else {\r\n      this.widthType = widthType;\r\n    }\r\n    if (zIndex > zIndexID) {\r\n      zIndexID = zIndex;\r\n    }\r\n  }\r\n\r\n  priority(border) {\r\n    if (SheetUtils.isUnDef(border)) {\r\n      return -2;\r\n    }\r\n    const origin = this.zIndex;\r\n    const target = border.zIndex;\r\n    if (origin > target) {\r\n      return 1;\r\n    }\r\n    if (target > origin) {\r\n      return -1;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  setColor(value) {\r\n    this.zIndex = Border.getZIndex();\r\n    this.color = value;\r\n  }\r\n\r\n  setDisplay(value) {\r\n    this.zIndex = Border.getZIndex();\r\n    this.display = value;\r\n  }\r\n\r\n  setType(value) {\r\n    this.zIndex = Border.getZIndex();\r\n    this.type = value;\r\n  }\r\n\r\n  setZIndex(value) {\r\n    this.zIndex = value;\r\n  }\r\n\r\n  setWidthType(value) {\r\n    this.zIndex = Border.getZIndex();\r\n    this.widthType = value;\r\n  }\r\n\r\n  clone() {\r\n    return new Border({\r\n      widthType: this.widthType,\r\n      color: this.color,\r\n      zIndex: this.zIndex,\r\n      type: this.type,\r\n      display: this.display,\r\n    });\r\n  }\r\n\r\n  equal(target) {\r\n    const widthType = this.widthType === target.widthType;\r\n    const color = this.color === target.color;\r\n    const type = this.type === target.type;\r\n    return color && widthType && type;\r\n  }\r\n\r\n}\r\n\r\nexport { Border };\r\n","import { Border } from './Border';\r\nimport { LINE_TYPE } from '../../../draw/Line';\r\n\r\n/**\r\n * CellBorder\r\n * @author jerry\r\n */\r\nclass CellBorder {\r\n\r\n  /**\r\n   * CellBorder\r\n   * @param time\r\n   * @param left\r\n   * @param top\r\n   * @param right\r\n   * @param bottom\r\n   */\r\n  constructor({\r\n    left = {},\r\n    bottom = {},\r\n    top = {},\r\n    right = {},\r\n  } = {}) {\r\n    this.left = new Border(left);\r\n    this.bottom = new Border(bottom);\r\n    this.top = new Border(top);\r\n    this.right = new Border(right);\r\n  }\r\n\r\n  hasDouble() {\r\n    const { top, left, right, bottom } = this;\r\n    if (top.type === LINE_TYPE.DOUBLE_LINE) {\r\n      return true;\r\n    }\r\n    if (left.type === LINE_TYPE.DOUBLE_LINE) {\r\n      return true;\r\n    }\r\n    if (right.type === LINE_TYPE.DOUBLE_LINE) {\r\n      return true;\r\n    }\r\n    return bottom.type === LINE_TYPE.DOUBLE_LINE;\r\n  }\r\n\r\n  isDisplay() {\r\n    return this.left.display || this.top.display\r\n      || this.bottom.display || this.right.display;\r\n  }\r\n\r\n  setAllDisplay(display) {\r\n    this.setBDisplay(display);\r\n    this.setLDisplay(display);\r\n    this.setTDisplay(display);\r\n    this.setRDisplay(display);\r\n  }\r\n\r\n  setLDisplay(display) {\r\n    this.left.setDisplay(display);\r\n  }\r\n\r\n  setTDisplay(display) {\r\n    this.top.setDisplay(display);\r\n  }\r\n\r\n  setRDisplay(display) {\r\n    this.right.setDisplay(display);\r\n  }\r\n\r\n  setBDisplay(display) {\r\n    this.bottom.setDisplay(display);\r\n  }\r\n\r\n  setAllColor(color) {\r\n    this.setBColor(color);\r\n    this.setLColor(color);\r\n    this.setTColor(color);\r\n    this.setRColor(color);\r\n  }\r\n\r\n  setLColor(color) {\r\n    this.left.setColor(color);\r\n  }\r\n\r\n  setTColor(color) {\r\n    this.top.setColor(color);\r\n  }\r\n\r\n  setRColor(color) {\r\n    this.right.setColor(color);\r\n  }\r\n\r\n  setBColor(color) {\r\n    this.bottom.setColor(color);\r\n  }\r\n\r\n  setAllWidthType(widthType) {\r\n    this.setBWidthType(widthType);\r\n    this.setLWidthType(widthType);\r\n    this.setTWidthType(widthType);\r\n    this.setRWidthType(widthType);\r\n  }\r\n\r\n  setLWidthType(widthType) {\r\n    this.left.setWidthType(widthType);\r\n  }\r\n\r\n  setTWidthType(widthType) {\r\n    this.top.setWidthType(widthType);\r\n  }\r\n\r\n  setRWidthType(widthType) {\r\n    this.right.setWidthType(widthType);\r\n  }\r\n\r\n  setBWidthType(widthType) {\r\n    this.bottom.setWidthType(widthType);\r\n  }\r\n\r\n  setAllType(type) {\r\n    this.setBType(type);\r\n    this.setLType(type);\r\n    this.setTType(type);\r\n    this.setRType(type);\r\n  }\r\n\r\n  setLType(type) {\r\n    this.left.setType(type);\r\n  }\r\n\r\n  setTType(type) {\r\n    this.top.setType(type);\r\n  }\r\n\r\n  setRType(type) {\r\n    this.right.setType(type);\r\n  }\r\n\r\n  setBType(type) {\r\n    this.bottom.setType(type);\r\n  }\r\n\r\n  updateMaxIndex() {\r\n    const zIndex = Border.getZIndex();\r\n    this.left.setZIndex(zIndex);\r\n    this.bottom.setZIndex(zIndex);\r\n    this.top.setZIndex(zIndex);\r\n    this.right.setZIndex(zIndex);\r\n  }\r\n\r\n  clone() {\r\n    const { left, top, right, bottom } = this;\r\n    return new CellBorder({\r\n      left: left.clone(),\r\n      top: top.clone(),\r\n      right: right.clone(),\r\n      bottom: bottom.clone(),\r\n    });\r\n  }\r\n\r\n}\r\n\r\nCellBorder.EMPTY = new CellBorder();\r\n\r\nCellBorder.getInstance = (config) => {\r\n  if (config) {\r\n    return new CellBorder(config);\r\n  }\r\n  return CellBorder.EMPTY;\r\n};\r\n\r\nexport { CellBorder };\r\n","class Rect {\r\n\r\n  /**\r\n   * Rect\r\n   * @param x\r\n   * @param y\r\n   * @param width\r\n   * @param height\r\n   */\r\n  constructor({\r\n    x, y, width, height,\r\n  }) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.width = width;\r\n    this.height = height;\r\n  }\r\n\r\n  /**\r\n   * 判断两个矩形是否不发生重合\r\n   * @param {Rect} other 区域\r\n   * @returns {boolean}\r\n   */\r\n  disjoint(other) {\r\n    return this.x > other.x + other.width\r\n      || this.y > this.y + other.height\r\n      || other.x > this.x + this.width\r\n      || other.y > this.y + this.height;\r\n  }\r\n\r\n  /**\r\n   * 扩展尺寸\r\n   * @param size\r\n   * @returns {Rect}\r\n   */\r\n  expandSize(size) {\r\n    this.width += size;\r\n    this.height += size;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 是否包含点\r\n   * @param x\r\n   * @param y\r\n   * @returns {boolean}\r\n   */\r\n  includePoint(x, y) {\r\n    return x >= this.x && x <= this.x + this.width\r\n      && y >= this.y && y <= this.y + this.height;\r\n  }\r\n\r\n  /**\r\n   * 是否包含矩形\r\n   * @param rect\r\n   * @returns {boolean|boolean}\r\n   */\r\n  includeRect(rect) {\r\n    const { x, y, width, height } = rect;\r\n    return this.x <= x && this.x + this.width >= x + width\r\n      && this.y <= y && this.y + this.height >= y + height;\r\n  }\r\n\r\n  /**\r\n   * 计算当前矩形在指定矩形内部的位置\r\n   * @param rect\r\n   * @returns {Rect}\r\n   */\r\n  inRectPosition(rect) {\r\n    return new Rect({\r\n      x: this.x - rect.x,\r\n      y: this.y - rect.y,\r\n      width: this.width,\r\n      height: this.height,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 复制\r\n   * @returns {Rect}\r\n   */\r\n  clone() {\r\n    const { x, y, width, height } = this;\r\n    return new Rect({ x, y, width, height });\r\n  }\r\n\r\n}\r\n\r\nexport { Rect };\r\n","\r\n/**\r\n * XIconOffset\r\n */\r\nclass XIconOffset {\r\n\r\n  /**\r\n   * XIconOffset\r\n   * @param x\r\n   * @param y\r\n   */\r\n  constructor({ x = 0, y = 0 } = {}) {\r\n    this.x = x;\r\n    this.y = y;\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  XIconOffset,\r\n};\r\n","class Crop {\r\n\r\n  constructor({\r\n    rect, draw, offset = 0,\r\n  }) {\r\n    this.rect = rect;\r\n    this.draw = draw;\r\n    this.offset = offset;\r\n  }\r\n\r\n  open() {\r\n    const {\r\n      rect, draw, offset,\r\n    } = this;\r\n    const {\r\n      x, y, width, height,\r\n    } = rect;\r\n    draw.save()\r\n      .rect(x, y, width + offset, height + offset)\r\n      .clip()\r\n      .beginPath();\r\n    return this;\r\n  }\r\n\r\n  close() {\r\n    const { draw } = this;\r\n    draw.restore();\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nexport { Crop };\r\n","/* global Image console */\r\nimport { SheetUtils } from '../../../utils/SheetUtils';\r\nimport { XDraw } from '../../../draw/XDraw';\r\nimport { Rect } from '../../../draw/Rect';\r\nimport { XIconOffset } from './XIconOffset';\r\nimport { Crop } from '../../../draw/Crop';\r\n\r\n/**\r\n * XIcon\r\n * @author jerry\r\n * @date 2020/10/20\r\n */\r\nclass XIcon {\r\n\r\n  /**\r\n   * 多图标初始化\r\n   * @param icons\r\n   * @returns {[]}\r\n   */\r\n  static newInstances(icons = []) {\r\n    const instances = [];\r\n    for (let i = 0; i < icons.length; i += 1) {\r\n      const icon = icons[i];\r\n      instances.push(new XIcon(icon));\r\n    }\r\n    return instances;\r\n  }\r\n\r\n  /**\r\n   * XIcon\r\n   * @param vertical\r\n   * @param horizontal\r\n   * @param type\r\n   * @param image\r\n   * @param focus\r\n   * @param height\r\n   * @param width\r\n   * @param color\r\n   * @param offset\r\n   * @param onDraw\r\n   * @param onLeave\r\n   * @param onMove\r\n   * @param onDown\r\n   * @param onEnter\r\n   */\r\n  constructor({\r\n    vertical = XIcon.ICON_VERTICAL.CENTER,\r\n    horizontal = XIcon.ICON_HORIZONTAL.RIGHT,\r\n    type = XIcon.ICON_TYPE.image,\r\n    image = SheetUtils.Nul,\r\n    iconFocus = null,\r\n    height = 16,\r\n    width = 16,\r\n    color = 'rgb(255,255,255)',\r\n    offset = { x: 0, y: 0 },\r\n    onDraw = () => {},\r\n    onLeave = () => {},\r\n    onMove = () => {},\r\n    onDown = () => {},\r\n    onEnter = () => {},\r\n  }) {\r\n    this.vertical = vertical;\r\n    this.horizontal = horizontal;\r\n    this.width = width;\r\n    this.height = height;\r\n    this.type = type;\r\n    this.image = image;\r\n    this.color = color;\r\n    this.iconFocus = iconFocus;\r\n    this.offset = new XIconOffset(offset);\r\n    this.onLeave = onLeave;\r\n    this.onMove = onMove;\r\n    this.onDraw = onDraw;\r\n    this.onDown = onDown;\r\n    this.onEnter = onEnter;\r\n    this.rect = null;\r\n  }\r\n\r\n  /**\r\n   * 计算绘制坐标\r\n   * @param rect\r\n   * @returns {{x: number, y: number}}\r\n   */\r\n  position(rect) {\r\n    // 图标信息\r\n    const iconHorizontal = this.horizontal;\r\n    const iconVertical = this.vertical;\r\n    const iconOffsetX = XDraw.stylePx(this.offset.x);\r\n    const iconOffsetY = XDraw.stylePx(this.offset.y);\r\n    const iconWidth = XDraw.stylePx(this.width);\r\n    const iconHeight = XDraw.stylePx(this.height);\r\n    // 矩形位置\r\n    const rectX = rect.x;\r\n    const rectY = rect.y;\r\n    const rectWidth = rect.width;\r\n    const rectHeight = rect.height;\r\n    // 计算位置\r\n    let px = 0;\r\n    let py = 0;\r\n    switch (iconHorizontal) {\r\n      case XIcon.ICON_HORIZONTAL.CENTER:\r\n        px = (rectX + rectWidth / 2) - (iconWidth / 2);\r\n        break;\r\n      case XIcon.ICON_HORIZONTAL.LEFT:\r\n        px = rectX;\r\n        break;\r\n      case XIcon.ICON_HORIZONTAL.RIGHT:\r\n        px = rectX + rectWidth - iconWidth;\r\n        break;\r\n    }\r\n    switch (iconVertical) {\r\n      case XIcon.ICON_VERTICAL.CENTER:\r\n        py = (rectY + rectHeight / 2) - (iconHeight / 2);\r\n        break;\r\n      case XIcon.ICON_VERTICAL.TOP:\r\n        py = rectY;\r\n        break;\r\n      case XIcon.ICON_VERTICAL.BOTTOM:\r\n        py = rectY + rectHeight - iconHeight;\r\n        break;\r\n    }\r\n    px += iconOffsetX;\r\n    py += iconOffsetY;\r\n    return new Rect({\r\n      x: px, y: py, width: iconWidth, height: iconHeight,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 加载图片信息\r\n   * @param async\r\n   * @param sync\r\n   */\r\n  loadImage({\r\n    load, sync,\r\n  }) {\r\n    const { image, type } = this;\r\n    switch (type) {\r\n      case XIcon.ICON_TYPE.image:\r\n        if (image instanceof Image) {\r\n          sync(image);\r\n        } else {\r\n          const loadImg = new Image();\r\n          loadImg.src = image;\r\n          if (loadImg.complete) {\r\n            this.image = loadImg;\r\n            sync(this.image);\r\n          } else {\r\n            loadImg.onload = () => {\r\n              this.image = loadImg;\r\n              load(loadImg);\r\n            };\r\n            loadImg.onerror = () => {\r\n              // eslint-disable-next-line no-console\r\n              console.error(`图片加载失败${image}`);\r\n            };\r\n          }\r\n        }\r\n        break;\r\n      case XIcon.ICON_TYPE.draw:\r\n        sync();\r\n        break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 绘制小图标\r\n   * @param rect\r\n   * @param draw\r\n   */\r\n  drawIcon({\r\n    rect, draw,\r\n  }) {\r\n    const { type } = this;\r\n    this.rect = rect;\r\n    switch (type) {\r\n      case XIcon.ICON_TYPE.image:\r\n        this.drawImage({\r\n          rect, draw,\r\n        });\r\n        break;\r\n      case XIcon.ICON_TYPE.draw:\r\n        this.drawCustom({\r\n          rect, draw,\r\n        });\r\n        break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 自定义绘制\r\n   * @param rect\r\n   * @param icon\r\n   * @param draw\r\n   */\r\n  drawCustom({\r\n    rect, draw,\r\n  }) {\r\n    this.onDraw({\r\n      rect, draw,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 绘制图片\r\n   * @param rect\r\n   * @param icon\r\n   * @param draw\r\n   */\r\n  drawImage({\r\n    rect, draw,\r\n  }) {\r\n    const image = this.image;\r\n    const color = this.color;\r\n    const positionRect = this.position(rect);\r\n    const {\r\n      x, y, width, height,\r\n    } = positionRect;\r\n    const include = rect.includeRect(positionRect);\r\n    const crop = new Crop({\r\n      rect, draw,\r\n    });\r\n    if (include === false) {\r\n      crop.open();\r\n    }\r\n    if (color) {\r\n      draw.attr({ fillStyle: color });\r\n      draw.fillRect(x, y, width, height);\r\n    }\r\n    draw.drawImage(image, 0, 0, image.width, image.height, x, y, width, height);\r\n    if (include === false) {\r\n      crop.close();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 事件处理\r\n   * @param type\r\n   * @param x\r\n   * @param y\r\n   * @param native\r\n   */\r\n  eventHandle({\r\n    type, x, y, native,\r\n  }) {\r\n    const { rect, iconFocus } = this;\r\n    if (rect) {\r\n      const position = this.position(rect);\r\n      const location = position.inRectPosition(rect);\r\n      const { activate } = iconFocus;\r\n      switch (type) {\r\n        case XIcon.ICON_EVENT_TYPE.MOUSE_DOWN:\r\n          if (location.includePoint(x, y)) {\r\n            iconFocus.setActivate(this);\r\n            this.onDown({\r\n              native, position,\r\n            });\r\n          }\r\n          break;\r\n        case XIcon.ICON_EVENT_TYPE.MOUSE_MOVE:\r\n          if (location.includePoint(x, y)) {\r\n            if (activate !== this) {\r\n              this.onEnter({\r\n                native, position,\r\n              });\r\n            }\r\n            iconFocus.setActivate(this);\r\n            this.onMove({\r\n              native, position,\r\n            });\r\n          } else if (activate) {\r\n            iconFocus.setActivate(null);\r\n            this.onLeave({\r\n              native, position,\r\n            });\r\n          }\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 绘制回调\r\n   * @param callback\r\n   */\r\n  setOnDraw(callback) {\r\n    this.onDraw = callback;\r\n  }\r\n\r\n  /**\r\n   * 按下回调\r\n   * @param callback\r\n   */\r\n  setOnDown(callback) {\r\n    this.onDown = callback;\r\n  }\r\n\r\n  /**\r\n   * 移动回调\r\n   * @param callback\r\n   */\r\n  setOnMove(callback) {\r\n    this.onMove = callback;\r\n  }\r\n\r\n  /**\r\n   * 进入回调\r\n   * @param callback\r\n   */\r\n  setOnEnter(callback) {\r\n    this.onEnter = callback;\r\n  }\r\n\r\n  /**\r\n   * 离开回调\r\n   * @param callback\r\n   */\r\n  setOnLeave(callback) {\r\n    this.onLeave = callback;\r\n  }\r\n\r\n  /**\r\n   * 设置焦点元素\r\n   * @param iconFocus\r\n   */\r\n  setFocus(iconFocus) {\r\n    this.iconFocus = iconFocus;\r\n  }\r\n\r\n}\r\n\r\nXIcon.ICON_HORIZONTAL = {\r\n  LEFT: 0,\r\n  RIGHT: 1,\r\n  CENTER: 2,\r\n};\r\nXIcon.ICON_VERTICAL = {\r\n  TOP: 3,\r\n  BOTTOM: 4,\r\n  CENTER: 5,\r\n};\r\nXIcon.ICON_TYPE = {\r\n  image: 1,\r\n  custom: 2,\r\n};\r\nXIcon.ICON_EVENT_TYPE = {\r\n  MOUSE_DOWN: 1,\r\n  MOUSE_MOVE: 2,\r\n};\r\n\r\nXIcon.EMPTY = [];\r\nXIcon.getInstance = (config) => {\r\n  if (config) {\r\n    return XIcon.newInstances(config);\r\n  }\r\n  return XIcon.EMPTY;\r\n};\r\n\r\nexport { XIcon };\r\n","class DateUtils {\r\n\r\n  static dateFormat(fmt, date) {\r\n    if (!(date instanceof Date)) {\r\n      return date;\r\n    }\r\n    const o = {\r\n      'M+': date.getMonth() + 1,\r\n      'd+': date.getDate(),\r\n      'h+': date.getHours(),\r\n      'm+': date.getMinutes(),\r\n      's+': date.getSeconds(),\r\n      'q+': Math.floor((date.getMonth() + 3) / 3),\r\n      S: date.getMilliseconds(),\r\n    };\r\n    const reYear = /(y+)/;\r\n    const resultYear = reYear.exec(fmt);\r\n    if (resultYear) {\r\n      const yearFormatPart = resultYear[0];\r\n      const yearVal = (date.getFullYear().toString()).substr(4 - yearFormatPart.length);\r\n      fmt = fmt.replace(yearFormatPart, yearVal);\r\n    }\r\n    // eslint-disable-next-line guard-for-in,no-restricted-syntax\r\n    for (const k in o) {\r\n      const re = new RegExp(`(${k})`);\r\n      const res = re.exec(fmt);\r\n      if (res) {\r\n        const Val = o[k].toString();\r\n        const formatPart = res[0];\r\n        const replaceVal = (formatPart.length === 1) ? (Val) : ((`00${Val}`).substr(Val.length));\r\n        fmt = fmt.replace(formatPart, replaceVal);\r\n      }\r\n    }\r\n    return fmt;\r\n  }\r\n\r\n  static parse(text) {\r\n    let result = text;\r\n    if (result instanceof Date) {\r\n      return result;\r\n    }\r\n\r\n    result = DateUtils.parserToDate(text, 'yyyy/MM/dd');\r\n    if (result) {\r\n      return result;\r\n    }\r\n    result = DateUtils.parserToDate(text, 'MM/dd');\r\n    if (result) {\r\n      return result;\r\n    }\r\n    result = DateUtils.parserToDate(text, 'yyyy/MM/dd hh:mm:ss');\r\n    if (result) {\r\n      return result;\r\n    }\r\n\r\n    result = DateUtils.parserToDate(text, 'yyyy-MM-dd');\r\n    if (result) {\r\n      return result;\r\n    }\r\n    result = DateUtils.parserToDate(text, 'MM-dd');\r\n    if (result) {\r\n      return result;\r\n    }\r\n    result = DateUtils.parserToDate(text, 'yyyy-MM-dd hh:mm:ss');\r\n    if (result) {\r\n      return result;\r\n    }\r\n\r\n    result = DateUtils.parserToDate(text, 'hh:mm:ss');\r\n    if (result) {\r\n      return result;\r\n    }\r\n\r\n    result = DateUtils.parserToDate(text, 'yyyy年MM月');\r\n    if (result) {\r\n      return result;\r\n    }\r\n    result = DateUtils.parserToDate(text, 'MM月dd日');\r\n    if (result) {\r\n      return result;\r\n    }\r\n    result = DateUtils.parserToDate(text, 'yyyy年MM月dd日 hh:mm:ss');\r\n    if (result) {\r\n      return result;\r\n    }\r\n\r\n    return text;\r\n  }\r\n\r\n  static parserToDate(dateText, format) {\r\n    if (!dateText) {\r\n      return null;\r\n    }\r\n    const defaultVal = new Date('1970/01/01 00:00:00');\r\n    const o = [{\r\n      reg: 'y+',\r\n    }, {\r\n      reg: 'M+',\r\n    }, {\r\n      reg: 'd+',\r\n    }, {\r\n      reg: 'h+',\r\n    }, {\r\n      reg: 'm+',\r\n    }, {\r\n      reg: 's+',\r\n    }, {\r\n      reg: 'S',\r\n    }];\r\n    let year = defaultVal.getFullYear();\r\n    let month = defaultVal.getMonth() + 1;\r\n    let day = defaultVal.getDate();\r\n    let hours = defaultVal.getHours();\r\n    let minutes = defaultVal.getMinutes();\r\n    let seconds = defaultVal.getSeconds();\r\n    let milliseconds = defaultVal.getMilliseconds();\r\n    let index = 1;\r\n    for (let j = 0; j < format.length; j += 1) {\r\n      const oneChar = format[j];\r\n      for (let i = 0; i < o.length; i += 1) {\r\n        const onePart = o[i];\r\n        const onePartReg = onePart.reg;\r\n        if (onePartReg[0] === oneChar) {\r\n          if (!onePart.index) {\r\n            onePart.index = index;\r\n            index += 1;\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    for (let i = 0; i < o.length; i += 1) {\r\n      const onePart = o[i];\r\n      const onePartReg = onePart.reg;\r\n      const re = new RegExp(`(${onePartReg})`);\r\n      const res = re.exec(format);\r\n      if (res) {\r\n        const formatPart = res[0];\r\n        const replaceVal = `([0-9]{1,${formatPart.length}})`;\r\n        // eslint-disable-next-line no-param-reassign\r\n        format = format.replace(formatPart, replaceVal);\r\n      }\r\n    }\r\n    const dataInfo = {};\r\n    const re = new RegExp(format);\r\n    const res = re.exec(dateText);\r\n    if (res) {\r\n      for (let i = 1; i < res.length; i += 1) {\r\n        dataInfo[i] = res[i];\r\n      }\r\n    } else {\r\n      return null;\r\n    }\r\n    if (o[0].index) {\r\n      const { index } = o[0];\r\n      year = dataInfo[index];\r\n    }\r\n    if (o[1].index) {\r\n      const { index } = o[1];\r\n      month = dataInfo[index];\r\n    }\r\n    if (o[2].index) {\r\n      const { index } = o[2];\r\n      day = dataInfo[index];\r\n    }\r\n    if (o[3].index) {\r\n      const { index } = o[3];\r\n      hours = dataInfo[index];\r\n    }\r\n    if (o[4].index) {\r\n      const { index } = o[4];\r\n      minutes = dataInfo[index];\r\n    }\r\n    if (o[5].index) {\r\n      const { index } = o[5];\r\n      seconds = dataInfo[index];\r\n    }\r\n    if (o[6].index) {\r\n      const { index } = o[6];\r\n      milliseconds = dataInfo[index];\r\n    }\r\n    return new Date(year, month - 1, day, hours, minutes, seconds, milliseconds);\r\n  }\r\n\r\n}\r\n\r\nexport { DateUtils };\r\n","import { SheetUtils } from '../../utils/SheetUtils';\r\nimport { DateUtils } from '../../utils/DateUtils';\r\n\r\nclass Format {\r\n\r\n  default(value) {\r\n    return this.text(value);\r\n  }\r\n\r\n  text(value) {\r\n    return value ? `${value}` : '';\r\n  }\r\n\r\n  // =============================数字==============================\r\n\r\n  number(value) {\r\n    return this.text(value);\r\n  }\r\n\r\n  fraction(value) {\r\n    if (SheetUtils.isFraction(value)) {\r\n      const left = value.split('/')[0];\r\n      const right = value.split('/')[1];\r\n      return this.text(SheetUtils.parseInt(left) / SheetUtils.parseInt(right));\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  eNotation(value) {\r\n    if (SheetUtils.isNumber(value)) {\r\n      const number = SheetUtils.parseFloat(value);\r\n      return number.toExponential(2);\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  decimal(value) {\r\n    if (SheetUtils.isNumber(value)) {\r\n      const indexOf = value.toString().indexOf('.');\r\n      if (indexOf !== -1) {\r\n        return value.toString().substring(0, indexOf + 3);\r\n      }\r\n      return `${value}.00`;\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  percentage(value) {\r\n    if (SheetUtils.isNumber(value)) {\r\n      return `${value}%`;\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  // =============================货币==============================\r\n\r\n  rmb(value) {\r\n    if (SheetUtils.isNumber(value)) {\r\n      return `￥${value}`;\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  hk(value) {\r\n    if (SheetUtils.isNumber(value)) {\r\n      return `HK${value}`;\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  dollar(value) {\r\n    if (SheetUtils.isNumber(value)) {\r\n      return `$${value}`;\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  // =============================日期==============================\r\n\r\n  time(value) {\r\n    const result = DateUtils.parse(value);\r\n    if (result) {\r\n      return DateUtils.dateFormat('hh:mm:ss', result);\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  date1(value) {\r\n    const result = DateUtils.parse(value);\r\n    if (result) {\r\n      return DateUtils.dateFormat('yyyy/MM/dd', result);\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  date2(value) {\r\n    const result = DateUtils.parse(value);\r\n    if (result) {\r\n      return DateUtils.dateFormat('MM月dd日', result);\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  date3(value) {\r\n    const result = DateUtils.parse(value);\r\n    if (result) {\r\n      return DateUtils.dateFormat('yyyy年MM月', result);\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  date4(value) {\r\n    const result = DateUtils.parse(value);\r\n    if (result) {\r\n      return DateUtils.dateFormat('yyyy年MM月dd日', result);\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n  date5(value) {\r\n    const result = DateUtils.parse(value);\r\n    if (result) {\r\n      return DateUtils.dateFormat('yyyy/MM/dd hh:mm:ss', result);\r\n    }\r\n    return this.text(value);\r\n  }\r\n\r\n}\r\n\r\nconst format = new Format();\r\n\r\nexport default (type, value) => format[type](value);\r\n","import { SheetUtils } from '../../../utils/SheetUtils';\r\nimport { ColorArray } from '../../../module/colorpicker/colorarray/ColorArray';\r\n\r\nclass RichFont {\r\n\r\n  constructor({\r\n    text = '',\r\n    color = ColorArray.BLACK,\r\n    name = 'Arial',\r\n    size = 14,\r\n    bold = false,\r\n    italic = false,\r\n    strikethrough = false,\r\n    underline = false,\r\n    scaleAdapter,\r\n  } = {}) {\r\n    this.color = color;\r\n    this.text = `${text}`;\r\n    this.name = name;\r\n    this.size = size;\r\n    this.italic = italic;\r\n    this.bold = bold;\r\n    this.strikethrough = strikethrough;\r\n    this.underline = underline;\r\n    this.scaleAdapter = scaleAdapter;\r\n  }\r\n\r\n  clone() {\r\n    const { text, color, name, size } = this;\r\n    const { italic, bold, underline } = this;\r\n    const { strikethrough, scaleAdapter } = this;\r\n    return new RichFont({\r\n      text, color, name, size, italic, bold, underline, strikethrough, scaleAdapter,\r\n    });\r\n  }\r\n\r\n  reset() {\r\n    this.color = ColorArray.BLACK;\r\n    this.name = 'Arial';\r\n    this.size = 14;\r\n    this.bold = false;\r\n    this.italic = false;\r\n    this.strikethrough = false;\r\n    this.underline = false;\r\n  }\r\n\r\n  plain(option = v => v) {\r\n    return option(this.clone());\r\n  }\r\n\r\n  like(other) {\r\n    let ignore = ['scaleAdapter'];\r\n    let keys1 = Object.keys(this);\r\n    let keys2 = Object.keys(other);\r\n    for (let key of keys2) {\r\n      if (ignore.includes(key)) {\r\n        continue;\r\n      }\r\n      if (!keys1.includes(key)) {\r\n        return false;\r\n      }\r\n    }\r\n    for (let key of keys2) {\r\n      if (ignore.includes(key)) {\r\n        continue;\r\n      }\r\n      let src = this[key];\r\n      let val = other[key];\r\n      switch (key) {\r\n        case 'color': {\r\n          src = SheetUtils.clearBlank(src);\r\n          val = SheetUtils.clearBlank(val);\r\n          break;\r\n        }\r\n      }\r\n      if (src !== val) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  equals(other) {\r\n    let ignore = ['scaleAdapter'];\r\n    let keys1 = Object.keys(this);\r\n    let keys2 = Object.keys(other);\r\n    for (let key of keys1) {\r\n      if (ignore.includes(key)) {\r\n        continue;\r\n      }\r\n      if (!keys2.includes(key)) {\r\n        return false;\r\n      }\r\n    }\r\n    for (let key of keys1) {\r\n      if (ignore.includes(key)) {\r\n        continue;\r\n      }\r\n      let src = this[key];\r\n      let val = other[key];\r\n      switch (key) {\r\n        case 'color': {\r\n          src = SheetUtils.clearBlank(src);\r\n          val = SheetUtils.clearBlank(val);\r\n          break;\r\n        }\r\n      }\r\n      if (src !== val) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  RichFont,\r\n};\r\n","import { RichFont } from './RichFont';\r\nimport { SheetUtils } from '../../../utils/SheetUtils';\r\n\r\nclass RichFonts {\r\n\r\n  constructor({\r\n    rich = [],\r\n  } = {}) {\r\n    this.rich = rich.map(font => new RichFont(font));\r\n  }\r\n\r\n  setRich(rich = []) {\r\n    this.rich = rich;\r\n  }\r\n\r\n  each(cb = () => {}) {\r\n    this.rich.forEach((font) => {\r\n      cb(font);\r\n    });\r\n  }\r\n\r\n  reset() {\r\n    this.each((i) => {\r\n      i.reset();\r\n    });\r\n  }\r\n\r\n  getRich() {\r\n    return this.rich;\r\n  }\r\n\r\n  clone() {\r\n    const rich = [];\r\n    this.rich.forEach((font) => {\r\n      rich.push(font.clone());\r\n    });\r\n    return new RichFonts({\r\n      rich,\r\n    });\r\n  }\r\n\r\n  hasLength() {\r\n    return this.rich.length > 0;\r\n  }\r\n\r\n  plain(option) {\r\n    const result = [];\r\n    this.rich.forEach((font) => {\r\n      result.push(font.plain(option));\r\n    });\r\n    return result;\r\n  }\r\n\r\n  like(other) {\r\n    if (SheetUtils.isUnDef(other)) {\r\n      return false;\r\n    }\r\n    if (other.rich.length !== this.rich.length) {\r\n      return false;\r\n    }\r\n    for (let i = 0; i < this.rich.length; i++) {\r\n      let item1 = this.rich[i];\r\n      let item2 = other.rich[i];\r\n      if (!item1.like(item2)) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  toString() {\r\n    let text = [];\r\n    this.each(i => text.push(i.text));\r\n    return text.join('');\r\n  }\r\n\r\n  equals(other) {\r\n    if (SheetUtils.isUnDef(other)) {\r\n      return false;\r\n    }\r\n    if (other.rich.length !== this.rich.length) {\r\n      return false;\r\n    }\r\n    for (let i = 0; i < this.rich.length; i++) {\r\n      let item1 = this.rich[i];\r\n      let item2 = other.rich[i];\r\n      if (!item1.equals(item2)) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n}\r\n\r\nRichFonts.EMPTY = new RichFonts();\r\n\r\nRichFonts.getInstance = (config) => {\r\n  if (config) {\r\n    return new RichFonts(config);\r\n  }\r\n  return RichFonts.EMPTY;\r\n};\r\n\r\nexport {\r\n  RichFonts,\r\n};\r\n","/**\r\n * 运行函数注册\r\n * @type {{}}\r\n */\r\nclass EvalFunctions {\r\n\r\n  /**\r\n   * EvalFunctions\r\n   */\r\n  constructor() {\r\n    this.functions = {};\r\n  }\r\n\r\n  /**\r\n   * 删除函数\r\n   * @param name\r\n   */\r\n  remove(name) {\r\n    delete this.functions[name];\r\n  }\r\n\r\n  /**\r\n   * 获取函数\r\n   * @param name\r\n   * @returns {*}\r\n   */\r\n  getFunction(name) {\r\n    return this.functions[name.toLocaleString()];\r\n  }\r\n\r\n  /**\r\n   * 注册函数\r\n   * @param name\r\n   * @param func\r\n   */\r\n  register(name, func) {\r\n    this.functions[name.toLocaleString()] = func;\r\n  }\r\n}\r\n\r\n/**\r\n * 函数注册\r\n * @type {EvalFunctions}\r\n */\r\nconst Functions = new EvalFunctions();\r\n\r\n/**\r\n * 指令序列\r\n */\r\nclass Assembly {\r\n\r\n  /**\r\n   * Assembly\r\n   */\r\n  constructor() {\r\n    this.assembly = '';\r\n  }\r\n\r\n  /**\r\n   * 获取指令详情\r\n   * @returns {string}\r\n   */\r\n  getInstruct() {\r\n    let { assembly } = this;\r\n    let flag = '\\r\\n';\r\n    while (assembly.endsWith(flag)) {\r\n      let { length } = assembly;\r\n      assembly = assembly.substring(0, length - flag.length);\r\n    }\r\n    return assembly;\r\n  }\r\n\r\n  /**\r\n   * 写入操作数\r\n   * @param value\r\n   */\r\n  writeOperand(value) {\r\n    this.assembly += `OPush ${value}\\r\\n`;\r\n  }\r\n\r\n  /**\r\n   * 写入运算符\r\n   * @param op\r\n   */\r\n  writeOperator(op) {\r\n    this.assembly += `${op}\\r\\n`;\r\n  }\r\n\r\n  /**\r\n   * 写入操作数\r\n   * @param value\r\n   */\r\n  writeString(value) {\r\n    this.assembly += `SPush ${value}\\r\\n`;\r\n  }\r\n\r\n  /**\r\n   * 写入操作数\r\n   * @param value\r\n   */\r\n  writeNumber(value) {\r\n    this.assembly += `NPush ${value}\\r\\n`;\r\n  }\r\n}\r\n\r\n/**\r\n * 词法分析\r\n */\r\nclass Tokenizer {\r\n\r\n  /**\r\n   * Tokenizer\r\n   * @param syntaxCheck\r\n   */\r\n  constructor({\r\n    syntaxCheck = true,\r\n  } = {}) {\r\n    this.syntaxCheck = syntaxCheck;\r\n  }\r\n\r\n  /**\r\n   * 词法分析\r\n   * @param input\r\n   * @returns {*[]}\r\n   */\r\n  lexical(input) {\r\n    let OPERATOR = /^(\\+|-|\\*|\\/|%|>|<|,|\\^|=|&|!|:|>=|<=|<>)$/;\r\n    let NUMBERS = /[0-9.]/;\r\n    let SPACE = /\\s/;\r\n    let LETTERS = /[a-z0-9_$]/i;\r\n    // 文本字符长度\r\n    let { length } = input;\r\n    // 函数调用记录\r\n    let bracketsStack = [];\r\n    // 当前的字符索引\r\n    let current = 0;\r\n    // 处理的字符数组\r\n    let tokens = [];\r\n    // 循环处理所有字符\r\n    while (current < length) {\r\n      // 当前处理的字符\r\n      let char = input[current];\r\n      // 跳过连续空格\r\n      if (SPACE.test(char)) {\r\n        const next = input[current + 1];\r\n        if (SPACE.test(next)) {\r\n          current++;\r\n          continue;\r\n        }\r\n      }\r\n      // 记录交叉区域运算符\r\n      if (SPACE.test(char)) {\r\n        const last = input[current - 1];\r\n        const next = input[current + 1];\r\n        if (LETTERS.test(last) && LETTERS.test(next)) {\r\n          tokens.push({\r\n            type: 'operator',\r\n            value: char,\r\n          });\r\n        }\r\n        current++;\r\n        continue;\r\n      }\r\n      // 记录括号\r\n      if (char === '(') {\r\n        tokens.push({\r\n          type: 'brackets',\r\n          value: '(',\r\n        });\r\n        bracketsStack.push({\r\n          type: 'brackets',\r\n          value: '(',\r\n        });\r\n        current++;\r\n        continue;\r\n      }\r\n      if (char === ')') {\r\n        const brackets = bracketsStack.pop();\r\n        if (brackets && brackets.type === 'function') {\r\n          tokens.push({\r\n            type: 'function',\r\n            value: ')',\r\n          });\r\n        } else {\r\n          tokens.push({\r\n            type: 'brackets',\r\n            value: ')',\r\n          });\r\n        }\r\n        current++;\r\n        continue;\r\n      }\r\n      // 记录数组\r\n      if (char === '{') {\r\n        tokens.push({\r\n          type: 'array',\r\n          value: 'array',\r\n        });\r\n        tokens.push({\r\n          type: 'array',\r\n          value: '{',\r\n        });\r\n        current++;\r\n        continue;\r\n      }\r\n      if (char === '}') {\r\n        tokens.push({\r\n          type: 'array',\r\n          value: '}',\r\n        });\r\n        current++;\r\n        continue;\r\n      }\r\n      // 记录字符串\r\n      if (char === '\"') {\r\n        let result = '';\r\n        current++;\r\n        char = input[current];\r\n        while (char !== '\"') {\r\n          if (current < length) {\r\n            result += char;\r\n            current++;\r\n            char = input[current];\r\n          } else {\r\n            break;\r\n          }\r\n        }\r\n        current++;\r\n        char = input[current];\r\n        tokens.push({\r\n          type: 'string',\r\n          value: result,\r\n        });\r\n        continue;\r\n      }\r\n      if (char === '\\'') {\r\n        let result = '';\r\n        current++;\r\n        char = input[current];\r\n        while (char !== '\\'') {\r\n          if (current < length) {\r\n            result += char;\r\n            current++;\r\n            char = input[current];\r\n          } else {\r\n            break;\r\n          }\r\n        }\r\n        current++;\r\n        char = input[current];\r\n        tokens.push({\r\n          type: 'string',\r\n          value: result,\r\n        });\r\n        continue;\r\n      }\r\n      // 记录运算符\r\n      if (OPERATOR.test(char)) {\r\n        let next = input[current + 1];\r\n        let result = `${char}${next}`;\r\n        if (OPERATOR.test(result)) {\r\n          tokens.push({\r\n            type: 'operator',\r\n            value: result,\r\n          });\r\n          current++;\r\n        } else {\r\n          tokens.push({\r\n            type: 'operator',\r\n            value: char,\r\n          });\r\n        }\r\n        current++;\r\n        continue;\r\n      }\r\n      // 记录数字值\r\n      if (NUMBERS.test(char)) {\r\n        let result = '';\r\n        while (NUMBERS.test(char)) {\r\n          if (current < length) {\r\n            result += char;\r\n            current++;\r\n            char = input[current];\r\n          } else {\r\n            break;\r\n          }\r\n        }\r\n        tokens.push({\r\n          type: 'number',\r\n          value: result,\r\n        });\r\n        continue;\r\n      }\r\n      // 记录函数名称, 参数名称, 操作数名称\r\n      if (LETTERS.test(char)) {\r\n        let result = '';\r\n        while (LETTERS.test(char)) {\r\n          if (current < length) {\r\n            result += char;\r\n            current++;\r\n            char = input[current];\r\n          } else {\r\n            break;\r\n          }\r\n        }\r\n        // 是否为函数名称\r\n        if (char === '(') {\r\n          tokens.push({\r\n            type: 'function',\r\n            value: result,\r\n          });\r\n          tokens.push({\r\n            type: 'function',\r\n            value: '(',\r\n          });\r\n          bracketsStack.push({\r\n            type: 'function',\r\n            value: '(',\r\n          });\r\n          current++;\r\n        } else {\r\n          tokens.push({\r\n            type: 'operand',\r\n            value: result,\r\n          });\r\n        }\r\n        continue;\r\n      }\r\n      // 无法识别的token\r\n      throw new TypeError(`无法识别的token ${char} `);\r\n    }\r\n    // 返回处理结果\r\n    if (this.syntaxCheck) {\r\n      return this.syntax(tokens);\r\n    }\r\n    return tokens;\r\n  }\r\n\r\n  /**\r\n   * 语法分析\r\n   * @param tokens\r\n   */\r\n  syntax(tokens) {\r\n    // 单引号对校验\r\n    let sQuotesStack = [];\r\n    // 双引号对校验\r\n    let dQuotesStack = [];\r\n    // 函数闭合标签校验\r\n    let callStack = [];\r\n    // 数组闭合标签校验\r\n    let arrayStack = [];\r\n    // 括号闭合标签校验\r\n    let bracketsStack = [];\r\n    // 当前的字符索引\r\n    let current = 0;\r\n    // tokens长度\r\n    let { length } = tokens;\r\n    // 忽略的数组token\r\n    let ignoreArray = (token) => {\r\n      if (token.type === 'array') {\r\n        return token.value === 'array';\r\n      }\r\n      return false;\r\n    };\r\n    // 忽略的函数token\r\n    let ignoreFunc = (token) => {\r\n      if (token.type === 'function') {\r\n        return token.value !== '(' && token.value !== ')';\r\n      }\r\n      return false;\r\n    };\r\n    // 跳过忽略的元素\r\n    let skipIgnoreToken = (dir, index) => {\r\n      if (dir === 'last') {\r\n        while (index >= 0) {\r\n          let token = tokens[index];\r\n          if (ignoreFunc(token)) {\r\n            index--;\r\n            continue;\r\n          }\r\n          if (ignoreArray(token)) {\r\n            index--;\r\n            continue;\r\n          }\r\n          return token;\r\n        }\r\n      }\r\n      if (dir === 'next') {\r\n        while (index < length) {\r\n          let token = tokens[index];\r\n          if (ignoreFunc(token)) {\r\n            index++;\r\n            continue;\r\n          }\r\n          if (ignoreArray(token)) {\r\n            index++;\r\n            continue;\r\n          }\r\n          return token;\r\n        }\r\n      }\r\n      return null;\r\n    };\r\n    // 检查数组\r\n    let checkArray = (dir, target) => {\r\n      let token = tokens[current];\r\n      let local = dir === 'last' ? '前面' : '后面';\r\n      if (token.value === '{') {\r\n        if (dir === 'last') {\r\n          switch (target.type) {\r\n            case 'array': {\r\n              if (target.value === '{') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'function': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'operator': {\r\n              if (target.value === ',') {\r\n                return;\r\n              }\r\n              return;\r\n            }\r\n          }\r\n        }\r\n        if (dir === 'next') {\r\n          switch (target.type) {\r\n            case 'string':\r\n            case 'array':\r\n            case 'number':\r\n            case 'operand': {\r\n              return;\r\n            }\r\n            case 'function': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      if (token.value === '}') {\r\n        if (dir === 'last') {\r\n          switch (target.type) {\r\n            case 'number':\r\n            case 'string':\r\n            case 'array':\r\n            case 'operand': {\r\n              return;\r\n            }\r\n            case 'function': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        if (dir === 'next') {\r\n          switch (target.type) {\r\n            case 'array': {\r\n              if (target.value === '}') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'function': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'operator': {\r\n              if (target.value === ',') {\r\n                return;\r\n              }\r\n              return;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      throw TypeError(`错误表达式 ${token.value} ${local} ${target.value}`);\r\n    };\r\n    // 检查数字和字符\r\n    let checkValue = (dir, target) => {\r\n      let token = tokens[current];\r\n      let local = dir === 'last' ? '前面' : '后面';\r\n      switch (target.type) {\r\n        case 'array': {\r\n          if (dir === 'last') {\r\n            if (target.value === '{') {\r\n              return;\r\n            }\r\n          }\r\n          if (dir === 'next') {\r\n            if (target.value === '}') {\r\n              return;\r\n            }\r\n          }\r\n          break;\r\n        }\r\n        case 'brackets': {\r\n          if (dir === 'last') {\r\n            if (target.value === '(') {\r\n              return;\r\n            }\r\n          }\r\n          if (dir === 'next') {\r\n            if (target.value === ')') {\r\n              return;\r\n            }\r\n          }\r\n          break;\r\n        }\r\n        case 'function': {\r\n          if (dir === 'last') {\r\n            if (target.value === '(') {\r\n              return;\r\n            }\r\n          }\r\n          if (dir === 'next') {\r\n            if (target.value === ')') {\r\n              return;\r\n            }\r\n          }\r\n          break;\r\n        }\r\n        case 'operator': {\r\n          return;\r\n        }\r\n      }\r\n      throw TypeError(`错误表达式 ${token.value} ${local} ${target.value}`);\r\n    };\r\n    // 检查运算符\r\n    let checkOperator = (dir, target) => {\r\n      let token = tokens[current];\r\n      let local = dir === 'last' ? '前面' : '后面';\r\n      switch (target.type) {\r\n        case 'brackets':\r\n        case 'function':\r\n        case 'string':\r\n        case 'number':\r\n        case 'operand': {\r\n          return;\r\n        }\r\n        case 'array': {\r\n          if (token.value === ',') {\r\n            return;\r\n          }\r\n          break;\r\n        }\r\n      }\r\n      throw TypeError(`错误表达式 ${token.value} ${local} ${target.value}`);\r\n    };\r\n    // 检查函数\r\n    let checkFunction = (dir, target) => {\r\n      let token = tokens[current];\r\n      let local = dir === 'last' ? '前面' : '后面';\r\n      if (token.value === '(') {\r\n        if (dir === 'last') {\r\n          switch (target.type) {\r\n            case 'array': {\r\n              if (target.value === '{') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'function': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'operator': {\r\n              return;\r\n            }\r\n          }\r\n        }\r\n        if (dir === 'next') {\r\n          switch (target.type) {\r\n            case 'function':\r\n            case 'string':\r\n            case 'number':\r\n            case 'operand': {\r\n              return;\r\n            }\r\n            case 'array': {\r\n              if (target.value === '{') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === '(') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      if (token.value === ')') {\r\n        if (dir === 'last') {\r\n          switch (target.type) {\r\n            case 'function':\r\n            case 'number':\r\n            case 'string':\r\n            case 'operand': {\r\n              return;\r\n            }\r\n            case 'array': {\r\n              if (target.value === '}') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        if (dir === 'next') {\r\n          switch (target.type) {\r\n            case 'array': {\r\n              if (target.value === '}') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'function': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'brackets': {\r\n              if (target.value === ')') {\r\n                return;\r\n              }\r\n              break;\r\n            }\r\n            case 'operator': {\r\n              if (target.value === ',') {\r\n                return;\r\n              }\r\n              return;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      throw TypeError(`错误表达式 ${token.value} ${local} ${target.value}`);\r\n    };\r\n    // 循环处理所有token\r\n    while (current < length) {\r\n      // 当前处理的token\r\n      let token = tokens[current];\r\n      // 跳过忽略token\r\n      if (ignoreArray(token)) {\r\n        current++;\r\n        continue;\r\n      }\r\n      if (ignoreFunc(token)) {\r\n        current++;\r\n        continue;\r\n      }\r\n      let { type, value } = token;\r\n      // 处理单引号\r\n      if (type === \"'\") {\r\n        if (sQuotesStack.length) {\r\n          sQuotesStack.pop();\r\n        } else {\r\n          // 双引号中嵌套单引号\r\n          if (!dQuotesStack.length) {\r\n            sQuotesStack.push(\"'\");\r\n          }\r\n        }\r\n      }\r\n      // 处理双引号\r\n      if (type === '\"') {\r\n        if (dQuotesStack.length) {\r\n          dQuotesStack.pop();\r\n        } else {\r\n          // 单引号中嵌套双引号\r\n          if (!sQuotesStack.length) {\r\n            dQuotesStack.push('\"');\r\n          }\r\n        }\r\n      }\r\n      // 处理字符\r\n      if (type === 'string') {\r\n        let last = skipIgnoreToken('last', current - 1);\r\n        let next = skipIgnoreToken('next', current + 1);\r\n        if (last) {\r\n          checkValue('last', last);\r\n        }\r\n        if (next) {\r\n          checkValue('next', next);\r\n        }\r\n      }\r\n      // 处理数字\r\n      if (type === 'number') {\r\n        let last = skipIgnoreToken('last', current - 1);\r\n        let next = skipIgnoreToken('next', current + 1);\r\n        if (last) {\r\n          checkValue('last', last);\r\n        }\r\n        if (next) {\r\n          checkValue('next', next);\r\n        }\r\n      }\r\n      // 处理数组\r\n      if (type === 'array') {\r\n        if (value === '{') {\r\n          arrayStack.push(token);\r\n        }\r\n        if (value === '}') {\r\n          if (arrayStack.length === 0) {\r\n            throw new TypeError('数组缺少闭合标签');\r\n          }\r\n          arrayStack.pop();\r\n        }\r\n        let last = skipIgnoreToken('last', current - 1);\r\n        let next = skipIgnoreToken('next', current + 1);\r\n        if (last) {\r\n          checkArray('last', last);\r\n        }\r\n        if (next) {\r\n          checkArray('next', next);\r\n        }\r\n      }\r\n      // 处理函数调用\r\n      if (type === 'function') {\r\n        if (value === '(') {\r\n          callStack.push(token);\r\n        }\r\n        if (value === ')') {\r\n          callStack.pop();\r\n        }\r\n        let last = skipIgnoreToken('last', current - 1);\r\n        let next = skipIgnoreToken('next', current + 1);\r\n        if (last) {\r\n          checkFunction('last', last);\r\n        }\r\n        if (next) {\r\n          checkFunction('next', next);\r\n        }\r\n      }\r\n      // 处理运算符号\r\n      if (type === 'operator') {\r\n        let last = skipIgnoreToken('last', current - 1);\r\n        let next = skipIgnoreToken('next', current + 1);\r\n        // 运算符需要两边都有操作数\r\n        if (last) {\r\n          checkOperator('last', last);\r\n        } else {\r\n          throw TypeError(`错误表达式: ${token.value} 错误`);\r\n        }\r\n        if (next) {\r\n          checkOperator('next', next);\r\n        } else {\r\n          throw TypeError(`错误表达式: ${token.value} 错误`);\r\n        }\r\n      }\r\n      // 处理括号\r\n      if (type === 'brackets') {\r\n        if (value === '(') {\r\n          bracketsStack.push(token);\r\n        }\r\n        if (value === ')') {\r\n          if (bracketsStack.length === 0) {\r\n            throw new TypeError('括号缺少闭合标签');\r\n          }\r\n          bracketsStack.pop();\r\n        }\r\n      }\r\n      // 处理下一个字符\r\n      current++;\r\n    }\r\n    // 闭合标签检查\r\n    if (arrayStack.length) {\r\n      throw new TypeError('数组缺少闭合标签');\r\n    }\r\n    if (callStack.length) {\r\n      throw new TypeError('函数缺少闭合标签');\r\n    }\r\n    if (sQuotesStack.length) {\r\n      throw new TypeError('单引号缺少闭合标签');\r\n    }\r\n    if (dQuotesStack.length) {\r\n      throw new TypeError('双引号缺少闭合标签');\r\n    }\r\n    if (bracketsStack.length) {\r\n      throw new TypeError('括号缺少闭合标签');\r\n    }\r\n    return tokens;\r\n  }\r\n}\r\n\r\n/**\r\n * 编译表达式\r\n */\r\nclass Compiler {\r\n\r\n  /**\r\n   * Compiler\r\n   * @param tokens\r\n   * @param writer\r\n   */\r\n  constructor({\r\n    tokens, writer,\r\n  } = {}) {\r\n    this.writer = writer;\r\n    this.tokens = tokens;\r\n    this.groupStack = [];\r\n    this.index = -1;\r\n    this.ignore = [','];\r\n    // 运算符\r\n    this.opIf = {\r\n      '>': 'ifge',\r\n      '<': 'ifgt',\r\n      '=': 'ifeq',\r\n      '>=': 'if_icmpge',\r\n      '<=': 'if_icmpgt',\r\n      '<>': 'ifne',\r\n    };\r\n    this.opAdd = {\r\n      '+': 'add',\r\n      '-': 'sub',\r\n      '&': 'link',\r\n    };\r\n    this.opMul = {\r\n      '*': 'mul',\r\n      '/': 'div',\r\n      '%': 'mod',\r\n      '^': 'power',\r\n    };\r\n    this.opCommon = {\r\n      ' ': 'common',\r\n    };\r\n    this.opRel = {\r\n      '!': 'rel',\r\n      ':': 'uni',\r\n    };\r\n    this.opNew = {\r\n      array: 'newarray',\r\n    };\r\n    this.opCell = {\r\n      function: 'invoke',\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 结束\r\n   */\r\n  eofToken() {\r\n    const { index, tokens } = this;\r\n    const { length } = tokens;\r\n    return index >= length - 1;\r\n  }\r\n\r\n  /**\r\n   * 切换下一个Token\r\n   */\r\n  nextToken() {\r\n    this.index++;\r\n    this.token = this.tokens[this.index];\r\n    return this.token;\r\n  }\r\n\r\n  /**\r\n   * 返回上一个Token\r\n   */\r\n  backToken() {\r\n    this.index--;\r\n    this.token = this.tokens[this.index];\r\n    return this.token;\r\n  }\r\n\r\n  /**\r\n   * 记录参数\r\n   */\r\n  reduceGroup() {\r\n    const { groupStack } = this;\r\n    const { length } = groupStack;\r\n    if (length > 0) {\r\n      const last = groupStack[length - 1];\r\n      const number = last.number;\r\n      last.number = number - 1;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 记录参数\r\n   */\r\n  increaseGroup() {\r\n    const { groupStack } = this;\r\n    const { length } = groupStack;\r\n    if (length > 0) {\r\n      const last = groupStack[length - 1];\r\n      const number = last.number;\r\n      last.number = number + 1;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 弹出组\r\n   */\r\n  popGroup() {\r\n    return this.groupStack.pop();\r\n  }\r\n\r\n  /**\r\n   * 添加组\r\n   */\r\n  addGroup(token) {\r\n    token.number = 0;\r\n    this.groupStack.push(token);\r\n    return token;\r\n  }\r\n\r\n  /**\r\n   * 忽略的Token\r\n   * @returns {*}\r\n   */\r\n  isSkipNextToken() {\r\n    if (!this.eofToken()) {\r\n      const { ignore } = this;\r\n      this.nextToken();\r\n      const { token } = this;\r\n      this.backToken();\r\n      const { value } = token;\r\n      return ignore.includes(value);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * 编译表达式\r\n   */\r\n  compile() {\r\n    const { writer } = this;\r\n    this.compileIfge();\r\n    while (this.isSkipNextToken()) {\r\n      this.nextToken();\r\n      this.compileIfge();\r\n    }\r\n    return writer.getInstruct();\r\n  }\r\n\r\n  /**\r\n   * 编译条件运算\r\n   */\r\n  compileIfge() {\r\n    this.compileAdd();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'operator') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      if (!this.opIf[value]) {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      let operator = this.opIf[value];\r\n      this.compileAdd();\r\n      this.reduceGroup();\r\n      this.writer.writeOperator(operator);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 编译加减运算\r\n   */\r\n  compileAdd() {\r\n    this.compileMul();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'operator') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      if (!this.opAdd[value]) {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      let operator = this.opAdd[value];\r\n      this.compileMul();\r\n      this.reduceGroup();\r\n      this.writer.writeOperator(operator);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 编译乘除运算\r\n   */\r\n  compileMul() {\r\n    this.compileCommon();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'operator') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      if (!this.opMul[value]) {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      let operator = this.opMul[value];\r\n      this.compileCommon();\r\n      this.reduceGroup();\r\n      this.writer.writeOperator(operator);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 编译公共区域运算\r\n   */\r\n  compileCommon() {\r\n    this.compileRel();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'operator') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      if (!this.opCommon[value]) {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      let operator = this.opCommon[value];\r\n      this.compileRel();\r\n      this.reduceGroup();\r\n      this.writer.writeOperator(operator);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 编译跨Sheet引用运算\r\n   */\r\n  compileRel() {\r\n    this.compileArray();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'operator') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      if (!this.opRel[value]) {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      let operator = this.opRel[value];\r\n      this.compileArray();\r\n      this.reduceGroup();\r\n      this.writer.writeOperator(operator);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 编译数组创建\r\n   */\r\n  compileArray() {\r\n    this.compileFunction();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'array') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      // 返回跳过 } 标记\r\n      if (value === '}') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      this.addGroup(token);\r\n      // 跳过当前 {  标记\r\n      this.nextToken();\r\n      // 处理数组中的子元素\r\n      this.compileIfge();\r\n      // 下一个是忽略的标记\r\n      // 则继续处理\r\n      while (this.isSkipNextToken()) {\r\n        this.nextToken();\r\n        this.compileIfge();\r\n      }\r\n      // 记录数组需要\r\n      // 操作的元素数量\r\n      this.popGroup();\r\n      const { number } = token;\r\n      const operator = this.opNew[type];\r\n      this.writer.writeOperator(`${operator} ${number}`);\r\n      // 跳过闭合标签 }\r\n      this.nextToken();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 编译函数调用\r\n   */\r\n  compileFunction() {\r\n    this.compilePushValue();\r\n    while (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { type, value } = token;\r\n      if (type !== 'function') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      // 返回跳过 ) 标记\r\n      if (value === ')') {\r\n        this.backToken();\r\n        break;\r\n      }\r\n      this.addGroup(token);\r\n      // 跳过当前 (  标记\r\n      this.nextToken();\r\n      // 处理函数的参数列表\r\n      this.compileIfge();\r\n      // 下一个是忽略的标记\r\n      // 则继续处理\r\n      while (this.isSkipNextToken()) {\r\n        this.nextToken();\r\n        this.compileIfge();\r\n      }\r\n      // 记录函数需要\r\n      // 操作的元素数量\r\n      this.popGroup();\r\n      const { number } = token;\r\n      const operator = this.opCell[type];\r\n      this.writer.writeOperator(`${operator} ${value} ${number}`);\r\n      // 跳过闭合标签 )\r\n      this.nextToken();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * compilePushValue\r\n   */\r\n  compilePushValue() {\r\n    if (!this.eofToken()) {\r\n      const token = this.nextToken();\r\n      const { writer } = this;\r\n      const { type, value } = token;\r\n      // 推送操作数\r\n      // 递增函数/数组的参数数量(有的话)\r\n      switch (type) {\r\n        case 'string': {\r\n          this.increaseGroup();\r\n          writer.writeString(`${value}`);\r\n          return;\r\n        }\r\n        case 'number': {\r\n          this.increaseGroup();\r\n          writer.writeNumber(`${value}`);\r\n          return;\r\n        }\r\n        case 'operand': {\r\n          this.increaseGroup();\r\n          writer.writeOperand(value);\r\n          return;\r\n        }\r\n      }\r\n      // 处理括号计算\r\n      switch (type) {\r\n        case 'brackets': {\r\n          if (value === '(') {\r\n            this.compileIfge();\r\n            // 下一个是忽略的标记\r\n            // 则继续处理\r\n            while (this.isSkipNextToken()) {\r\n              this.nextToken();\r\n              this.compileIfge();\r\n            }\r\n            // 跳过闭合标签 )\r\n            this.nextToken();\r\n          }\r\n          return;\r\n        }\r\n      }\r\n      // 递增函数/数组的参数数量(有的话)\r\n      switch (type) {\r\n        case 'array': {\r\n          // {} 这种清空不需要增加参数数量\r\n          if (value !== '}') {\r\n            this.increaseGroup();\r\n          }\r\n          this.backToken();\r\n          return;\r\n        }\r\n        case 'function': {\r\n          // func() 这种清空不需要增加参数数量\r\n          if (value !== ')') {\r\n            this.increaseGroup();\r\n          }\r\n          this.backToken();\r\n          return;\r\n        }\r\n      }\r\n      // 过滤掉运算符\r\n      switch (type) {\r\n        case 'operator': {\r\n          this.backToken();\r\n          return;\r\n        }\r\n      }\r\n      // 无法识别的token\r\n      throw new TypeError(`无法识别的token ${type} ${value} `);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * 运行表达式\r\n */\r\nclass Evaluation {\r\n\r\n  /**\r\n   * Evaluate\r\n   * @param instruct\r\n   */\r\n  constructor(instruct) {\r\n    this.instruct = instruct.split('\\r\\n');\r\n    this.memory = [];\r\n  }\r\n\r\n  /**\r\n   * 运行表达式\r\n   */\r\n  eval() {\r\n    const newArray = /^newarray/;\r\n    const invoke = /^invoke/;\r\n    const pushSRegexp = /^SPush/;\r\n    const pushNRegexp = /^NPush/;\r\n    const pushORegexp = /^OPush/;\r\n    const { instruct } = this;\r\n    instruct.forEach((name) => {\r\n      switch (name) {\r\n        case 'if_icmpge': {\r\n          this.ificmpge();\r\n          break;\r\n        }\r\n        case 'if_icmpgt': {\r\n          this.ificmpgt();\r\n          break;\r\n        }\r\n        case 'ifge': {\r\n          this.ifge();\r\n          break;\r\n        }\r\n        case 'ifgt': {\r\n          this.ifgt();\r\n          break;\r\n        }\r\n        case 'ifeq': {\r\n          this.ifeq();\r\n          break;\r\n        }\r\n        case 'ifne': {\r\n          this.ifne();\r\n          break;\r\n        }\r\n        case 'add': {\r\n          this.add();\r\n          break;\r\n        }\r\n        case 'sub': {\r\n          this.sub();\r\n          break;\r\n        }\r\n        case 'mul': {\r\n          this.mul();\r\n          break;\r\n        }\r\n        case 'div': {\r\n          this.div();\r\n          break;\r\n        }\r\n        case 'mod': {\r\n          this.mod();\r\n          break;\r\n        }\r\n        case 'power': {\r\n          this.power();\r\n          break;\r\n        }\r\n        case 'rel': {\r\n          this.rel();\r\n          break;\r\n        }\r\n        case 'link': {\r\n          this.link();\r\n          break;\r\n        }\r\n        case 'uni': {\r\n          this.uni();\r\n          break;\r\n        }\r\n        case 'common': {\r\n          this.common();\r\n          break;\r\n        }\r\n        default: {\r\n          if (newArray.test(name)) {\r\n            const group = name.split(' ');\r\n            const index = group[1];\r\n            this.array(index);\r\n            break;\r\n          }\r\n          if (invoke.test(name)) {\r\n            const group = name.split(' ');\r\n            const func = group[1];\r\n            const index = group[2];\r\n            this.invoke(func, index);\r\n            break;\r\n          }\r\n          if (pushSRegexp.test(name)) {\r\n            const value = name.split(' ')[1];\r\n            this.pushS(value);\r\n            break;\r\n          }\r\n          if (pushNRegexp.test(name)) {\r\n            const value = name.split(' ')[1];\r\n            this.pushN(value);\r\n            break;\r\n          }\r\n          if (pushORegexp.test(name)) {\r\n            const value = name.split(' ')[1];\r\n            this.pushO(value);\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    });\r\n    return this.memory.pop();\r\n  }\r\n\r\n  /**\r\n   * 推送操作数\r\n   * @param value\r\n   */\r\n  pushS(value) {\r\n    this.memory.push(value);\r\n  }\r\n\r\n  /**\r\n   * 推送操作数\r\n   * @param value\r\n   */\r\n  pushN(value) {\r\n    value = parseFloat(value);\r\n    this.memory.push(value);\r\n  }\r\n\r\n  /**\r\n   * 推送操作数\r\n   * @param value\r\n   */\r\n  pushO(value) {\r\n    this.memory.push(value);\r\n  }\r\n\r\n  /**\r\n   * 两个值的大于比较\r\n   */\r\n  ifge() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a > b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的小于比较\r\n   */\r\n  ifgt() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a < b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的相等比较\r\n   */\r\n  ifeq() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a === b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的不等比较\r\n   */\r\n  ifne() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a !== b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的大于等于比较\r\n   */\r\n  ificmpge() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a >= b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的小于等于比较\r\n   */\r\n  ificmpgt() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a <= b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的加法运算\r\n   */\r\n  add() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a + b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的减法运算\r\n   */\r\n  sub() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a - b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的乘法运算\r\n   */\r\n  mul() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a * b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的除法运算\r\n   */\r\n  div() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a / b);\r\n  }\r\n\r\n  /**\r\n   * 两个值的mod运算\r\n   */\r\n  mod() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(a % b);\r\n  }\r\n\r\n  /**\r\n   * 计算两个区域的并集\r\n   */\r\n  common() {\r\n    // TODO ...\r\n    // ....\r\n  }\r\n\r\n  /**\r\n   * 跨sheet引用运算\r\n   */\r\n  rel() {\r\n    // TODO ...\r\n    // ....\r\n  }\r\n\r\n  /**\r\n   * 计算两个区域连接的新区域\r\n   */\r\n  uni() {\r\n    // TODO ...\r\n    // ....\r\n  }\r\n\r\n  /**\r\n   * 字符串连接运算\r\n   */\r\n  link() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(`${a}${b}`);\r\n  }\r\n\r\n  /**\r\n   * 乘方计算\r\n   */\r\n  power() {\r\n    const b = this.memory.pop();\r\n    const a = this.memory.pop();\r\n    this.memory.push(Math.pow(a, b));\r\n  }\r\n\r\n  /**\r\n   * 创建数组\r\n   * @param index\r\n   */\r\n  array(index) {\r\n    const array = [];\r\n    for (let i = 1; i <= index; i++) {\r\n      const item = this.memory.pop();\r\n      array.push(item);\r\n    }\r\n    array.reverse();\r\n    this.memory.push(array);\r\n  }\r\n\r\n  /**\r\n   * 执行函数\r\n   * @param func\r\n   * @param index\r\n   */\r\n  invoke(func, index) {\r\n    const array = [];\r\n    for (let i = 1; i <= index; i++) {\r\n      const item = this.memory.pop();\r\n      array.push(item);\r\n    }\r\n    array.reverse();\r\n    const execute = Functions.getFunction(func);\r\n    const result = execute.apply(this, array);\r\n    this.memory.push(result);\r\n  }\r\n}\r\n\r\n/**\r\n * 编译输出指令\r\n * @param input\r\n * @returns {string|*}\r\n * @constructor\r\n */\r\nconst Compile = (input) => {\r\n  if (input.startsWith('=')) {\r\n    input = input.substring(1);\r\n  }\r\n  const tokenizer = new Tokenizer();\r\n  const writer = new Assembly();\r\n  const tokens = tokenizer.lexical(input);\r\n  const compiler = new Compiler({\r\n    writer, tokens,\r\n  });\r\n  return compiler.compile();\r\n};\r\n\r\n/**\r\n * 运行指令\r\n * @param inst\r\n * @returns {*}\r\n * @constructor\r\n */\r\nconst Instruct = (inst) => {\r\n  const evaluation = new Evaluation(inst);\r\n  return evaluation.eval();\r\n};\r\n\r\n/**\r\n * 编译运行\r\n * @constructor\r\n */\r\nconst Evaluate = input => Instruct(Compile(input));\r\n\r\nexport {\r\n  Tokenizer,\r\n  Compiler,\r\n  Assembly,\r\n  Compile,\r\n  Evaluate,\r\n  Instruct,\r\n  Functions,\r\n};\r\n","import { Compile, Instruct } from './Compiler';\r\nimport { SheetUtils } from '../utils/SheetUtils';\r\n\r\n/**\r\n * Formula\r\n */\r\nclass Formula {\r\n\r\n  /**\r\n   * Formula\r\n   * @param expr\r\n   */\r\n  constructor({\r\n    expr = SheetUtils.EMPTY,\r\n  } = {}) {\r\n    this.expr = expr;\r\n    this.content = SheetUtils.Nul;\r\n    this.instruct = SheetUtils.Nul;\r\n  }\r\n\r\n  /**\r\n   * 计算公式\r\n   * @return {string}\r\n   */\r\n  getValue() {\r\n    let { expr } = this;\r\n    let { content } = this;\r\n    let { instruct } = this;\r\n    if (!content) {\r\n      if (!instruct) {\r\n        instruct = Compile(expr);\r\n      }\r\n      content = Instruct(instruct);\r\n    }\r\n    this.content = content;\r\n    this.instruct = instruct;\r\n    return content;\r\n  }\r\n\r\n  /**\r\n   * 有效的表达式\r\n   * @return {boolean}\r\n   */\r\n  hasExpr() {\r\n    let { expr } = this;\r\n    return !SheetUtils.isBlank(expr);\r\n  }\r\n\r\n  /**\r\n   * 获取表达式\r\n   * @return {string}\r\n   */\r\n  getExpr() {\r\n    return this.expr;\r\n  }\r\n\r\n  /**\r\n   * 设置表达式\r\n   * @param expr\r\n   */\r\n  setExpr(expr) {\r\n    this.expr = expr;\r\n    this.content = SheetUtils.Nul;\r\n    this.instruct = SheetUtils.Nul;\r\n  }\r\n\r\n  /**\r\n   * 复制\r\n   * @returns {Formula}\r\n   */\r\n  clone() {\r\n    return new Formula({\r\n      expr: this.expr,\r\n    });\r\n  }\r\n\r\n}\r\n\r\nFormula.EMPTY = new Formula();\r\n\r\nFormula.getInstance = (config) => {\r\n  if (config) {\r\n    return new Formula(config);\r\n  }\r\n  return Formula.EMPTY;\r\n};\r\n\r\nexport {\r\n  Formula,\r\n};\r\n","import { SheetUtils } from '../../../utils/SheetUtils';\r\nimport { CellFont } from './CellFont';\r\nimport { CellBorder } from './CellBorder';\r\nimport { XIcon } from '../tableicon/XIcon';\r\nimport XTableFormat from '../XTableTextFormat';\r\nimport { RichFonts } from './RichFonts';\r\nimport { Formula } from '../../../formula/Formula';\r\nimport { DateUtils } from '../../../utils/DateUtils';\r\nimport { BaseFont } from '../../../draw/font/BaseFont';\r\n\r\n/**\r\n * 单元格\r\n */\r\nclass Cell {\r\n\r\n  /**\r\n   * Cell\r\n   * @param borderAttr\r\n   * @param fontAttr\r\n   * @param richText\r\n   * @param formula\r\n   * @param background\r\n   * @param text\r\n   * @param ruler\r\n   * @param contentWidth\r\n   * @param contentHeight\r\n   * @param format\r\n   * @param custom\r\n   * @param icons\r\n   * @param contentType\r\n   */\r\n  constructor({\r\n    borderAttr = SheetUtils.Undef,\r\n    fontAttr = SheetUtils.Undef,\r\n    richText = SheetUtils.Undef,\r\n    formula = SheetUtils.Undef,\r\n    background = SheetUtils.Undef,\r\n    text = SheetUtils.EMPTY,\r\n    custom = {},\r\n    icons = [],\r\n    ruler = SheetUtils.Undef,\r\n    contentWidth = 0,\r\n    contentHeight = 0,\r\n    format = 'default',\r\n    contentType = Cell.TYPE.STRING,\r\n  } = {}) {\r\n    // 背景颜色\r\n    this.background = background;\r\n    // 单元格图标\r\n    this.icons = XIcon.getInstance(icons);\r\n    // 自定义属性\r\n    this.custom = custom;\r\n    // 字体测量尺子\r\n    this.ruler = ruler;\r\n    // 格式化类型\r\n    this.format = format;\r\n    // 单元格公式\r\n    this.formula = Formula.getInstance(formula);\r\n    // 文本内容\r\n    this.text = text;\r\n    // 富文本内容\r\n    this.richText = RichFonts.getInstance(richText);\r\n    // 格式化后的内容\r\n    this.formatText = SheetUtils.EMPTY;\r\n    // 内容的宽度\r\n    this.contentWidth = contentWidth;\r\n    // 内容的高度\r\n    this.contentHeight = contentHeight;\r\n    // 字体属性\r\n    this.fontAttr = CellFont.getInstance(fontAttr);\r\n    // 边框属性\r\n    this.borderAttr = CellBorder.getInstance(borderAttr);\r\n    // 内容类型\r\n    this.setContentType(contentType);\r\n  }\r\n\r\n  /**\r\n   * 设置单元格小图标\r\n   * @param icons\r\n   */\r\n  setIcons(icons) {\r\n    this.icons = icons;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置内容文本\r\n   * @param text\r\n   */\r\n  setText(text) {\r\n    this.formatText = null;\r\n    this.text = text;\r\n    this.formula.setExpr(null);\r\n    this.richText.setRich([]);\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置富文本\r\n   */\r\n  setRichText(rich) {\r\n    this.formatText = null;\r\n    this.text = null;\r\n    this.formula.setExpr(null);\r\n    this.richText.setRich(rich);\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置公式\r\n   */\r\n  setExpr(expr) {\r\n    this.formatText = null;\r\n    this.text = null;\r\n    this.formula.setExpr(expr);\r\n    this.richText.setRich([]);\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 获取公式\r\n   */\r\n  getExpr() {\r\n    return this.formula.getExpr();\r\n  }\r\n\r\n  /**\r\n   * 设置格式化类型\r\n   * @param format\r\n   */\r\n  setFormat(format = 'default') {\r\n    this.format = format;\r\n    this.formatText = null;\r\n    this.clearRuler();\r\n    this.setContentWidth(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 保存测量尺子\r\n   * @param ruler\r\n   */\r\n  setRuler(ruler) {\r\n    this.ruler = ruler;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置内容类型\r\n   * @param type\r\n   */\r\n  setContentType(type = Cell.TYPE.STRING) {\r\n    const { text } = this;\r\n    switch (type) {\r\n      case Cell.TYPE.STRING: {\r\n        this.contentType = Cell.TYPE.STRING;\r\n        break;\r\n      }\r\n      case Cell.TYPE.NUMBER: {\r\n        this.contentType = type;\r\n        if (SheetUtils.isNumber(text)) {\r\n          this.contentType = Cell.TYPE.NUMBER;\r\n          this.text = SheetUtils.parseFloat(text);\r\n        } else {\r\n          this.contentType = Cell.TYPE.STRING;\r\n          this.text = `${text}`;\r\n        }\r\n        break;\r\n      }\r\n      case Cell.TYPE.DATE_TIME: {\r\n        const parse = DateUtils.parse(text);\r\n        if (SheetUtils.isDate(parse)) {\r\n          this.contentType = Cell.TYPE.DATE_TIME;\r\n          this.text = text;\r\n        } else {\r\n          this.contentType = Cell.TYPE.STRING;\r\n          this.text = `${text}`;\r\n        }\r\n        break;\r\n      }\r\n      case Cell.TYPE.RICH_TEXT: {\r\n        this.contentType = Cell.TYPE.RICH_TEXT;\r\n        break;\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 单元格是否为空\r\n   * @returns {boolean}\r\n   */\r\n  isEmpty() {\r\n    return SheetUtils.isBlank(this.getComputeText());\r\n  }\r\n\r\n  /**\r\n   * 公式是否存在\r\n   */\r\n  hasFormula() {\r\n    return this.formula.hasExpr();\r\n  }\r\n\r\n  /**\r\n   * 获取格式后的文本\r\n   * @returns {string|*}\r\n   */\r\n  getFormatText() {\r\n    let {\r\n      text,\r\n      formula,\r\n      format,\r\n    } = this;\r\n    let { formatText } = this;\r\n    let { contentType } = this;\r\n    // 优先获取公式值\r\n    if (formula.hasExpr()) {\r\n      let value = formula.getValue();\r\n      if (value) {\r\n        if (SheetUtils.isBlank(formatText)) {\r\n          formatText = XTableFormat(format, value);\r\n        }\r\n      }\r\n      this.formatText = formatText;\r\n      return formatText;\r\n    }\r\n    // 格式化文本\r\n    switch (contentType) {\r\n      case Cell.TYPE.STRING:\r\n      case Cell.TYPE.NUMBER:\r\n      case Cell.TYPE.DATE_TIME: {\r\n        if (format) {\r\n          if (SheetUtils.isBlank(formatText)) {\r\n            this.formatText = XTableFormat(format, text);\r\n            return this.formatText;\r\n          }\r\n        }\r\n        return formatText;\r\n      }\r\n    }\r\n    // 默认返回\r\n    return SheetUtils.EMPTY;\r\n  }\r\n\r\n  /**\r\n   * 获取计算后的文本\r\n   * @returns {string|*}\r\n   */\r\n  getComputeText() {\r\n    let { text, formula } = this;\r\n    let { richText } = this;\r\n    let { contentType } = this;\r\n    // 优先获取公式值\r\n    if (formula.hasExpr()) {\r\n      return formula.getValue();\r\n    }\r\n    // 读取不同类型\r\n    switch (contentType) {\r\n      case Cell.TYPE.STRING:\r\n      case Cell.TYPE.NUMBER:\r\n      case Cell.TYPE.DATE_TIME: {\r\n        return text;\r\n      }\r\n      case Cell.TYPE.RICH_TEXT: {\r\n        return richText;\r\n      }\r\n    }\r\n    // 默认返回\r\n    return SheetUtils.EMPTY;\r\n  }\r\n\r\n  /**\r\n   * 字体属性\r\n   * @param attr\r\n   */\r\n  setFontAttr(attr) {\r\n    this.fontAttr = attr;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置边框类型\r\n   * @param attr\r\n   */\r\n  setBorderAttr(attr) {\r\n    this.borderAttr = attr;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 复制单元格\r\n   * @returns {Cell}\r\n   */\r\n  clone() {\r\n    return new Cell(this);\r\n  }\r\n\r\n  /**\r\n   * 复制单元格样式\r\n   * @returns {Cell}\r\n   */\r\n  cloneStyle() {\r\n    return new Cell({\r\n      borderAttr: this.borderAttr,\r\n      fontAttr: this.fontAttr,\r\n      background: this.background,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * toJSON\r\n   */\r\n  toJSON() {\r\n    const { background, text, format, custom } = this;\r\n    const { icons, contentType, formula } = this;\r\n    const { richText, fontAttr, borderAttr } = this;\r\n    return {\r\n      custom,\r\n      richText,\r\n      formula,\r\n      contentType,\r\n      text,\r\n      icons,\r\n      background,\r\n      format,\r\n      fontAttr,\r\n      borderAttr,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * toString\r\n   * @returns {string|*}\r\n   */\r\n  toString() {\r\n    return this.getFormatText();\r\n  }\r\n\r\n  /**\r\n   * 内容宽度\r\n   * @param width\r\n   */\r\n  setContentWidth(width) {\r\n    this.contentWidth = width;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 内容宽度\r\n   * @param height\r\n   */\r\n  setContentHeight(height) {\r\n    this.contentHeight = height;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置换行类型\r\n   * @param textWrap\r\n   */\r\n  setTextWrap(textWrap) {\r\n    this.fontAttr.textWrap = textWrap;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体颜色\r\n   * @param color\r\n   */\r\n  setFontColor(color) {\r\n    this.fontAttr.color = color;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体颜色\r\n   * @param color\r\n   */\r\n  setRichFontColor(color) {\r\n    this.richText.each((i) => {\r\n      i.color = color;\r\n    });\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体大小\r\n   * @param size\r\n   */\r\n  setFontSize(size) {\r\n    this.fontAttr.size = size;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体大小\r\n   * @param size\r\n   */\r\n  setRichFontSize(size) {\r\n    this.richText.each((i) => {\r\n      i.size = size;\r\n    });\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体加粗\r\n   * @param bold\r\n   */\r\n  setFontBold(bold) {\r\n    this.fontAttr.bold = bold;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体加粗\r\n   * @param bold\r\n   */\r\n  setRichFontBold(bold) {\r\n    this.richText.each((i) => {\r\n      i.bold = bold;\r\n    });\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置斜体字\r\n   * @param italic\r\n   */\r\n  setFontItalic(italic) {\r\n    this.fontAttr.italic = italic;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置斜体字\r\n   * @param italic\r\n   */\r\n  setRichFontItalic(italic) {\r\n    this.richText.each((i) => {\r\n      i.italic = italic;\r\n    });\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体名称\r\n   * @param name\r\n   */\r\n  setFontName(name) {\r\n    this.fontAttr.name = name;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体名称\r\n   * @param name\r\n   */\r\n  setRichFontName(name) {\r\n    this.richText.each((i) => {\r\n      i.name = name;\r\n    });\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置下划线\r\n   * @param underline\r\n   */\r\n  setUnderLine(underline) {\r\n    this.fontAttr.underline = underline;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置下划线\r\n   * @param underline\r\n   */\r\n  setRichUnderLine(underline) {\r\n    this.richText.each((i) => {\r\n      i.underline = underline;\r\n    });\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置删除线\r\n   * @param strikeline\r\n   */\r\n  setStrikeLine(strikeline) {\r\n    this.fontAttr.strikethrough = strikeline;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置删除线\r\n   * @param strikeline\r\n   */\r\n  setRichStrikeLine(strikeline) {\r\n    this.richText.each((i) => {\r\n      i.strikethrough = strikeline;\r\n    });\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体旋转角度\r\n   * @param number\r\n   */\r\n  setFontAngle(number) {\r\n    if (number === 0) {\r\n      this.fontAttr.angle = number;\r\n      this.fontAttr.direction = BaseFont.TEXT_DIRECTION.HORIZONTAL;\r\n    } else {\r\n      this.borderAttr.updateMaxIndex();\r\n      this.fontAttr.angle = number;\r\n      this.fontAttr.direction = BaseFont.TEXT_DIRECTION.ANGLE;\r\n    }\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体方向\r\n   * @param direction\r\n   */\r\n  setFontDirection(direction) {\r\n    this.fontAttr.angle = 0;\r\n    this.fontAttr.direction = direction;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置背景\r\n   */\r\n  setBackground(background) {\r\n    this.background = background;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置字体水平对齐\r\n   * @param align\r\n   */\r\n  setFontAlign(align) {\r\n    this.fontAttr.align = align;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * 设置垂直对齐\r\n   * @param verticalAlign\r\n   */\r\n  setFontVerticalAlign(verticalAlign) {\r\n    this.fontAttr.verticalAlign = verticalAlign;\r\n    this.setRuler(null);\r\n    this.setContentWidth(0);\r\n    this.setContentHeight(0);\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\n/**\r\n * 单元格类型\r\n */\r\nCell.TYPE = {\r\n  // 数字\r\n  NUMBER: 0,\r\n  // 字符\r\n  STRING: 1,\r\n  // 富文本\r\n  RICH_TEXT: 2,\r\n  // 日期\r\n  DATE_TIME: 3,\r\n};\r\n\r\nexport {\r\n  Cell,\r\n};\r\n","class Listen {\r\n\r\n  constructor() {\r\n    this.pool = {};\r\n  }\r\n\r\n  clear() {\r\n    Object.keys((key) => {\r\n      delete this.pool[key];\r\n    });\r\n  }\r\n\r\n  removeListen(key) {\r\n    delete this.pool[key];\r\n  }\r\n\r\n  registerListen(key, call) {\r\n    this.pool[key] = call;\r\n  }\r\n\r\n  execute(key, ...message) {\r\n    if (this.pool[key]) {\r\n      this.pool[key](...message);\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  Listen,\r\n};\r\n","import { SheetUtils } from '../../../utils/SheetUtils';\r\n\r\nclass RectRange {\r\n\r\n  /**\r\n   * RectRange\r\n   * @param {int} sri 起始行\r\n   * @param {int} sci 起始列\r\n   * @param {int} eri 结束行\r\n   * @param {int} eci 结束列\r\n   * @param {int} w 宽度\r\n   * @param {int} h 高度\r\n   */\r\n  constructor(sri, sci, eri, eci, w = 0, h = 0) {\r\n    this.sri = sri;\r\n    this.sci = sci;\r\n    this.eri = eri;\r\n    this.eci = eci;\r\n    this.w = w;\r\n    this.h = h;\r\n  }\r\n\r\n  /**\r\n   * 循环过滤指定的行列\r\n   * @param {XIteratorBuilder} iteratorBuilder 迭代器\r\n   * @param {Function} cb 回调函数\r\n   * @param {Function} rowFilter 过滤使用的回调函数\r\n   */\r\n  each(iteratorBuilder, cb, rowFilter = () => true) {\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    let ret = false;\r\n    iteratorBuilder.getRowIterator()\r\n      .setBegin(sri)\r\n      .setEnd(eri)\r\n      .setLoop((i) => {\r\n        if (rowFilter(i)) {\r\n          iteratorBuilder.getColIterator()\r\n            .setBegin(sci)\r\n            .setEnd(eci)\r\n            .setLoop((j) => {\r\n              ret = cb(i, j);\r\n              return ret;\r\n            })\r\n            .execute();\r\n        }\r\n        return ret;\r\n      })\r\n      .execute();\r\n  }\r\n\r\n  /**\r\n   * 设置区域\r\n   * @param {int} sri 起始行\r\n   * @param {int} sci 起始列\r\n   * @param {int} eri 结束行\r\n   * @param {int} eci 结束列\r\n   */\r\n  set(sri, sci, eri, eci) {\r\n    this.sri = sri;\r\n    this.sci = sci;\r\n    this.eri = eri;\r\n    this.eci = eci;\r\n  }\r\n\r\n  /**\r\n   * 判断是否跨多个单元格\r\n   * @returns {boolean}\r\n   */\r\n  multiple() {\r\n    return this.eri - this.sri > 0 || this.eci - this.sci > 0;\r\n  }\r\n\r\n  /**\r\n   * 判断当前的区域是否包含指定的行和列\r\n   * 参数支持 ri, ci 和 A10 两种形式\r\n   * @param {[int, int] | String} args 行索引,列索引 或者 字符串\r\n   * @returns {boolean}\r\n   */\r\n  includes(...args) {\r\n    let [ri, ci] = [0, 0];\r\n    if (args.length === 1) {\r\n      [ci, ri] = SheetUtils.expr2xy(args[0]);\r\n    } else if (args.length === 2) {\r\n      [ri, ci] = args;\r\n    }\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    return sri <= ri && ri <= eri && sci <= ci && ci <= eci;\r\n  }\r\n\r\n  /**\r\n   * 判断当前的区域是否包含指定的区域\r\n   * @param {RectRange} other 区域\r\n   * @returns {boolean}\r\n   */\r\n  contains(other) {\r\n    return this.sri <= other.sri\r\n      && this.sci <= other.sci\r\n      && this.eri >= other.eri\r\n      && this.eci >= other.eci;\r\n  }\r\n\r\n  /**\r\n   * 判断当前的区域是否被指定的区域包含\r\n   * @param {RectRange} other 区域\r\n   * @returns {boolean}\r\n   */\r\n  within(other) {\r\n    return this.sri >= other.sri\r\n      && this.sci >= other.sci\r\n      && this.eri <= other.eri\r\n      && this.eci <= other.eci;\r\n  }\r\n\r\n  /**\r\n   * 判断当前的区域和指定的区域不发生重合\r\n   * @param {RectRange} other 区域\r\n   * @returns {boolean}\r\n   */\r\n  disjoint(other) {\r\n    return this.sri > other.eri\r\n      || this.sci > other.eci\r\n      || other.sri > this.eri\r\n      || other.sci > this.eci;\r\n  }\r\n\r\n  /**\r\n   * 判断当前的区域和指定的区域发生重合\r\n   * @param {RectRange} other 区域\r\n   * @returns {boolean}\r\n   */\r\n  intersects(other) {\r\n    return this.sri <= other.eri\r\n      && this.sci <= other.eci\r\n      && other.sri <= this.eri\r\n      && other.sci <= this.eci;\r\n  }\r\n\r\n  /**\r\n   * 返回当前区域和指定区域合并后的新区域\r\n   * @param {RectRange} other 区域\r\n   * @returns {RectRange}\r\n   */\r\n  union(other) {\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    return new RectRange(\r\n      other.sri < sri ? other.sri : sri,\r\n      other.sci < sci ? other.sci : sci,\r\n      other.eri > eri ? other.eri : eri,\r\n      other.eci > eci ? other.eci : eci,\r\n    );\r\n  }\r\n\r\n  /**\r\n   * 返回当前区域和指定区域合重合的新区域\r\n   * @param {RectRange} other\r\n   * @returns {RectRange}\r\n   */\r\n  coincide(other) {\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    if (this.disjoint(other)) {\r\n      return RectRange.EMPTY;\r\n    }\r\n    return new RectRange(\r\n      other.sri > sri ? other.sri : sri,\r\n      other.sci > sci ? other.sci : sci,\r\n      other.eri < eri ? other.eri : eri,\r\n      other.eci < eci ? other.eci : eci,\r\n    );\r\n  }\r\n\r\n  /**\r\n   * 当前区域和指定区域重合\r\n   * 返回当前区域和指定区域不重合的部分\r\n   * @param {RectRange} other 区域\r\n   * @returns {Array}\r\n   */\r\n  coincideDifference(other) {\r\n    if (this.coincide(other).equals(RectRange.EMPTY)) {\r\n      return [];\r\n    }\r\n    return this.difference(other);\r\n  }\r\n\r\n  /**\r\n   * 返回当前区域和指定区域不重合的部分\r\n   * @param {RectRange} other 区域\r\n   * @returns {Array}\r\n   */\r\n  difference(other) {\r\n    const ret = [];\r\n    const addRet = (sri, sci, eri, eci) => {\r\n      ret.push(new RectRange(sri, sci, eri, eci));\r\n    };\r\n    const { sri, sci, eri, eci } = this;\r\n    const dsr = other.sri - sri;\r\n    const dsc = other.sci - sci;\r\n    const der = eri - other.eri;\r\n    const dec = eci - other.eci;\r\n    if (dsr > 0) {\r\n      addRet(sri, sci, other.sri - 1, eci);\r\n      if (der > 0) {\r\n        addRet(other.eri + 1, sci, eri, eci);\r\n        if (dsc > 0) {\r\n          addRet(other.sri, sci, other.eri, other.sci - 1);\r\n        }\r\n        if (dec > 0) {\r\n          addRet(other.sri, other.eci + 1, other.eri, eci);\r\n        }\r\n      } else {\r\n        if (dsc > 0) {\r\n          addRet(other.sri, sci, eri, other.sci - 1);\r\n        }\r\n        if (dec > 0) {\r\n          addRet(other.sri, other.eci + 1, eri, eci);\r\n        }\r\n      }\r\n    } else if (der > 0) {\r\n      addRet(other.eri + 1, sci, eri, eci);\r\n      if (dsc > 0) {\r\n        addRet(sri, sci, other.eri, other.sci - 1);\r\n      }\r\n      if (dec > 0) {\r\n        addRet(sri, other.eci + 1, other.eri, eci);\r\n      }\r\n    }\r\n    if (dsc > 0) {\r\n      addRet(sri, sci, eri, other.sci - 1);\r\n      if (dec > 0) {\r\n        addRet(sri, other.eri + 1, eri, eci);\r\n        if (dsr > 0) {\r\n          addRet(sri, other.sci, other.sri - 1, other.eci);\r\n        }\r\n        if (der > 0) {\r\n          addRet(other.sri + 1, other.sci, eri, other.eci);\r\n        }\r\n      } else {\r\n        if (dsr > 0) {\r\n          addRet(sri, other.sci, other.sri - 1, eci);\r\n        }\r\n        if (der > 0) {\r\n          addRet(other.sri + 1, other.sci, eri, eci);\r\n        }\r\n      }\r\n    } else if (dec > 0) {\r\n      addRet(sri, other.eci + 1, eri, eci);\r\n      if (dsr > 0) {\r\n        addRet(sri, sci, other.sri - 1, other.eci);\r\n      }\r\n      if (der > 0) {\r\n        addRet(other.eri + 1, sci, eri, other.eci);\r\n      }\r\n    }\r\n    return ret;\r\n  }\r\n\r\n  /**\r\n   * 当前区域跨的行列数\r\n   * @returns {number[]}\r\n   */\r\n  size() {\r\n    return [\r\n      this.eri - this.sri + 1,\r\n      this.eci - this.sci + 1,\r\n    ];\r\n  }\r\n\r\n  /**\r\n   * 返回边缘区域\r\n   * @returns {{top: RectRange, left: RectRange, bottom: RectRange, right: RectRange}}\r\n   */\r\n  brink() {\r\n    const { sri, eri, sci, eci } = this;\r\n    const top = new RectRange(sri, sci, sri, eci);\r\n    const bottom = new RectRange(eri, sci, eri, eci);\r\n    const right = new RectRange(sri, eci, eri, eci);\r\n    const left = new RectRange(sri, sci, eri, sci);\r\n    return { top, right, bottom, left };\r\n  }\r\n\r\n  /**\r\n   * 方位点\r\n   * @returns {{rb: RectRange, rt: RectRange, lb: RectRange, lt: RectRange}}\r\n   */\r\n  point() {\r\n    const { sri, eri, sci, eci } = this;\r\n    const lt = new RectRange(sri, sci, sri, sci);\r\n    const rt = new RectRange(sri, eci, sri, eci);\r\n    const lb = new RectRange(eri, sci, eri, sci);\r\n    const rb = new RectRange(eri, eci, eri, eci);\r\n    return { lt, rt, lb, rb };\r\n  }\r\n\r\n  /**\r\n   * equals\r\n   * @param {RectRange} other 区域\r\n   * @returns {boolean}\r\n   */\r\n  equals(other) {\r\n    return this.eri === other.eri\r\n      && this.eci === other.eci\r\n      && this.sri === other.sri\r\n      && this.sci === other.sci;\r\n  }\r\n\r\n  /**\r\n   * 克隆\r\n   * @returns {RectRange}\r\n   */\r\n  clone() {\r\n    const {\r\n      sri, sci, eri, eci, w, h,\r\n    } = this;\r\n    return new RectRange(sri, sci, eri, eci, w, h);\r\n  }\r\n\r\n  toString() {\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    let ref = SheetUtils.xy2expr(sci, sri);\r\n    if (this.multiple()) {\r\n      ref = `${ref}:${SheetUtils.xy2expr(eci, eri)}`;\r\n    }\r\n    return ref;\r\n  }\r\n\r\n  /**\r\n   * 将 B1:B8 或者 B1 参数转换成新的区域\r\n   * @param {String} ref 行列字符串\r\n   * @returns {RectRange}\r\n   */\r\n  static valueOf(ref) {\r\n    const refs = ref.split(':');\r\n    const [sci, sri] = SheetUtils.expr2xy(refs[0]);\r\n    let [eri, eci] = [sri, sci];\r\n    if (refs.length > 1) {\r\n      [eci, eri] = SheetUtils.expr2xy(refs[1]);\r\n    }\r\n    return new RectRange(sri, sci, eri, eci);\r\n  }\r\n}\r\n\r\nRectRange.EMPTY = new RectRange(-1, -1, -1, -1);\r\n\r\nexport { RectRange };\r\n","/**\r\n * 数据快照\r\n */\r\nimport { Listen } from '../../../lib/Listen';\r\n\r\nclass Snapshot {\r\n\r\n  /**\r\n   * Snapshot\r\n   */\r\n  constructor() {\r\n    // 撤销\r\n    this.undoStack = [];\r\n    // 反撤销\r\n    this.redoStack = [];\r\n    // 当前记录层\r\n    this.layer = {\r\n      event: '',\r\n      data: [],\r\n    };\r\n    // 启用记录\r\n    this.apply = false;\r\n    // 数据监听\r\n    this.listen = new Listen();\r\n  }\r\n\r\n  /**\r\n   * 撤销\r\n   */\r\n  undo() {\r\n    const layer = this.undoStack.pop();\r\n    for (let i = layer.data.length - 1; i >= 0; i--) {\r\n      const action = layer.data[i];\r\n      action.undo();\r\n    }\r\n    this.redoStack.push(layer);\r\n    this.listen.execute('change', layer.event, 'undo');\r\n  }\r\n\r\n  /**\r\n   * 反撤销\r\n   */\r\n  redo() {\r\n    const layer = this.redoStack.pop();\r\n    for (let i = 0, len = layer.data.length; i < len; i++) {\r\n      const action = layer.data[i];\r\n      action.redo();\r\n    }\r\n    this.undoStack.push(layer);\r\n    this.listen.execute('change', layer.event, 'redo');\r\n  }\r\n\r\n  /**\r\n   * 打开快照\r\n   */\r\n  open() {\r\n    this.layer = {\r\n      event: '',\r\n      data: [],\r\n    };\r\n    this.apply = true;\r\n  }\r\n\r\n  /**\r\n   * 能否反撤销\r\n   * @returns {boolean}\r\n   */\r\n  canRedo() {\r\n    return this.redoStack.length > 0;\r\n  }\r\n\r\n  /**\r\n   * 能否撤销\r\n   * @returns {boolean}\r\n   */\r\n  canUndo() {\r\n    return this.undoStack.length > 0;\r\n  }\r\n\r\n  /**\r\n   * 关闭快照\r\n   */\r\n  close(event) {\r\n    if (this.layer.data.length) {\r\n      this.layer.event = event;\r\n      this.redoStack = [];\r\n      this.undoStack.push(this.layer);\r\n    }\r\n    this.layer = {\r\n      event: '',\r\n      data: [],\r\n    };\r\n    this.apply = false;\r\n    this.listen.execute('change', event, 'close');\r\n  }\r\n\r\n  /**\r\n   * 添加动作\r\n   * @param action\r\n   */\r\n  addAction(action = {\r\n    undo: () => {},\r\n    redo: () => {},\r\n  }) {\r\n    if (this.apply) {\r\n      this.layer.data.push(action);\r\n    }\r\n  }\r\n}\r\n\r\nexport {\r\n  Snapshot,\r\n};\r\n","function Compare(a, b) {\r\n  return a < b ? -1 : a > b ? 1 : 0;\r\n}\r\n\r\nfunction Swap(arr, i, j) {\r\n  let tmp = arr[i];\r\n  arr[i] = arr[j];\r\n  arr[j] = tmp;\r\n}\r\n\r\nfunction QStep(arr, k, left, right, compare) {\r\n  while (right > left) {\r\n    if (right - left > 600) {\r\n      let n = right - left + 1;\r\n      let m = k - left + 1;\r\n      let z = Math.log(n);\r\n      let s = 0.5 * Math.exp(2 * z / 3);\r\n      let sd = 0.5 * Math.sqrt(z * s * (n - s) / n) * (m - n / 2 < 0 ? -1 : 1);\r\n      let newLeft = Math.max(left, Math.floor(k - m * s / n + sd));\r\n      let newRight = Math.min(right, Math.floor(k + (n - m) * s / n + sd));\r\n      QStep(arr, k, newLeft, newRight, compare);\r\n    }\r\n\r\n    let t = arr[k];\r\n    let i = left;\r\n    let j = right;\r\n\r\n    Swap(arr, left, k);\r\n    if (compare(arr[right], t) > 0) Swap(arr, left, right);\r\n\r\n    while (i < j) {\r\n      Swap(arr, i, j);\r\n      i++;\r\n      j--;\r\n      while (compare(arr[i], t) < 0) i++;\r\n      while (compare(arr[j], t) > 0) j--;\r\n    }\r\n\r\n    if (compare(arr[left], t) === 0) Swap(arr, left, j);\r\n    else {\r\n      j++;\r\n      Swap(arr, j, right);\r\n    }\r\n\r\n    if (j <= k) left = j + 1;\r\n    if (k <= j) right = j - 1;\r\n  }\r\n}\r\n\r\nfunction QkSelect(arr, k, left, right, compare) {\r\n  QStep(arr, k, left || 0, right || (arr.length - 1), compare || Compare);\r\n}\r\n\r\nexport {\r\n  QkSelect,\r\n};\r\n","import { QkSelect } from './QkSelect';\r\n\r\nfunction findItem(item, items, equalsFn) {\r\n  if (!equalsFn) {\r\n    return items.indexOf(item);\r\n  }\r\n  for (let i = 0; i < items.length; i++) {\r\n    if (equalsFn(item, items[i])) return i;\r\n  }\r\n  return -1;\r\n}\r\nfunction extend(a, b) {\r\n  a.minX = Math.min(a.minX, b.minX);\r\n  a.minY = Math.min(a.minY, b.minY);\r\n  a.maxX = Math.max(a.maxX, b.maxX);\r\n  a.maxY = Math.max(a.maxY, b.maxY);\r\n  return a;\r\n}\r\nfunction compareNodeMinX(a, b) {\r\n  return a.minX - b.minX;\r\n}\r\nfunction compareNodeMinY(a, b) {\r\n  return a.minY - b.minY;\r\n}\r\nfunction bboxArea(a) {\r\n  return (a.maxX - a.minX) * (a.maxY - a.minY);\r\n}\r\nfunction bboxMargin(a) {\r\n  return (a.maxX - a.minX) + (a.maxY - a.minY);\r\n}\r\nfunction enlargedArea(a, b) {\r\n  return (Math.max(b.maxX, a.maxX) - Math.min(b.minX, a.minX)) * (Math.max(b.maxY, a.maxY) - Math.min(b.minY, a.minY));\r\n}\r\nfunction intersectionArea(a, b) {\r\n  const minX = Math.max(a.minX, b.minX);\r\n  const minY = Math.max(a.minY, b.minY);\r\n  const maxX = Math.min(a.maxX, b.maxX);\r\n  const maxY = Math.min(a.maxY, b.maxY);\r\n  return Math.max(0, maxX - minX) * Math.max(0, maxY - minY);\r\n}\r\nfunction contains(a, b) {\r\n  return a.minX <= b.minX && a.minY <= b.minY && b.maxX <= a.maxX && b.maxY <= a.maxY;\r\n}\r\nfunction intersects(a, b) {\r\n  return b.minX <= a.maxX && b.minY <= a.maxY && b.maxX >= a.minX && b.maxY >= a.minY;\r\n}\r\nfunction createNode(childrenNodes) {\r\n  return {\r\n    childrenNodes,\r\n    height: 1,\r\n    leaf: true,\r\n    minX: Infinity,\r\n    minY: Infinity,\r\n    maxX: -Infinity,\r\n    maxY: -Infinity,\r\n  };\r\n}\r\nfunction distBBox(node, k, p, toBBox, destNode) {\r\n  // 从 k 到 p-1 的节点子节点的最小边界矩形\r\n  if (!destNode) destNode = createNode(null);\r\n  destNode.minX = Infinity;\r\n  destNode.minY = Infinity;\r\n  destNode.maxX = -Infinity;\r\n  destNode.maxY = -Infinity;\r\n  for (let i = k; i < p; i++) {\r\n    const child = node.childrenNodes[i];\r\n    extend(destNode, node.leaf ? toBBox(child) : child);\r\n  }\r\n  return destNode;\r\n}\r\nfunction calcBBox(node, toBBox) {\r\n  // 从其子节点的框计算节点框\r\n  distBBox(node, 0, node.childrenNodes.length, toBBox, node);\r\n}\r\nfunction multiSelect(arr, left, right, n, compare) {\r\n  // 对数组进行排序，以便项目以 n 个未排序项目为一组，各组在彼此之间排序；\r\n  // 将选择算法与二元分治法相结合\r\n  const stack = [left, right];\r\n  while (stack.length) {\r\n    right = stack.pop();\r\n    left = stack.pop();\r\n    if (right - left <= n) continue;\r\n    const mid = left + Math.ceil((right - left) / n / 2) * n;\r\n    QkSelect(arr, mid, left, right, compare);\r\n    stack.push(left, mid, mid, right);\r\n  }\r\n}\r\n\r\nclass RectTree {\r\n  constructor(maxEntries = 9) {\r\n    // 默认情况下，节点中的最大条目数为 9； 最小节点填充为 40% 以获得最佳性能\r\n    this._maxEntries = Math.max(4, maxEntries);\r\n    this._minEntries = Math.max(2, Math.ceil(this._maxEntries * 0.4));\r\n    this.clear();\r\n  }\r\n\r\n  all() {\r\n    return this._all(this.data, []);\r\n  }\r\n\r\n  search(bbox) {\r\n    let node = this.data;\r\n    const result = [];\r\n\r\n    if (!intersects(bbox, node)) {\r\n      return result;\r\n    }\r\n\r\n    const toBBox = this.toBBox;\r\n    const nodesToSearch = [];\r\n\r\n    while (node) {\r\n      for (let i = 0; i < node.childrenNodes.length; i++) {\r\n        const child = node.childrenNodes[i];\r\n        const childBBox = node.leaf ? toBBox(child) : child;\r\n        if (intersects(bbox, childBBox)) {\r\n          if (node.leaf) result.push(child);\r\n          else if (contains(bbox, childBBox)) this._all(child, result);\r\n          else nodesToSearch.push(child);\r\n        }\r\n      }\r\n      node = nodesToSearch.pop();\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  first(bbox) {\r\n    return this.search(bbox)[0];\r\n  }\r\n\r\n  collides(bbox) {\r\n    let node = this.data;\r\n\r\n    if (!intersects(bbox, node)) {\r\n      return false;\r\n    }\r\n\r\n    const nodesToSearch = [];\r\n    while (node) {\r\n      for (let i = 0; i < node.childrenNodes.length; i++) {\r\n        const child = node.childrenNodes[i];\r\n        const childBBox = node.leaf ? this.toBBox(child) : child;\r\n        if (intersects(bbox, childBBox)) {\r\n          if (node.leaf || contains(bbox, childBBox)) return true;\r\n          nodesToSearch.push(child);\r\n        }\r\n      }\r\n      node = nodesToSearch.pop();\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  load(data) {\r\n    if (!(data && data.length)) {\r\n      return this;\r\n    }\r\n\r\n    if (data.length < this._minEntries) {\r\n      for (let i = 0; i < data.length; i++) {\r\n        this.insert(data[i]);\r\n      }\r\n      return this;\r\n    }\r\n\r\n    // 使用 OMT 算法从头开始使用给定数据递归构建树\r\n    let node = this._build(data.slice(), 0, data.length - 1, 0);\r\n\r\n    if (!this.data.childrenNodes.length) {\r\n      // 如果树为空，则按原样保存\r\n      this.data = node;\r\n    } else if (this.data.height === node.height) {\r\n      // 如果树具有相同的高度，则拆分根\r\n      this._splitRoot(this.data, node);\r\n    } else {\r\n      if (this.data.height < node.height) {\r\n        // 如果插入的树更大，则交换树\r\n        const tmpNode = this.data;\r\n        this.data = node;\r\n        node = tmpNode;\r\n      }\r\n      // 将小树插入大树中适当的层次\r\n      this._insert(node, this.data.height - node.height - 1, true);\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  insert(item) {\r\n    if (item) {\r\n      this._insert(item, this.data.height - 1);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  clear() {\r\n    this.data = createNode([]);\r\n    return this;\r\n  }\r\n\r\n  remove(item, equalsFn) {\r\n    if (!item) {\r\n      return this;\r\n    }\r\n\r\n    let node = this.data;\r\n    const bbox = this.toBBox(item);\r\n    const path = [];\r\n    const indexes = [];\r\n    let i;\r\n    let parent;\r\n    let goingUp;\r\n\r\n    // 深度优先迭代树遍历\r\n    while (node || path.length) {\r\n      if (!node) {\r\n        // 往上\r\n        node = path.pop();\r\n        parent = path[path.length - 1];\r\n        i = indexes.pop();\r\n        goingUp = true;\r\n      }\r\n\r\n      if (node.leaf) {\r\n        // 检查当前节点\r\n        const index = findItem(item, node.childrenNodes, equalsFn);\r\n        if (index !== -1) {\r\n          // 找到项目，移除项目并向上压缩树\r\n          node.childrenNodes.splice(index, 1);\r\n          path.push(node);\r\n          this._condense(path);\r\n          return this;\r\n        }\r\n      }\r\n\r\n      if (!goingUp && !node.leaf && contains(node, bbox)) {\r\n        // 往下\r\n        path.push(node);\r\n        indexes.push(i);\r\n        i = 0;\r\n        parent = node;\r\n        node = node.childrenNodes[0];\r\n      } else if (parent) {\r\n        // 向右走\r\n        i++;\r\n        node = parent.childrenNodes[i];\r\n        goingUp = false;\r\n      } else {\r\n        // 没有发现\r\n        node = null;\r\n      }\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  toBBox(item) {\r\n    return item;\r\n  }\r\n\r\n  compareMinX(a, b) {\r\n    return a.minX - b.minX;\r\n  }\r\n\r\n  compareMinY(a, b) {\r\n    return a.minY - b.minY;\r\n  }\r\n\r\n  _all(node, result) {\r\n    const nodesToSearch = [];\r\n    while (node) {\r\n      if (node.leaf) {\r\n        result.push(...node.childrenNodes);\r\n      } else {\r\n        nodesToSearch.push(...node.childrenNodes);\r\n      }\r\n      node = nodesToSearch.pop();\r\n    }\r\n    return result;\r\n  }\r\n\r\n  _build(items, left, right, height) {\r\n    const N = right - left + 1;\r\n    let M = this._maxEntries;\r\n    let node;\r\n\r\n    if (N <= M) {\r\n      // 达到叶级； 回叶\r\n      node = createNode(items.slice(left, right + 1));\r\n      calcBBox(node, this.toBBox);\r\n      return node;\r\n    }\r\n\r\n    if (!height) {\r\n      // 散装树的目标高度\r\n      height = Math.ceil(Math.log(N) / Math.log(M));\r\n      // 目标根条目数以最大限度地提高存储利用率\r\n      M = Math.ceil(N / Math.pow(M, height - 1));\r\n    }\r\n\r\n    node = createNode([]);\r\n    node.leaf = false;\r\n    node.height = height;\r\n\r\n    // 将项目分成 M 个主要为方形的元素\r\n    const N2 = Math.ceil(N / M);\r\n    const N1 = N2 * Math.ceil(Math.sqrt(M));\r\n\r\n    multiSelect(items, left, right, N1, this.compareMinX);\r\n\r\n    for (let i = left; i <= right; i += N1) {\r\n      const right2 = Math.min(i + N1 - 1, right);\r\n      multiSelect(items, i, right2, N2, this.compareMinY);\r\n      for (let j = i; j <= right2; j += N2) {\r\n        const right3 = Math.min(j + N2 - 1, right2);\r\n        // 递归地打包每个条目\r\n        node.childrenNodes.push(this._build(items, j, right3, height - 1));\r\n      }\r\n    }\r\n\r\n    calcBBox(node, this.toBBox);\r\n\r\n    return node;\r\n  }\r\n\r\n  _chooseSubtree(bbox, node, level, path) {\r\n    while (true) {\r\n      path.push(node);\r\n\r\n      if (node.leaf || path.length - 1 === level) {\r\n        break;\r\n      }\r\n\r\n      let minArea = Infinity;\r\n      let minEnlargement = Infinity;\r\n      let targetNode;\r\n\r\n      for (let i = 0; i < node.childrenNodes.length; i++) {\r\n        const child = node.childrenNodes[i];\r\n        const area = bboxArea(child);\r\n        const enlargement = enlargedArea(bbox, child) - area;\r\n\r\n        // 选择最小面积扩大的入口\r\n        if (enlargement < minEnlargement) {\r\n          minEnlargement = enlargement;\r\n          minArea = area < minArea ? area : minArea;\r\n          targetNode = child;\r\n        } else if (enlargement === minEnlargement) {\r\n          // 否则选择面积最小的一个\r\n          if (area < minArea) {\r\n            minArea = area;\r\n            targetNode = child;\r\n          }\r\n        }\r\n      }\r\n\r\n      node = targetNode || node.childrenNodes[0];\r\n    }\r\n\r\n    return node;\r\n  }\r\n\r\n  _insert(item, level, isNode) {\r\n    const bbox = isNode ? item : this.toBBox(item);\r\n    const insertPath = [];\r\n\r\n    // 找到容纳物品的最佳节点，同时保存路径上的所有节点\r\n    const node = this._chooseSubtree(bbox, this.data, level, insertPath);\r\n\r\n    // 将项目放入节点\r\n    node.childrenNodes.push(item);\r\n    extend(node, bbox);\r\n\r\n    // 节点溢出时分裂； 必要时向上传播\r\n    while (level >= 0) {\r\n      if (insertPath[level].childrenNodes.length > this._maxEntries) {\r\n        this._split(insertPath, level);\r\n        level--;\r\n      } else {\r\n        break;\r\n      }\r\n    }\r\n\r\n    // 沿插入路径调整 bboxes\r\n    this._adjustParentBBoxes(bbox, insertPath, level);\r\n  }\r\n\r\n  // 将溢出的节点一分为二\r\n  _split(insertPath, level) {\r\n    const node = insertPath[level];\r\n    const M = node.childrenNodes.length;\r\n    const m = this._minEntries;\r\n\r\n    this._chooseSplitAxis(node, m, M);\r\n\r\n    const splitIndex = this._chooseSplitIndex(node, m, M);\r\n\r\n    const newNode = createNode(node.childrenNodes.splice(splitIndex, node.childrenNodes.length - splitIndex));\r\n    newNode.height = node.height;\r\n    newNode.leaf = node.leaf;\r\n\r\n    calcBBox(node, this.toBBox);\r\n    calcBBox(newNode, this.toBBox);\r\n\r\n    if (level) {\r\n      insertPath[level - 1].childrenNodes.push(newNode);\r\n    } else {\r\n      this._splitRoot(node, newNode);\r\n    }\r\n  }\r\n\r\n  _splitRoot(node, newNode) {\r\n    // 分裂根节点\r\n    this.data = createNode([node, newNode]);\r\n    this.data.height = node.height + 1;\r\n    this.data.leaf = false;\r\n    calcBBox(this.data, this.toBBox);\r\n  }\r\n\r\n  _chooseSplitIndex(node, m, M) {\r\n    let index;\r\n    let minOverlap = Infinity;\r\n    let minArea = Infinity;\r\n\r\n    for (let i = m; i <= M - m; i++) {\r\n      const bbox1 = distBBox(node, 0, i, this.toBBox);\r\n      const bbox2 = distBBox(node, i, M, this.toBBox);\r\n\r\n      const overlap = intersectionArea(bbox1, bbox2);\r\n      const area = bboxArea(bbox1) + bboxArea(bbox2);\r\n\r\n      // 选择重叠最小的分布\r\n      if (overlap < minOverlap) {\r\n        minOverlap = overlap;\r\n        index = i;\r\n        minArea = area < minArea ? area : minArea;\r\n      } else if (overlap === minOverlap) {\r\n        // 否则选择面积最小的分布\r\n        if (area < minArea) {\r\n          minArea = area;\r\n          index = i;\r\n        }\r\n      }\r\n    }\r\n\r\n    return index || M - m;\r\n  }\r\n\r\n  // 按最佳轴对节点子节点进行排序以进行拆分\r\n  _chooseSplitAxis(node, m, M) {\r\n    const compareMinX = node.leaf ? this.compareMinX : compareNodeMinX;\r\n    const compareMinY = node.leaf ? this.compareMinY : compareNodeMinY;\r\n    const xMargin = this._allDistMargin(node, m, M, compareMinX);\r\n    const yMargin = this._allDistMargin(node, m, M, compareMinY);\r\n    // 如果 x 的总分配边际值最小，则按 minX 排序,\r\n    // 否则它已经按 minY 排序\r\n    if (xMargin < yMargin) {\r\n      node.childrenNodes.sort(compareMinX);\r\n    }\r\n  }\r\n\r\n  // 所有可能的分割分布的总边际，其中每个节点至少是 m 满\r\n  _allDistMargin(node, m, M, compare) {\r\n    node.childrenNodes.sort(compare);\r\n\r\n    const toBBox = this.toBBox;\r\n    const leftBBox = distBBox(node, 0, m, toBBox);\r\n    const rightBBox = distBBox(node, M - m, M, toBBox);\r\n    let margin = bboxMargin(leftBBox) + bboxMargin(rightBBox);\r\n\r\n    for (let i = m; i < M - m; i++) {\r\n      const child = node.childrenNodes[i];\r\n      extend(leftBBox, node.leaf ? toBBox(child) : child);\r\n      margin += bboxMargin(leftBBox);\r\n    }\r\n\r\n    for (let i = M - m - 1; i >= m; i--) {\r\n      const child = node.childrenNodes[i];\r\n      extend(rightBBox, node.leaf ? toBBox(child) : child);\r\n      margin += bboxMargin(rightBBox);\r\n    }\r\n\r\n    return margin;\r\n  }\r\n\r\n  _adjustParentBBoxes(bbox, path, level) {\r\n    // 沿给定的树路径调整 bbox\r\n    for (let i = level; i >= 0; i--) {\r\n      extend(path[i], bbox);\r\n    }\r\n  }\r\n\r\n  _condense(path) {\r\n    // 遍历路径，删除空节点并更新 bboxes\r\n    for (let i = path.length - 1, siblings; i >= 0; i--) {\r\n      if (path[i].childrenNodes.length === 0) {\r\n        if (i > 0) {\r\n          siblings = path[i - 1].childrenNodes;\r\n          siblings.splice(siblings.indexOf(path[i]), 1);\r\n        } else {\r\n          this.clear();\r\n        }\r\n      } else {\r\n        calcBBox(path[i], this.toBBox);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport {\r\n  RectTree,\r\n};\r\n","import { RectRange } from '../core/table/tablebase/RectRange';\r\n\r\nclass RtreeUtils {\r\n\r\n  static bboxToRange(bbox) {\r\n    return new RectRange(bbox.minY, bbox.minX, bbox.maxY, bbox.maxX);\r\n  }\r\n\r\n  static rangeToBbox(range) {\r\n    return {\r\n      minX: range.sci,\r\n      minY: range.sri,\r\n      maxX: range.eci,\r\n      maxY: range.eri,\r\n    };\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  RtreeUtils,\r\n};\r\n","import { Snapshot } from '../snapshot/Snapshot';\r\nimport { RectTree } from '../../../lib/recttree/RectTree';\r\nimport { Listen } from '../../../lib/Listen';\r\nimport { RtreeUtils } from '../../../utils/RtreeUtils';\r\nimport { SheetUtils } from '../../../utils/SheetUtils';\r\nimport { RectRange } from './RectRange';\r\n\r\n/**\r\n * RangeTree\r\n */\r\nclass RangeTree {\r\n\r\n  /**\r\n     * RangeTree 区域管理\r\n     */\r\n  constructor({\r\n    snapshot = new Snapshot(),\r\n  }) {\r\n    this.snapshot = snapshot;\r\n    this.rTree = new RectTree();\r\n    this.listen = new Listen();\r\n  }\r\n\r\n  /**\r\n     * 获取包含点的矩形区域\r\n     * @param ri\r\n     * @param ci\r\n     */\r\n  getFirstInclude(ri, ci) {\r\n    let { rTree } = this;\r\n    let bbox = {\r\n      minX: ci,\r\n      minY: ri,\r\n      maxX: ci,\r\n      maxY: ri,\r\n    };\r\n    let find = rTree.first(bbox);\r\n    if (find) {\r\n      return RtreeUtils.bboxToRange(find);\r\n    }\r\n    return SheetUtils.Undef;\r\n  }\r\n\r\n  /**\r\n   * 获取包含点的矩形区域\r\n   * @param ri\r\n   * @param ci\r\n   */\r\n  getMasterInclude(ri, ci) {\r\n    const find = this.getFirstInclude(ri, ci);\r\n    if (find.sri === ri) {\r\n      if (find.sci === ci) {\r\n        return find;\r\n      }\r\n    }\r\n    return SheetUtils.Undef;\r\n  }\r\n\r\n  /**\r\n     * 获取重合的区域\r\n     * @param rectRange\r\n     */\r\n  getIntersects(rectRange) {\r\n    let { rTree } = this;\r\n    let bbox = RtreeUtils.rangeToBbox(rectRange);\r\n    const array = rTree.search(bbox);\r\n    return array.map(bbox => RtreeUtils.bboxToRange(bbox));\r\n  }\r\n\r\n  /**\r\n     * 添加矩形区域\r\n     * @param rectRange\r\n     */\r\n  push(rectRange) {\r\n    let { rTree } = this;\r\n    let bbox = RtreeUtils.rangeToBbox(rectRange);\r\n    rTree.insert(bbox);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n     * 删除矩形区域\r\n     * @param rectRange\r\n     */\r\n  shift(rectRange) {\r\n    let { rTree } = this;\r\n    let bbox = RtreeUtils.rangeToBbox(rectRange);\r\n    let array = rTree.search(bbox);\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let item = array[i];\r\n      rTree.remove(item);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n     * 添加矩形区域\r\n     * @param rectRange\r\n     */\r\n  add(rectRange) {\r\n    let { listen, snapshot } = this;\r\n    let action = {\r\n      undo: () => {\r\n        this.shift(rectRange);\r\n      },\r\n      redo: () => {\r\n        this.push(rectRange);\r\n        listen.execute('add', rectRange);\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  /**\r\n     * 删除矩形区域\r\n     * @param rectRange\r\n     */\r\n  delete(rectRange) {\r\n    let { listen, snapshot } = this;\r\n    let action = {\r\n      undo: () => {\r\n        this.push(rectRange);\r\n      },\r\n      redo: () => {\r\n        this.shift(rectRange);\r\n        listen.execute('delete', rectRange);\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  /**\r\n   * 删除矩形区域\r\n   * @param rectRanges\r\n   */\r\n  batchDelete(rectRanges) {\r\n    let { listen, snapshot } = this;\r\n    let action = {\r\n      undo: () => {\r\n        rectRanges.forEach((rectRange) => {\r\n          this.push(rectRange);\r\n        });\r\n      },\r\n      redo: () => {\r\n        rectRanges.forEach((rectRange) => {\r\n          this.shift(rectRange);\r\n        });\r\n        listen.execute('batchDelete', rectRanges);\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  /**\r\n     * 获取所有的矩形区域\r\n     */\r\n  getAll() {\r\n    let { rTree } = this;\r\n    return rTree.all().map(bbox => RtreeUtils.bboxToRange(bbox));\r\n  }\r\n\r\n  /**\r\n     * 获取交叉矩形新区域\r\n     * @param rectRange\r\n     */\r\n  union(rectRange) {\r\n    let { rTree } = this;\r\n    let bbox = RtreeUtils.rangeToBbox(rectRange);\r\n    let array = rTree.search(bbox);\r\n    if (array.length === 0) {\r\n      return rectRange;\r\n    }\r\n    let clone = rectRange.clone();\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let range = RtreeUtils.bboxToRange(array[i]);\r\n      clone = clone.union(range);\r\n    }\r\n    if (!clone.equals(rectRange)) {\r\n      return this.union(clone);\r\n    }\r\n    return rectRange;\r\n  }\r\n\r\n  /**\r\n   * 获取整行区域\r\n   * @param ri\r\n   * @param number\r\n   * @returns {RectRange}\r\n   */\r\n  getFullRowRange(ri, number) {\r\n    return new RectRange(ri, 0, Math.max(ri, ri + number - 1), RangeTree.MAX_COL);\r\n  }\r\n\r\n  /**\r\n   * 获取整列区域\r\n   * @param ci\r\n   * @param number\r\n   * @returns {RectRange}\r\n   */\r\n  getFullColRange(ci, number) {\r\n    return new RectRange(0, ci, RangeTree.MAX_ROW, Math.max(ci, ci + number - 1));\r\n  }\r\n\r\n  /**\r\n     * 行扩展\r\n     * @param ri\r\n     * @param number\r\n     */\r\n  rowAfterExpand(ri, number) {\r\n    let bbox = {\r\n      minX: 0,\r\n      minY: ri,\r\n      maxX: RangeTree.MAX_COL,\r\n      maxY: RangeTree.MAX_ROW,\r\n    };\r\n    let { rTree } = this;\r\n    let array = rTree.search(bbox);\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let item = array[i];\r\n      rTree.remove(item);\r\n      if (item.minY > ri) {\r\n        item.minY += number;\r\n      }\r\n      if (item.maxY > ri) {\r\n        item.maxY += number;\r\n      }\r\n    }\r\n    rTree.load(array);\r\n  }\r\n\r\n  /**\r\n     * 列扩展\r\n     * @param ci\r\n     * @param number\r\n     */\r\n  colAfterExpand(ci, number) {\r\n    const bbox = {\r\n      minX: ci,\r\n      minY: 0,\r\n      maxX: RangeTree.MAX_COL,\r\n      maxY: RangeTree.MAX_ROW,\r\n    };\r\n    let { rTree } = this;\r\n    let array = rTree.search(bbox);\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let item = array[i];\r\n      rTree.remove(item);\r\n      if (item.minX > ci) {\r\n        item.minX += number;\r\n      }\r\n      if (item.maxX > ci) {\r\n        item.maxX += number;\r\n      }\r\n    }\r\n    rTree.load(array);\r\n  }\r\n\r\n  /**\r\n     * 行收缩\r\n     * @param ri\r\n     * @param number\r\n     */\r\n  rowAfterShrink(ri, number) {\r\n    let bbox = {\r\n      minX: 0,\r\n      minY: ri,\r\n      maxX: RangeTree.MAX_COL,\r\n      maxY: RangeTree.MAX_ROW,\r\n    };\r\n    let { rTree } = this;\r\n    let array = rTree.search(bbox);\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let item = array[i];\r\n      rTree.remove(item);\r\n      if (item.minY > ri) {\r\n        item.minY -= number;\r\n      }\r\n      if (item.maxY > ri) {\r\n        item.maxY -= number;\r\n      }\r\n    }\r\n    rTree.load(array);\r\n  }\r\n\r\n  /**\r\n     * 列收索\r\n     * @param ci\r\n     * @param number\r\n     */\r\n  colAfterShrink(ci, number) {\r\n    const bbox = {\r\n      minX: ci,\r\n      minY: 0,\r\n      maxX: RangeTree.MAX_COL,\r\n      maxY: RangeTree.MAX_ROW,\r\n    };\r\n    let { rTree } = this;\r\n    let array = rTree.search(bbox);\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let item = array[i];\r\n      rTree.remove(item);\r\n      if (item.minX > ci) {\r\n        item.minX -= number;\r\n      }\r\n      if (item.maxX > ci) {\r\n        item.maxX -= number;\r\n      }\r\n    }\r\n    rTree.load(array);\r\n  }\r\n\r\n  /**\r\n   * 行扩展\r\n   * @param ri\r\n   * @param number\r\n   */\r\n  rowBeforeExpand(ri, number) {\r\n    let bbox = {\r\n      minX: 0,\r\n      minY: ri,\r\n      maxX: RangeTree.MAX_COL,\r\n      maxY: RangeTree.MAX_ROW,\r\n    };\r\n    let { rTree } = this;\r\n    let array = rTree.search(bbox);\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let item = array[i];\r\n      rTree.remove(item);\r\n      if (item.minY >= ri) {\r\n        item.minY += number;\r\n      }\r\n      if (item.maxY >= ri) {\r\n        item.maxY += number;\r\n      }\r\n    }\r\n    rTree.load(array);\r\n  }\r\n\r\n  /**\r\n   * 列扩展\r\n   * @param ci\r\n   * @param number\r\n   */\r\n  colBeforeExpand(ci, number) {\r\n    const bbox = {\r\n      minX: ci,\r\n      minY: 0,\r\n      maxX: RangeTree.MAX_COL,\r\n      maxY: RangeTree.MAX_ROW,\r\n    };\r\n    let { rTree } = this;\r\n    let array = rTree.search(bbox);\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let item = array[i];\r\n      rTree.remove(item);\r\n      if (item.minX >= ci) {\r\n        item.minX += number;\r\n      }\r\n      if (item.maxX >= ci) {\r\n        item.maxX += number;\r\n      }\r\n    }\r\n    rTree.load(array);\r\n  }\r\n\r\n  /**\r\n   * 行收缩\r\n   * @param ri\r\n   * @param number\r\n   */\r\n  rowBeforeShrink(ri, number) {\r\n    let bbox = {\r\n      minX: 0,\r\n      minY: ri,\r\n      maxX: RangeTree.MAX_COL,\r\n      maxY: RangeTree.MAX_ROW,\r\n    };\r\n    let { rTree } = this;\r\n    let array = rTree.search(bbox);\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let item = array[i];\r\n      rTree.remove(item);\r\n      if (item.minY >= ri) {\r\n        item.minY -= number;\r\n      }\r\n      if (item.maxY >= ri) {\r\n        item.maxY -= number;\r\n      }\r\n    }\r\n    rTree.load(array);\r\n  }\r\n\r\n  /**\r\n   * 列收索\r\n   * @param ci\r\n   * @param number\r\n   */\r\n  colBeforeShrink(ci, number) {\r\n    const bbox = {\r\n      minX: ci,\r\n      minY: 0,\r\n      maxX: RangeTree.MAX_COL,\r\n      maxY: RangeTree.MAX_ROW,\r\n    };\r\n    let { rTree } = this;\r\n    let array = rTree.search(bbox);\r\n    for (let i = 0, len = array.length; i < len; i++) {\r\n      let item = array[i];\r\n      rTree.remove(item);\r\n      if (item.minX >= ci) {\r\n        item.minX -= number;\r\n      }\r\n      if (item.maxX >= ci) {\r\n        item.maxX -= number;\r\n      }\r\n    }\r\n    rTree.load(array);\r\n  }\r\n}\r\n\r\nRangeTree.MAX_COL = 1433;\r\nRangeTree.MAX_ROW = 1048576;\r\n\r\nexport {\r\n  RangeTree,\r\n};\r\n","import { RectRange } from '../tablebase/RectRange';\r\nimport { Snapshot } from '../snapshot/Snapshot';\r\nimport { RangeTree } from '../tablebase/RangeTree';\r\nimport { RtreeUtils } from '../../../utils/RtreeUtils';\r\n\r\n/**\r\n * Merges\r\n */\r\nclass Merges extends RangeTree {\r\n\r\n  /**\r\n     * Merges 合并区域管理\r\n     */\r\n  constructor({\r\n    snapshot = new Snapshot(),\r\n    merges = [],\r\n  } = {}) {\r\n    super({ snapshot });\r\n    merges.map(merge => RectRange.valueOf(merge)).forEach(view => this.add(view));\r\n  }\r\n\r\n  /**\r\n   * 获取矩形的json数据\r\n   */\r\n  getData() {\r\n    return {\r\n      merges: this.getAll().map(range => range.toString()),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 删除行号\r\n   * @param ri\r\n   * @param number\r\n   */\r\n  removeRow(ri, number) {\r\n    let { rTree, snapshot } = this;\r\n    let footRange = new RectRange(ri, 0, RangeTree.MAX_ROW, RangeTree.MAX_COL);\r\n    let fullRange = this.getFullRowRange(ri, number);\r\n    let fullBbox = RtreeUtils.rangeToBbox(fullRange);\r\n    let footBbox = RtreeUtils.rangeToBbox(footRange);\r\n    let divers = [];\r\n    let search = [];\r\n    let mergeAction = {\r\n      undo: () => {\r\n        let { length } = divers;\r\n        for (let i = 0; i < length; i++) {\r\n          const item = divers[i];\r\n          rTree.remove(item);\r\n        }\r\n        rTree.load(search);\r\n      },\r\n      redo: () => {\r\n        divers = [];\r\n        search = rTree.search(footBbox);\r\n        let { length } = search;\r\n        for (let i = 0; i < length; i++) {\r\n          const item = search[i];\r\n          const clone = { ...item };\r\n          rTree.remove(item);\r\n          if (clone.minY < fullBbox.minY) {\r\n            if (clone.maxY < fullBbox.maxY) {\r\n              let diffMax = clone.maxY - fullBbox.minY;\r\n              diffMax += 1;\r\n              clone.oldMax = clone.maxY;\r\n              clone.maxY -= diffMax;\r\n              clone.style = 'oddValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n              continue;\r\n            }\r\n            if (clone.maxY > fullBbox.maxY) {\r\n              let diffMax = fullBbox.maxY - footBbox.minY;\r\n              diffMax += 1;\r\n              clone.oldMax = clone.maxY;\r\n              clone.maxY -= diffMax;\r\n              clone.style = 'oddValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n              continue;\r\n            }\r\n            if (clone.maxY === fullBbox.maxY) {\r\n              let diffMax = fullBbox.maxY - footBbox.minY;\r\n              diffMax += 1;\r\n              clone.oldMax = clone.maxY;\r\n              clone.maxY -= diffMax;\r\n              clone.style = 'oddValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n              continue;\r\n            }\r\n          }\r\n          if (clone.minY > fullBbox.minY) {\r\n            if (clone.minY < fullBbox.maxY) {\r\n              if (clone.maxY > fullBbox.maxY) {\r\n                let diffMin = clone.minY - fullBbox.minY;\r\n                let diffMax = fullBbox.maxY - clone.minY;\r\n                diffMax += diffMin + 1;\r\n                clone.oldMax = clone.maxY;\r\n                clone.oldMin = clone.minY;\r\n                clone.maxY -= diffMax;\r\n                clone.minY -= diffMin;\r\n                clone.style = 'evenValue';\r\n                if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                  divers.push(clone);\r\n                }\r\n                continue;\r\n              }\r\n            }\r\n            if (clone.minY > fullBbox.maxY) {\r\n              let diffValue = fullBbox.maxY - fullBbox.minY;\r\n              diffValue += 1;\r\n              clone.oldMax = clone.maxY;\r\n              clone.oldMin = clone.minY;\r\n              clone.maxY -= diffValue;\r\n              clone.minY -= diffValue;\r\n              clone.style = 'evenValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n              continue;\r\n            }\r\n          }\r\n          if (clone.minY === fullBbox.minY) {\r\n            if (clone.maxY > fullBbox.maxY) {\r\n              let diffMax = fullBbox.maxY - clone.minY;\r\n              diffMax += 1;\r\n              clone.oldMax = clone.maxY;\r\n              clone.maxY -= diffMax;\r\n              clone.style = 'oddValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n            }\r\n          }\r\n        }\r\n        rTree.load(divers);\r\n      },\r\n    };\r\n    snapshot.addAction(mergeAction);\r\n    mergeAction.redo();\r\n  }\r\n\r\n  /**\r\n   * 删除列号\r\n   * @param ci\r\n   * @param number\r\n   */\r\n  removeCol(ci, number) {\r\n    let { rTree, snapshot } = this;\r\n    let footRange = new RectRange(0, ci, RangeTree.MAX_ROW, RangeTree.MAX_COL);\r\n    let fullRange = this.getFullColRange(ci, number);\r\n    let fullBbox = RtreeUtils.rangeToBbox(fullRange);\r\n    let footBbox = RtreeUtils.rangeToBbox(footRange);\r\n    let divers = [];\r\n    let search = [];\r\n    let mergeAction = {\r\n      undo: () => {\r\n        let { length } = divers;\r\n        for (let i = 0; i < length; i++) {\r\n          const item = divers[i];\r\n          rTree.remove(item);\r\n        }\r\n        rTree.load(search);\r\n      },\r\n      redo: () => {\r\n        divers = [];\r\n        search = rTree.search(footBbox);\r\n        let { length } = search;\r\n        for (let i = 0; i < length; i++) {\r\n          const item = search[i];\r\n          const clone = { ...item };\r\n          rTree.remove(item);\r\n          if (clone.minX < fullBbox.minX) {\r\n            if (clone.maxX < fullBbox.maxX) {\r\n              let diffMax = clone.maxX - fullBbox.minX;\r\n              diffMax += 1;\r\n              clone.oldMax = clone.maxX;\r\n              clone.maxX -= diffMax;\r\n              clone.style = 'oddValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n              continue;\r\n            }\r\n            if (clone.maxX > fullBbox.maxX) {\r\n              let diffMax = fullBbox.maxX - footBbox.minX;\r\n              diffMax += 1;\r\n              clone.oldMax = clone.maxX;\r\n              clone.maxX -= diffMax;\r\n              clone.style = 'oddValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n              continue;\r\n            }\r\n            if (clone.maxX === fullBbox.maxX) {\r\n              let diffMax = fullBbox.maxX - footBbox.minX;\r\n              diffMax += 1;\r\n              clone.oldMax = clone.maxX;\r\n              clone.maxX -= diffMax;\r\n              clone.style = 'oddValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n              continue;\r\n            }\r\n          }\r\n          if (clone.minX > fullBbox.minX) {\r\n            if (clone.minX < fullBbox.maxX) {\r\n              if (clone.maxX > fullBbox.maxX) {\r\n                let diffMin = clone.minX - fullBbox.minX;\r\n                let diffMax = fullBbox.maxX - clone.minX;\r\n                diffMax += diffMin + 1;\r\n                clone.oldMax = clone.maxX;\r\n                clone.oldMin = clone.minX;\r\n                clone.maxX -= diffMax;\r\n                clone.minX -= diffMin;\r\n                clone.style = 'evenValue';\r\n                if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                  divers.push(clone);\r\n                }\r\n                continue;\r\n              }\r\n            }\r\n            if (clone.minX > fullBbox.maxX) {\r\n              let diffValue = fullBbox.maxX - fullBbox.minX;\r\n              diffValue += 1;\r\n              clone.oldMax = clone.maxX;\r\n              clone.oldMin = clone.minX;\r\n              clone.maxX -= diffValue;\r\n              clone.minX -= diffValue;\r\n              clone.style = 'evenValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n              continue;\r\n            }\r\n          }\r\n          if (clone.minX === fullBbox.minX) {\r\n            if (clone.maxX > fullBbox.maxX) {\r\n              let diffMax = fullBbox.maxX - clone.minX;\r\n              diffMax += 1;\r\n              clone.oldMax = clone.maxX;\r\n              clone.maxX -= diffMax;\r\n              clone.style = 'oddValue';\r\n              if (clone.maxX !== clone.minX || clone.maxY !== clone.minY) {\r\n                divers.push(clone);\r\n              }\r\n            }\r\n          }\r\n        }\r\n        rTree.load(divers);\r\n      },\r\n    };\r\n    snapshot.addAction(mergeAction);\r\n    mergeAction.redo();\r\n  }\r\n\r\n  /**\r\n   * 插入新列时调整区域大小和位置\r\n   * @param ci\r\n   * @param number\r\n   */\r\n  insertColAfter(ci, number) {\r\n    const { snapshot } = this;\r\n    const mergeAction = {\r\n      undo: () => {\r\n        this.colAfterShrink(ci, number);\r\n      },\r\n      redo: () => {\r\n        this.colAfterExpand(ci, number);\r\n      },\r\n    };\r\n    snapshot.addAction(mergeAction);\r\n    mergeAction.redo();\r\n  }\r\n\r\n  /**\r\n   * 插入新列时调整区域大小和位置\r\n   * @param ci\r\n   * @param number\r\n   */\r\n  insertColBefore(ci, number) {\r\n    const { snapshot } = this;\r\n    const mergeAction = {\r\n      undo: () => {\r\n        this.colBeforeShrink(ci, number);\r\n      },\r\n      redo: () => {\r\n        this.colBeforeExpand(ci, number);\r\n      },\r\n    };\r\n    snapshot.addAction(mergeAction);\r\n    mergeAction.redo();\r\n  }\r\n\r\n  /**\r\n   * 插入新行时调整区域大小和位置\r\n   * @param ri\r\n   * @param number\r\n   */\r\n  insertRowAfter(ri, number) {\r\n    const { snapshot } = this;\r\n    const mergeAction = {\r\n      undo: () => {\r\n        this.rowAfterShrink(ri, number);\r\n      },\r\n      redo: () => {\r\n        this.rowAfterExpand(ri, number);\r\n      },\r\n    };\r\n    snapshot.addAction(mergeAction);\r\n    mergeAction.redo();\r\n  }\r\n\r\n  /**\r\n   * 插入新行时调整区域大小和位置\r\n   * @param ri\r\n   * @param number\r\n   */\r\n  insertRowBefore(ri, number) {\r\n    const { snapshot } = this;\r\n    const mergeAction = {\r\n      undo: () => {\r\n        this.rowBeforeShrink(ri, number);\r\n      },\r\n      redo: () => {\r\n        this.rowBeforeExpand(ri, number);\r\n      },\r\n    };\r\n    snapshot.addAction(mergeAction);\r\n    mergeAction.redo();\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  Merges,\r\n};\r\n","import { Cell } from './Cell';\r\nimport { SheetUtils } from '../../../utils/SheetUtils';\r\nimport { Listen } from '../../../lib/Listen';\r\nimport { Merges } from '../merges/Merges';\r\nimport { Snapshot } from '../snapshot/Snapshot';\r\n\r\nclass Items {\r\n\r\n  constructor({ data = [] }) {\r\n    this.data = data;\r\n  }\r\n\r\n  getItems(ri) {\r\n    let { data } = this;\r\n    return data[ri];\r\n  }\r\n\r\n  clear(rectRange, { ignoreCorner = false } = {}) {\r\n    let { sri, eri } = rectRange;\r\n    let { sci, eci } = rectRange;\r\n    let { data } = this;\r\n    let { snapshot } = this;\r\n    let { length } = data;\r\n    let oldItems = [];\r\n    let effRiLength = eri - sri + 1;\r\n    let effCiLength = eci - sci + 1;\r\n    let action = {\r\n      undo: () => {\r\n        for (let ri = sri; ri <= eri; ri++) {\r\n          if (ri >= length) {\r\n            break;\r\n          }\r\n          let oldRowItem = oldItems[ri];\r\n          let rowItem = data[ri];\r\n          if (rowItem) {\r\n            for (let ci = sci; ci <= eci; ci++) {\r\n              if (ci >= length) {\r\n                break;\r\n              }\r\n              if (ignoreCorner) {\r\n                let firstRi = ri === sri;\r\n                let firstCi = ci === sci;\r\n                if (firstRi && firstCi) {\r\n                  continue;\r\n                }\r\n                rowItem[ci] = oldRowItem[ci];\r\n              } else {\r\n                rowItem[ci] = oldRowItem[ci];\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      redo: () => {\r\n        oldItems = new Array(effRiLength);\r\n        for (let ri = sri; ri <= eri; ri++) {\r\n          if (ri >= length) {\r\n            break;\r\n          }\r\n          let rowItem = data[ri];\r\n          if (rowItem) {\r\n            let oldRowItem = new Array(effCiLength);\r\n            let { length } = rowItem;\r\n            for (let ci = sci; ci <= eci; ci++) {\r\n              if (ci >= length) {\r\n                break;\r\n              }\r\n              if (ignoreCorner) {\r\n                let firstRi = ri === sri;\r\n                let firstCi = ci === sci;\r\n                if (firstRi && firstCi) {\r\n                  continue;\r\n                }\r\n                oldRowItem[ci] = rowItem[ci];\r\n                rowItem[ci] = undefined;\r\n              } else {\r\n                oldRowItem[ci] = rowItem[ci];\r\n                rowItem[ci] = undefined;\r\n              }\r\n            }\r\n            oldItems[ri] = oldRowItem;\r\n          }\r\n        }\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  shift() {\r\n    return this.data.shift();\r\n  }\r\n\r\n  slice(sri, sci, eri, eci) {\r\n    const rows = this.data.slice(sri, eri + 1);\r\n    return rows.map((row) => {\r\n      if (row) {\r\n        return row.slice(sci, eci + 1);\r\n      }\r\n      return row;\r\n    });\r\n  }\r\n\r\n  getData() {\r\n    return this.data;\r\n  }\r\n\r\n  getLength() {\r\n    return this.data.length;\r\n  }\r\n\r\n  hasItems(ri) {\r\n    return SheetUtils.isDef(this.getItems(ri));\r\n  }\r\n\r\n  getItemsOrNew(ri) {\r\n    let { data } = this;\r\n    let items = data[ri];\r\n    if (SheetUtils.isUnDef(items)) {\r\n      items = [];\r\n      data[ri] = items;\r\n    }\r\n    return items;\r\n  }\r\n\r\n}\r\n\r\nclass Cells extends Items {\r\n\r\n  constructor({\r\n    snapshot = new Snapshot(),\r\n    data = [],\r\n    merges = new Merges(),\r\n  } = {}) {\r\n    super({ data });\r\n    this.snapshot = snapshot;\r\n    this.merges = merges;\r\n    this.listen = new Listen();\r\n  }\r\n\r\n  getCellOrNew(ri, ci) {\r\n    if (ri < 0) {\r\n      throw new TypeError(`错误的行号${ri}`);\r\n    }\r\n    if (ci < 0) {\r\n      throw new TypeError(`错误的列号${ci}`);\r\n    }\r\n    let cell = this.getCell(ri, ci);\r\n    if (SheetUtils.isUnDef(cell)) {\r\n      let items = this.getItemsOrNew(ri);\r\n      cell = new Cell();\r\n      items[ci] = cell;\r\n    }\r\n    return cell;\r\n  }\r\n\r\n  getCell(ri, ci) {\r\n    let { data } = this;\r\n    let items = data[ri];\r\n    if (items) {\r\n      let item = items[ci];\r\n      if (item) {\r\n        if (item instanceof Cell) {\r\n          return item;\r\n        }\r\n        if (SheetUtils.isString(item)) {\r\n          let config = { text: item };\r\n          items[ci] = new Cell(config);\r\n        } else {\r\n          let config = item.cell ? item.cell : item;\r\n          items[ci] = new Cell(config);\r\n        }\r\n        return items[ci];\r\n      }\r\n    }\r\n    return SheetUtils.Undef;\r\n  }\r\n\r\n  each(callback) {\r\n    const { data } = this;\r\n    for (let i = 0, len = data.length; i < len; i++) {\r\n      let items = data[i];\r\n      if (items) {\r\n        for (let j = 0, len = items.length; j < len; j++) {\r\n          let cell = this.getCell(i, j);\r\n          callback(cell);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  getCellOrMergeCell(ri, ci) {\r\n    const { merges } = this;\r\n    const merge = merges.getFirstInclude(ri, ci);\r\n    if (merge) {\r\n      return this.getCell(merge.sri, merge.sci);\r\n    }\r\n    return this.getCell(ri, ci);\r\n  }\r\n\r\n  hasCell(ri, ci) {\r\n    return SheetUtils.isDef(this.getCell(ri, ci));\r\n  }\r\n\r\n  setCell(ri, ci, cell) {\r\n    if (ri < 0) {\r\n      throw new TypeError(`错误的行号${ri}`);\r\n    }\r\n    if (ci < 0) {\r\n      throw new TypeError(`错误的列号${ci}`);\r\n    }\r\n    let { listen, snapshot } = this;\r\n    let oldValue = this.getCell(ri, ci);\r\n    if (oldValue) {\r\n      let action = {\r\n        undo: () => {\r\n          const items = this.getItems(ri);\r\n          items[ci] = oldValue;\r\n          listen.execute('change', {\r\n            ri, ci, oldValue,\r\n          });\r\n        },\r\n        redo: () => {\r\n          const items = this.getItemsOrNew(ri);\r\n          items[ci] = cell;\r\n          listen.execute('change', {\r\n            ri, ci, oldValue,\r\n          });\r\n        },\r\n      };\r\n      snapshot.addAction(action);\r\n      action.redo();\r\n    }\r\n  }\r\n\r\n  setCellOrNew(ri, ci, cell) {\r\n    if (ri < 0) {\r\n      throw new TypeError(`错误的行号${ri}`);\r\n    }\r\n    if (ci < 0) {\r\n      throw new TypeError(`错误的列号${ci}`);\r\n    }\r\n    let { listen, snapshot } = this;\r\n    let hasCell = this.hasCell(ri, ci);\r\n    let hasItems = this.hasItems(ri);\r\n    let oldValue = this.getCell(ri, ci);\r\n    let action = {\r\n      undo: () => {\r\n        if (hasItems) {\r\n          const items = this.getItems(ri);\r\n          if (hasCell) {\r\n            items[ci] = oldValue;\r\n          } else {\r\n            items.splice(ci, 1);\r\n          }\r\n          listen.execute('change', {\r\n            ri, ci, oldValue,\r\n          });\r\n        } else {\r\n          const data = this.getData();\r\n          data.splice(ri, 1);\r\n          listen.execute('change', {\r\n            ri, ci, oldValue,\r\n          });\r\n        }\r\n      },\r\n      redo: () => {\r\n        if (hasItems) {\r\n          const items = this.getItems(ri);\r\n          items[ci] = cell;\r\n          listen.execute('change', {\r\n            ri, ci, oldValue,\r\n          });\r\n        } else {\r\n          const items = this.getItemsOrNew(ri);\r\n          items[ci] = cell;\r\n          listen.execute('change', {\r\n            ri, ci, oldValue,\r\n          });\r\n        }\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  removeRow(ri) {\r\n    let { snapshot } = this;\r\n    let orderValue;\r\n    let action = {\r\n      undo: () => {\r\n        if (orderValue) {\r\n          this.data.splice(ri, 0, orderValue);\r\n        }\r\n      },\r\n      redo: () => {\r\n        orderValue = this.data.splice(ri, 1)[0];\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  removeCol(ci) {\r\n    let { snapshot } = this;\r\n    let orderValue = [];\r\n    let action = {\r\n      undo: () => {\r\n        let { length } = orderValue;\r\n        for (let i = 0; i < length; i++) {\r\n          const value = orderValue[i];\r\n          const { ri, item } = value;\r\n          const items = this.data[ri];\r\n          items.splice(ci, 0, item);\r\n        }\r\n      },\r\n      redo: () => {\r\n        let { length } = this.data;\r\n        orderValue = [];\r\n        for (let ri = 0; ri < length; ri++) {\r\n          const items = this.data[ri];\r\n          if (items) {\r\n            const item = items.splice(ci, 1)[0];\r\n            orderValue.push({ ri, item });\r\n          }\r\n        }\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  copyRowStyle(ri) {\r\n    let row = this.data[ri];\r\n    let copy = [];\r\n    if (row) {\r\n      for (let i = 0, len = row.length; i < len; i++) {\r\n        let cell = row[i];\r\n        if (cell) {\r\n          copy[i] = this.getCell(ri, i).cloneStyle();\r\n        }\r\n      }\r\n    }\r\n    return copy;\r\n  }\r\n\r\n  insertRowAfter(ri) {\r\n    let { snapshot } = this;\r\n    let master = ri + 1;\r\n    let action = {\r\n      undo: () => {\r\n        this.data.splice(master, 1);\r\n      },\r\n      redo: () => {\r\n        const copy = this.copyRowStyle(master);\r\n        this.data.splice(master, 0, copy);\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  insertColAfter(ci) {\r\n    let { snapshot } = this;\r\n    let master = ci + 1;\r\n    let action = {\r\n      undo: () => {\r\n        for (let i = 0, len = this.data.length; i < len; i++) {\r\n          const items = this.data[i];\r\n          if (items) {\r\n            items.splice(master, 1);\r\n          }\r\n        }\r\n      },\r\n      redo: () => {\r\n        for (let i = 0, len = this.data.length; i < len; i++) {\r\n          const items = this.data[i];\r\n          if (items) {\r\n            const cell = this.getCell(i, master);\r\n            const copy = cell ? cell.cloneStyle() : undefined;\r\n            items.splice(master, 0, copy);\r\n          }\r\n        }\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  insertRowBefore(ri) {\r\n    let { snapshot } = this;\r\n    let master = ri;\r\n    let action = {\r\n      undo: () => {\r\n        this.data.splice(master, 1);\r\n      },\r\n      redo: () => {\r\n        const copy = this.copyRowStyle(master);\r\n        this.data.splice(master, 0, copy);\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n  insertColBefore(ci) {\r\n    let { snapshot } = this;\r\n    let master = ci;\r\n    let action = {\r\n      undo: () => {\r\n        for (let i = 0, len = this.data.length; i < len; i++) {\r\n          const items = this.data[i];\r\n          if (items) {\r\n            items.splice(master, 1);\r\n          }\r\n        }\r\n      },\r\n      redo: () => {\r\n        for (let i = 0, len = this.data.length; i < len; i++) {\r\n          const items = this.data[i];\r\n          if (items) {\r\n            const cell = this.getCell(i, master);\r\n            const copy = cell ? cell.cloneStyle() : undefined;\r\n            items.splice(master, 0, copy);\r\n          }\r\n        }\r\n      },\r\n    };\r\n    snapshot.addAction(action);\r\n    action.redo();\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  Cells,\r\n};\r\n","import { Cell } from '../../core/table/tablecell/Cell';\r\nimport { SheetUtils } from '../../utils/SheetUtils';\r\nimport { Cells } from '../../core/table/tablecell/Cells';\r\n\r\naddEventListener('message', (event) => {\r\n  const { data } = event;\r\n  const cells = new Cells({\r\n    data\r\n  });\r\n  let total = 0;\r\n  let number = 0;\r\n  cells.each(cell => {\r\n    if (cell) {\r\n      if (cell.hasFormula()) {\r\n        const value = cell.getComputeText();\r\n        if (SheetUtils.isNumber(value)) {\r\n          total += SheetUtils.parseFloat(value);\r\n          number++;\r\n        }\r\n      } else {\r\n        switch (cell.contentType) {\r\n          case Cell.TYPE.NUMBER:\r\n            total += cell.getComputeText();\r\n            number++;\r\n            break;\r\n        }\r\n      }\r\n    }\r\n  });\r\n  postMessage({\r\n    total, number\r\n  });\r\n});\r\n"],"sourceRoot":""}